/**
 * jw7-hlsjs-provider
 * v3.4.29
 * 2017-08-02
 * streamroot-hlsjs-p2p-bundle@4.3.38
 *  - streamroot-p2p@4.10.14
 *  - hls.js@0.6.21
 *
 * Copyright Â© 2017
 */

/******/ (function(modules) { // webpackBootstrap
    /******/ 	// The module cache
    /******/ 	var installedModules = {};
    /******/
    /******/ 	// The require function
    /******/ 	function __webpack_require__(moduleId) {
        /******/
        /******/ 		// Check if module is in cache
        /******/ 		if(installedModules[moduleId]) {
            /******/ 			return installedModules[moduleId].exports;
            /******/ 		}
        /******/ 		// Create a new module (and put it into the cache)
        /******/ 		var module = installedModules[moduleId] = {
            /******/ 			i: moduleId,
            /******/ 			l: false,
            /******/ 			exports: {}
            /******/ 		};
        /******/
        /******/ 		// Execute the module function
        /******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
        /******/
        /******/ 		// Flag the module as loaded
        /******/ 		module.l = true;
        /******/
        /******/ 		// Return the exports of the module
        /******/ 		return module.exports;
        /******/ 	}
    /******/
    /******/
    /******/ 	// expose the modules object (__webpack_modules__)
    /******/ 	__webpack_require__.m = modules;
    /******/
    /******/ 	// expose the module cache
    /******/ 	__webpack_require__.c = installedModules;
    /******/
    /******/ 	// identity function for calling harmony imports with the correct context
    /******/ 	__webpack_require__.i = function(value) { return value; };
    /******/
    /******/ 	// define getter function for harmony exports
    /******/ 	__webpack_require__.d = function(exports, name, getter) {
        /******/ 		if(!__webpack_require__.o(exports, name)) {
            /******/ 			Object.defineProperty(exports, name, {
                /******/ 				configurable: false,
                /******/ 				enumerable: true,
                /******/ 				get: getter
                /******/ 			});
            /******/ 		}
        /******/ 	};
    /******/
    /******/ 	// getDefaultExport function for compatibility with non-harmony modules
    /******/ 	__webpack_require__.n = function(module) {
        /******/ 		var getter = module && module.__esModule ?
            /******/ 			function getDefault() { return module['default']; } :
            /******/ 			function getModuleExports() { return module; };
        /******/ 		__webpack_require__.d(getter, 'a', getter);
        /******/ 		return getter;
        /******/ 	};
    /******/
    /******/ 	// Object.prototype.hasOwnProperty.call
    /******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
    /******/
    /******/ 	// __webpack_public_path__
    /******/ 	__webpack_require__.p = "";
    /******/
    /******/ 	// Load entry module and return exports
    /******/ 	return __webpack_require__(__webpack_require__.s = 2);
    /******/ })
/************************************************************************/
/******/ ([
    /* 0 */
    /***/ (function(module, exports, __webpack_require__) {

        var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var require;var require;var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/**
         * streamroot-hlsjs-p2p-bundle
         * v4.3.38
         * 2017-08-02
         * streamroot-p2p@4.10.14
         *  - streamroot-qos-analytics@2.0.14
         * hls.js@0.6.21
         * www.streamroot.io
         * Copyright Â© 2017
         */

        !function(e,t){ true?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Hls=t():e.Hls=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(7)},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){n(this,e),this.level=t.level,this.urlId=t.urlId,this.bitrate=t.bitrate}return r(e,[{key:"viewToString",value:function(){return"L"+this.level+"U"+this.urlId}},{key:"isEqual",value:function(e){return!!e&&(e.level===this.level&&e.urlId===this.urlId)}},{key:"type",get:function(){return"video"}}]),e}();t.default=i,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),u=r(s),l=function(){function e(t){i(this,e),this.sn=t.sn,this.trackView=new u.default(t.trackView),this.time=t.time}return o(e,null,[{key:"fromArrayBuffer",value:function(t){var n=new Uint32Array(t),r=a(n,3),i=r[0],o=r[1],s=r[2];return new e({trackView:new u.default({level:i,urlId:o}),sn:s})}}]),o(e,[{key:"isEqual",value:function(e){if(!e)return!1;var t=e.sn,n=e.trackView;return this.sn===t&&this.trackView.isEqual(n)}},{key:"isInTrack",value:function(e){return this.trackView.isEqual(e)}},{key:"viewToString",value:function(){return this.trackView.viewToString()+"S"+this.sn}},{key:"toArrayBuffer",value:function(){var e=this.trackView,t=e.level,n=e.urlId;return new Uint32Array([t,n,this.sn]).buffer}},{key:"getId",value:function(){return this.sn}}]),e}();t.default=l,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){function n(n){Object.defineProperty(e,n,{get:function(){return t[n]},set:void 0})}var r=!0,i=!1,a=void 0;try{for(var o,s=Object.getOwnPropertyNames(t)[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;["prototype","name","length","caller","arguments","isSupported"].indexOf(u)===-1&&n(u)}}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}}function i(e,t,n){var r=n||{},i=new a.BaseXHR({setRequestHeader:function(e,t){r[e]=t},withCredentials:!1});try{e&&e(i,t)}catch(e){throw new Error("xhrSetup is trying to acces a forbidden property/method of XHR mock. Please contact Streamroot support. Internal mock error: "+e.message)}return{headers:r,withCredentials:i.withCredentials}}Object.defineProperty(t,"__esModule",{value:!0}),t.extractInfoFromXhrSetup=t.inheritStaticPropertiesReadOnly=void 0;var a=n(24);t.inheritStaticPropertiesReadOnly=r,t.extractInfoFromXhrSetup=i},function(e,t){"use strict";function n(e,t){if("undefined"==typeof e[t])throw new Error(u+": "+t)}function r(e,t,r,i){if(i){var a=i(e,t,r);if(a.override)return a.value}return n(t,r),t[r]}function i(e,t,r,i,a){if(a){var o=a(e,t,r,i);if(o.override)return}n(r,i),r[i]=e}function a(e,t,n,i){Object.defineProperty(e,n,{get:function(){return r(e,t,n,i)},configurable:!0})}function o(e,t,n,a,o){Object.defineProperty(e,n,{get:function(){return r(e,t,n,o)},set:function(r){return i(r,e,t,n,a)},configurable:!0})}function s(e,t,r){e[r]=function(){return n(t,r),t[r].apply(t,arguments)}}var u="Requiring undefined property on source object";e.exports={mirrorFunc:s,mirrorRwProp:o,mirrorReadOnlyProp:a}},function(e,t){function n(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function r(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function i(e,t){var n=k(e)||p(e)?r(e.length,String):[],i=n.length,a=!!i;for(var o in e)!t&&!O.call(e,o)||a&&("length"==o||c(o,i))||n.push(o);return n}function a(e,t,n){var r=e[t];O.call(e,t)&&_(r,n)&&(void 0!==n||t in e)||(e[t]=n)}function o(e){if(!y(e))return h(e);var t=f(e),n=[];for(var r in e)("constructor"!=r||!t&&O.call(e,r))&&n.push(r);return n}function s(e,t){return t=I(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,a=I(r.length-t,0),o=Array(a);++i<a;)o[i]=r[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=r[i];return s[t]=o,n(e,this,s)}}function u(e,t,n,r){n||(n={});for(var i=-1,o=t.length;++i<o;){var s=t[i],u=r?r(n[s],e[s],s,n,e):void 0;a(n,s,void 0===u?e[s]:u)}return n}function l(e){return s(function(t,n){var r=-1,i=n.length,a=i>1?n[i-1]:void 0,o=i>2?n[2]:void 0;for(a=e.length>3&&"function"==typeof a?(i--,a):void 0,o&&d(n[0],n[1],o)&&(a=i<3?void 0:a,i=1),t=Object(t);++r<i;){var s=n[r];s&&e(t,s,r,a)}return t})}function c(e,t){return t=null==t?A:t,!!t&&("number"==typeof e||w.test(e))&&e>-1&&e%1==0&&e<t}function d(e,t,n){if(!y(n))return!1;var r=typeof t;return!!("number"==r?v(n)&&c(t,n.length):"string"==r&&t in n)&&_(n[t],e)}function f(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||b;return e===n}function h(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}function _(e,t){return e===t||e!==e&&t!==t}function p(e){return E(e)&&O.call(e,"callee")&&(!L.call(e,"callee")||P.call(e)==R)}function v(e){return null!=e&&m(e.length)&&!g(e)}function E(e){return S(e)&&v(e)}function g(e){var t=y(e)?P.call(e):"";return t==D||t==C}function m(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=A}function y(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function S(e){return!!e&&"object"==typeof e}function T(e){return v(e)?i(e,!0):o(e)}var A=9007199254740991,R="[object Arguments]",D="[object Function]",C="[object GeneratorFunction]",w=/^(?:0|[1-9]\d*)$/,b=Object.prototype,O=b.hasOwnProperty,P=b.toString,L=b.propertyIsEnumerable,I=Math.max,k=Array.isArray,N=l(function(e,t,n,r){u(t,T(t),e,r)});e.exports=N},function(e,t,n){"use strict";var r=n(4),i=function(e){var t={},n=e||{};return r.mirrorRwProp(t,n,"responseType"),r.mirrorRwProp(t,n,"timeout"),r.mirrorRwProp(t,n,"withCredentials"),r.mirrorReadOnlyProp(t,n,"readyState"),r.mirrorReadOnlyProp(t,n,"response"),r.mirrorReadOnlyProp(t,n,"responseText"),r.mirrorReadOnlyProp(t,n,"responseURL"),r.mirrorReadOnlyProp(t,n,"responseXML"),r.mirrorReadOnlyProp(t,n,"status"),r.mirrorReadOnlyProp(t,n,"statusText"),r.mirrorReadOnlyProp(t,n,"upload"),r.mirrorFunc(t,n,"abort"),r.mirrorFunc(t,n,"open"),r.mirrorFunc(t,n,"send"),r.mirrorFunc(t,n,"setRequestHeader"),r.mirrorFunc(t,n,"getResponseHeader"),r.mirrorFunc(t,n,"overrideMimeType"),r.mirrorFunc(t,n,"getAllResponseHeaders"),r.mirrorFunc(t,n,"addRemoveEventListener"),r.mirrorFunc(t,n,"removeRemoveEventListener"),r.mirrorRwProp(t,n,"onload"),r.mirrorRwProp(t,n,"onloadstart"),r.mirrorRwProp(t,n,"onloadend"),r.mirrorRwProp(t,n,"onabort"),r.mirrorRwProp(t,n,"onerror"),r.mirrorRwProp(t,n,"onprogress"),r.mirrorRwProp(t,n,"ontimeout"),r.mirrorRwProp(t,n,"onreadystatechange"),t};e.exports=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(9),s=r(o),u=n(3),l=n(18),c=r(l),d=n(5),f=r(d),h=n(22),_=r(h),p=n(19),v=r(p),E=(new _.default).getResult(),g=function(){function e(t,n){i(this,e);var r=this._recommendedHlsjsConfig;void 0!==t.liveSyncDurationCount&&delete r.liveSyncDuration;var a=new c.default((0,v.default)(t,r));return new s.default(n,a),a}return a(e,[{key:"_recommendedHlsjsConfig",get:function(){return{maxBufferSize:0,maxBufferLength:30,liveSyncDuration:30}}}]),e}();(0,f.default)(g,c.default),(0,u.inheritStaticPropertiesReadOnly)(g,c.default),g.isSupported=function(){var e="Safari"===E.browser.name;return c.default.isSupported()&&!e},g.getBrowserName=function(){return E.browser.name},t.default=g,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(15),u=r(s),l=n(11),c=r(l),d=n(2),f=r(d),h=n(14),_=r(h),p=function(){function e(t,n,r){var o=this;if(i(this,e),!t||"object"!==("undefined"==typeof t?"undefined":a(t)))throw new Error("p2pConfig must be a valid config object");n.url?this._createPeerAgent(t,n,r):n.on(n.constructor.Events.MANIFEST_LOADING,function(){o._createPeerAgent(t,n,r)})}return o(e,[{key:"onDispose",value:function(){this.peerAgentModule.dispose(),delete this.peerAgentModule}},{key:"_createPeerAgent",value:function(e,t,n){this.hls=t;var r=n.StreamTypes.HLS,i="v2";t.config.fLoader=(0,_.default)(this),t.on(t.constructor.Events.ERROR,this._onMediaEngineError);var a=new u.default(t,this.onDispose.bind(this)),o=new c.default(t);this.peerAgentModule=new n(a,t.url,o,e,f.default,r,i),this._setMediaElement(t),this._overrideABRController(t)}},{key:"_setMediaElement",value:function(e){var t=this;e.media?this.peerAgentModule.setMediaElement(e.media):e.on(e.constructor.Events.MEDIA_ATTACHING,function(){t.peerAgentModule.setMediaElement(e.media)})}},{key:"_onMediaEngineError",value:function(e,t){t.fatal}},{key:"_overrideABRController",value:function(e){var t=void 0,n=void 0;if(e.abrController._findBestLevel)n=e.abrController._findBestLevel,t=!0;else{if(!e.abrController.findBestLevel)return;n=e.abrController.findBestLevel,t=!1}var r=this,i=function(){var t=n.apply(e.abrController,arguments),i=e.currentLevel;return r.peerAgentModule&&r.peerAgentModule.nextSegmentPrebuffered&&r.peerAgentModule.nextSegmentPrebuffered.video&&t<i&&(t=i),t};t?e.abrController._findBestLevel=i:e.abrController.findBestLevel=i}}],[{key:"version",get:function(){return"4.3.38"}}]),e}();t.default=p,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(8),s=r(o),u=n(21),l=r(u),c=n(16),d=r(c),f=function(){function e(t,n){if(i(this,e),n){var r=new s.default(t,n,l.default),a=d.default.get(r);Object.defineProperty(this,"peerAgent",{get:function(){return r.peerAgentModule?a:null}})}}return a(e,[{key:"version",get:function(){return e.version}}],[{key:"version",get:function(){return s.default.version}}]),e}();t.default=f,e.exports=t.default},function(e,t){"use strict";var n="onTrackChange",r="onEmergencyFragLoadAborted",i=[n,r],a=function(e){return i.indexOf(e)>-1};e.exports={TRACK_CHANGE_EVENT:n,EMERGENCY_FRAG_LOAD_ABORT:r,isSupported:a}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2),s=r(o),u=n(1),l=r(u),c=function(){function e(t){i(this,e),this.hls=t}return a(e,[{key:"getSegmentTime",value:function(e){if(void 0===e.time)throw new Error("getSegmentTime: segmentView.time is undefined");return e.time}},{key:"getSegmentList",value:function(e,t,n){var r=this.hls.levels[e.level];if(!r)throw new Error("getSegmentList: level doesn't exist");if(!r.details)return[];for(var i=[],a=r.details.fragments,o=0;o<a.length;o++){var u=a[o];t<=u.start&&u.start<=t+n&&i.push(new s.default({sn:u.sn,trackView:e,time:u.start}))}return i}},{key:"getTrackList",value:function(){if(!this.hls.levels)return[];for(var e=[],t=0;t<this.hls.levels.length;t++)for(var n=this.hls.levels[t],r=0;r<n.url.length;r++)e.push(new l.default({level:t,urlId:r,bitrate:n.bitrate}));return e}},{key:"getSegmentDuration",value:function(e){var t=this.hls.levels[e.trackView.level],n=!0,r=!1,i=void 0;try{for(var a,o=t.details.fragments[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;return s.duration}}catch(e){r=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw i}}throw new Error("All segments should have a duration")}}]),e}();t.default=c,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2),s=r(o),u=n(1),l=r(u),c=n(3),d=function(e){return function(){function t(e){i(this,t),e&&(this.xhrSetup=e.xhrSetup),this.reset()}return a(t,[{key:"destroy",value:function(){this.abort()}},{key:"abort",value:function(){this.peerAgentLoader&&(this.stats.aborted=!0,this.peerAgentLoader.abort()),this.reset()}},{key:"reset",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];clearTimeout(this.requestTimeout),this.requestTimeout=null,e&&(clearTimeout(this.retryTimeout),this.retryTimeout=null),this.peerAgentLoader=null}},{key:"load",value:function(e,t,n,r,i,a,o,s,u,l){if(!u)throw new Error("P2P loader expects progress-callback to be passed for ABR stats (use only as `fLoader` in config)");if(!l)throw new Error("P2P loader can only be used for media fragments (use only as `fLoader` in config)");this.frag=l,this.url=e,this.responseType=t,this.onSuccess=n,this.onProgress=u,this.onTimeout=i,this.onError=r,this.stats={trequest:performance.now(),retry:0},this.timeout=a,this.maxRetry=o,this.retryDelay=s,this.loadInternal()}},{key:"loadSuccess",value:function(e,t){if(!this.stats.aborted){var n={currentTarget:{response:e}};if(t.p2pDuration+t.cdnDuration>0&&t.p2pDownloaded>0){var r=performance.now(),i=t.p2pDuration+t.cdnDuration,a=Math.min(i/2,10);this.stats.trequest=r-i,this.stats.tfirst=this.stats.trequest+a}this.stats.tload=performance.now(),this.stats.loaded=e.byteLength,this.onSuccess(n,this.stats),this.reset()}}},{key:"loadError",value:function(e){if(!this.stats.aborted){var t=e.status;if(this.stats.retry<this.maxRetry)this.retryTimeout=setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,64e3),this.stats.retry++,this.reset(!1);else{var n={target:{status:t}};this.onError(n),this.reset()}}}},{key:"loadInternal",value:function(){if(this.peerAgentLoader)throw new Error("P2P loader was not reset correctly, internal state indicates unfinalized request");var t=this.url,n=this.xhrSetup,r=(0,c.extractInfoFromXhrSetup)(n,t),i=r.headers,a=r.withCredentials;isNaN(this.frag.byteRangeStartOffset)||isNaN(this.frag.byteRangeEndOffset)||(i.Range="bytes="+this.frag.byteRangeStartOffset+"-"+(this.frag.byteRangeEndOffset-1));var o=e.hls.levels[this.frag.level],u=o.urlId,d=o.bitrate,f=new l.default({urlId:u,bitrate:d,level:this.frag.level}),h=new s.default({sn:this.frag.sn,trackView:f,time:this.frag.start}),_={url:t,headers:i,withCredentials:a},p={onSuccess:this.loadSuccess.bind(this),onError:this.loadError.bind(this),onProgress:this.loadProgress.bind(this)};this.stats.tfirst=null,this.stats.loaded=0,this.requestTimeout=setTimeout(this.loadTimeout.bind(this),this.timeout),this.peerAgentLoader=e.peerAgentModule.getSegment(_,p,h)}},{key:"loadProgress",value:function(e){var t=0;e.cdnDownloaded&&(t+=e.cdnDownloaded),e.p2pDownloaded&&(t+=e.p2pDownloaded),this.stats.loaded=t,null===this.stats.tfirst&&(this.stats.tfirst=Math.max(performance.now(),this.stats.trequest)),this.onProgress(e,this.stats)}},{key:"loadTimeout",value:function(){this.onTimeout(null,this.stats)}}]),t}()};t.default=d,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2),s=r(o),u=n(1),l=r(u),c=n(3),d=function(e){return function(){function t(e){i(this,t),e&&(this.xhrSetup=e.xhrSetup),this.reset()}return a(t,[{key:"destroy",value:function(){this.abort()}},{key:"abort",value:function(){this.peerAgentLoader&&(this.stats.aborted=!0,this.peerAgentLoader.abort()),this.reset()}},{key:"reset",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];clearTimeout(this.requestTimeout),this.requestTimeout=null,e&&(clearTimeout(this.retryTimeout),this.retryTimeout=null),this.peerAgentLoader=null}},{key:"load",value:function(e,t,n){if(!n.onProgress)throw new Error("P2P loader expects progress-callback to be passed for ABR stats (use only as `fLoader` in config)");this.stats={trequest:performance.now(),retry:0},this.context=e,this.callbacks=n,this.config=t,this.retryDelay=t.retryDelay,this.loadInternal()}},{key:"loadSuccess",value:function(e,t){if(!this.stats.aborted){var n={data:e};if(t.p2pDuration+t.cdnDuration>0&&t.p2pDownloaded>0){var r=performance.now(),i=t.p2pDuration+t.cdnDuration,a=Math.min(i/2,10);this.stats.trequest=r-i,this.stats.tfirst=this.stats.trequest+a}this.stats.tload=performance.now(),this.stats.loaded=e.byteLength,this.stats.total=this.stats.loaded,this.callbacks.onSuccess(n,this.stats,this.context),this.reset()}}},{key:"loadError",value:function(e){if(!this.stats.aborted){var t=e.status;if(this.stats.retry<this.config.maxRetry)this.retryTimeout=setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,64e3),this.stats.retry++,this.reset(!1);else{var n={code:t,text:e.message};this.callbacks.onError(n,this.context),this.reset()}}}},{key:"loadInternal",value:function(){if(this.peerAgentLoader)throw new Error("P2P loader was not reset correctly, internal state indicates unfinalized request");var t=this.context.url,n=this.xhrSetup,r=(0,c.extractInfoFromXhrSetup)(n,t),i=r.headers,a=r.withCredentials;isNaN(this.context.rangeStart)||isNaN(this.context.rangeEnd)||(i.Range="bytes="+this.context.rangeStart+"-"+(this.context.rangeEnd-1));var o=e.hls.levels[this.context.frag.level],u=o.urlId,d=o.bitrate,f=new l.default({urlId:u,bitrate:d,level:this.context.frag.level}),h=new s.default({sn:this.context.frag.sn,trackView:f,time:this.context.frag.start}),_={url:t,headers:i,withCredentials:a},p={onSuccess:this.loadSuccess.bind(this),onError:this.loadError.bind(this),onProgress:this.loadProgress.bind(this)};this.stats.tfirst=null,this.stats.loaded=0,this.requestTimeout=setTimeout(this.loadTimeout.bind(this),this.config.timeout),this.peerAgentLoader=e.peerAgentModule.getSegment(_,p,h)}},{key:"loadProgress",value:function(e){var t=0;e.cdnDownloaded&&(t+=e.cdnDownloaded),e.p2pDownloaded&&(t+=e.p2pDownloaded),this.stats.loaded=t,e.lengthComputable&&(this.stats.total=e.total),null===this.stats.tfirst&&(this.stats.tfirst=Math.max(performance.now(),this.stats.trequest)),this.callbacks.onProgress(this.stats,this.context)}},{key:"loadTimeout",value:function(){this.callbacks.onTimeout(this.stats,this.context)}}]),t}()};t.default=d,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(12),a=r(i),o=n(13),s=r(o),u=function(e){var t=e.hls.constructor.version;if(void 0===t)return(0,a.default)(e);var n=t.split("."),r=n[1],i=n[2];return Number(r)>=6&&Number(i)>=2?(0,s.default)(e):(0,a.default)(e)};t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(17),l=r(u),c=n(1),d=r(c),f=n(10),h=r(f),_=function(e){function t(e,n){i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));r.hls=e,r.onDispose=n;var o=e.constructor.Events.LEVEL_SWITCH||e.constructor.Events.LEVEL_SWITCHING;if(void 0===o)throw new Error("Can't find neither LEVEL_SWITCH nor LEVEL_SWITCHING hls.js event.");r.hls.on(o,function(e,t){var n=r.hls.levels[t.level],i=n.urlId,a=n.bitrate;r.emit(h.default.TRACK_CHANGE_EVENT,{video:new d.default({urlId:i,bitrate:a,level:t.level})})});var s=e.constructor.Events.FRAG_LOAD_EMERGENCY_ABORTED;if(void 0===s)throw new Error("Can not find FRAG_LOAD_EMERGENCY_ABORTED hls.js event.");r.hls.on(s,function(){r.emit(h.default.EMERGENCY_FRAG_LOAD_ABORT)});var u=e.constructor.Events.DESTROYING;if(void 0===u)throw new Error("Can not find DESTROYING event hls.js event.");return r.hls.on(u,function(){r.onDispose()}),r}return o(t,e),s(t,[{key:"isLive",value:function(){if(!this.hls.levels)throw new Error("Called isLive before the master playlist was parsed");var e=!0,t=!1,n=void 0;try{for(var r,i=this.hls.levels[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var a=r.value;if(a.details)return!!a.details.live}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}throw new Error("Called isLive before any levelplaylist was parsed")}},{key:"getBufferLevelMax",value:function(){var e=void 0,t=void 0;if(this.hls.config.liveSyncDuration?(e="liveSyncDuration",t=this.hls.config.liveSyncDuration):(e="maxBufferLength",t=this.hls.config.maxBufferLength),t<0)throw Error("Invalid configuration: hlsjsConfig."+e+" must be greater than p2pConfig.liveMinBufferMargin");return t}},{key:"setBufferMarginLive",value:function(e){this.hls.config.maxBufferSize=0,this.hls.config.maxBufferLength=e}},{key:"addEventListener",value:function(e,t){h.default.isSupported(e)&&this.on(e,t)}},{key:"removeEventListener",value:function(e,t){h.default.isSupported(e)&&this.removeListener(e,t)}}]),t}(l.default);t.default=_,e.exports=t.default},function(e,t){"use strict";function n(e){var t={get stats(){return e.peerAgentModule.stats},get version(){return e.peerAgentModule.version},get isP2PEnabled(){return e.peerAgentModule.isP2PEnabled},get p2pDownloadOn(){return e.peerAgentModule.p2pDownloadOn},set p2pDownloadOn(t){e.peerAgentModule.p2pDownloadOn=t},get p2pUploadOn(){return e.peerAgentModule.p2pUploadOn},set p2pUploadOn(t){e.peerAgentModule.p2pUploadOn=t}};return t}Object.defineProperty(t,"__esModule",{value:!0}),t.default={get:n},e.exports=t.default},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function i(e){return"number"==typeof e}function a(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!i(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,i,s,u,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}if(n=this._events[e],o(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(a(n))for(s=Array.prototype.slice.call(arguments,1),l=n.slice(),i=l.length,u=0;u<i;u++)l[u].apply(this,s);return!0},n.prototype.addListener=function(e,t){var i;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned&&(i=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,"function"==typeof console.trace)),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var i=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,i,o,s;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],o=n.length,i=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(n)){for(s=o;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){i=s;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t){!function(n){if("object"==typeof t&&"undefined"!=typeof e)e.exports=n();else if(true)!(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_FACTORY__ = (n),
            __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
                (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),
        __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));else{var r;r="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,r.Hls=n()}}(function(){var e;return function e(t,n,r){function i(o,s){if(!n[o]){if(!t[o]){var u="function"==typeof require&&require;if(!s&&u)return require(o,!0);if(a)return a(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[o]={exports:{}};t[o][0].call(c.exports,function(e){var n=t[o][1][e];return i(n?n:e)},c,c.exports,e,t,n,r)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function a(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!a(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,a,u,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}if(n=this._events[e],s(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(o(n))for(a=Array.prototype.slice.call(arguments,1),l=n.slice(),r=l.length,u=0;u<r;u++)l[u].apply(this,a);return!0},r.prototype.addListener=function(e,t){var n;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(n=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,"function"==typeof console.trace)),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!i(t))throw TypeError("listener must be a function");var r=!1;return n.listener=t,this.on(e,n),this},r.prototype.removeListener=function(e,t){var n,r,a,s;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],a=n.length,r=-1,n===t||i(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(s=a;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){r=s;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],
            this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],i(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},{}],2:[function(t,n,r){!function(t){var i=/^([^#]*)(.*)$/,a=/^([^\?]*)(.*)$/,o=/^(([a-z]+:\/\/)?[^:\/]+(?::[0-9]+)?)?(\/?.*)$/i,s={buildAbsoluteURL:function(e,t){if(t=t.trim(),/^[a-z]+:/i.test(t))return t;var n=null,r=null,u=i.exec(t);u&&(r=u[2],t=u[1]);var l=a.exec(t);l&&(n=l[2],t=l[1]);var c=i.exec(e);c&&(e=c[1]);var d=a.exec(e);d&&(e=d[1]);var f=o.exec(e);if(!f)throw new Error("Error trying to parse base URL.");var h=f[2]||"",_=f[1]||"",p=f[3];0!==p.indexOf("/")&&""!==_&&(p="/"+p);var v=null;return v=/^\/\//.test(t)?h+s.buildAbsolutePath("",t.substring(2)):/^\//.test(t)?_+"/"+s.buildAbsolutePath("",t.substring(1)):s.buildAbsolutePath(_+p,t),n&&(v+=n),r&&(v+=r),v},buildAbsolutePath:function(e,t){for(var n,r,i=t,a="",o=e.replace(/[^\/]*$/,i.replace(/(\/|^)(?:\.?\/+)+/g,"$1")),s=0;r=o.indexOf("/../",s),r>-1;s=r+n)n=/^\/(?:\.\.\/)*/.exec(o.slice(r))[0].length,a=(a+o.substring(s,r)).replace(new RegExp("(?:\\/+[^\\/]*){0,"+(n-1)/3+"}$"),"/");return a+o.substr(s)}};"object"==typeof r&&"object"==typeof n?n.exports=s:"function"==typeof e&&e.amd?e([],function(){return s}):"object"==typeof r?r.URLToolkit=s:t.URLToolkit=s}(this)},{}],3:[function(e,t,n){var r=arguments[3],i=arguments[4],a=arguments[5],o=JSON.stringify;t.exports=function(e,t){function n(e){v[e]=!0;for(var t in i[e][1]){var r=i[e][1][t];v[r]||n(r)}}for(var s,u=Object.keys(a),l=0,c=u.length;l<c;l++){var d=u[l],f=a[d].exports;if(f===e||f&&f.default===e){s=d;break}}if(!s){s=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var h={},l=0,c=u.length;l<c;l++){var d=u[l];h[d]=d}i[s]=[Function(["require","module","exports"],"("+e+")(self)"),h]}var _=Math.floor(Math.pow(16,8)*Math.random()).toString(16),p={};p[s]=s,i[_]=[Function(["require"],"var f = require("+o(s)+");(f.default ? f.default : f)(self);"),p];var v={};n(_);var E="("+r+")({"+Object.keys(v).map(function(e){return o(e)+":["+i[e][0]+","+o(i[e][1])+"]"}).join(",")+"},{},["+o(_)+"])",g=window.URL||window.webkitURL||window.mozURL||window.msURL,m=new Blob([E],{type:"text/javascript"});if(t&&t.bare)return m;var y=g.createObjectURL(m),S=new Worker(y);return S.objectURL=y,S}},{}],4:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e(28),l=r(u),c=e(27),d=r(c),f=e(30),h=r(f),_=e(26),p=e(45),v=e(9),E=r(v),g=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.FRAG_LOADING,l.default.FRAG_LOADED,l.default.FRAG_BUFFERED,l.default.ERROR));return n.lastLoadedFragLevel=0,n._autoLevelCapping=-1,n._nextAutoLevel=-1,n.hls=e,n.onCheck=n.abandonRulesCheck.bind(n),n}return o(t,e),s(t,[{key:"destroy",value:function(){this.clearTimer(),d.default.prototype.destroy.call(this)}},{key:"onFragLoading",value:function(e){var t=e.frag;if("main"===t.type){if(this.timer||(this.timer=setInterval(this.onCheck,100)),!this.bwEstimator){var n=this.hls,r=e.frag.level,i=n.levels[r].details.live,a=n.config,o=void 0,s=void 0;i?(o=a.abrEwmaFastLive,s=a.abrEwmaSlowLive):(o=a.abrEwmaFastVoD,s=a.abrEwmaSlowVoD),this.bwEstimator=new E.default(n,s,o,a.abrEwmaDefaultEstimate)}this.fragCurrent=t}}},{key:"abandonRulesCheck",value:function(){var e=this.hls,t=e.media,n=this.fragCurrent,r=n.loader,i=this.minAutoLevel;if(!r||r.stats&&r.stats.aborted)return p.logger.warn("frag loader destroy or aborted, disarm abandonRules"),void this.clearTimer();var a=r.stats;if(t&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&n.autoLevel&&n.level){var o=performance.now()-a.trequest,s=Math.abs(t.playbackRate);if(o>500*n.duration/s){var u=e.levels,c=Math.max(1,a.bw?a.bw/8:1e3*a.loaded/o),d=u[n.level],f=d.realBitrate?Math.max(d.realBitrate,d.bitrate):d.bitrate,_=a.total?a.total:Math.max(a.loaded,Math.round(n.duration*f/8)),v=t.currentTime,E=(_-a.loaded)/c,g=(h.default.bufferInfo(t,v,e.config.maxBufferHole).end-v)/s;if(g<2*n.duration/s&&E>g){var m=void 0,y=void 0;for(y=n.level-1;y>i;y--){var S=u[y].realBitrate?Math.max(u[y].realBitrate,u[y].bitrate):u[y].bitrate;if(m=n.duration*S/(6.4*c),m<g)break}m<E&&(p.logger.warn("loading too slow, abort fragment loading and switch to level "+y+":fragLoadedDelay["+y+"]<fragLoadedDelay["+(n.level-1)+"];bufferStarvationDelay:"+m.toFixed(1)+"<"+E.toFixed(1)+":"+g.toFixed(1)),e.nextLoadLevel=y,this.bwEstimator.sample(o,a.loaded),r.abort(),this.clearTimer(),e.trigger(l.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,stats:a}))}}}}},{key:"onFragLoaded",value:function(e){var t=e.frag;if("main"===t.type){this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1;var n=this.hls.levels[t.level],r=(n.loaded?n.loaded.bytes:0)+e.stats.loaded,i=(n.loaded?n.loaded.duration:0)+e.frag.duration;if(n.loaded={bytes:r,duration:i},n.realBitrate=Math.round(8*r/i),e.frag.bitrateTest){var a=e.stats;a.tparsed=a.tbuffered=a.tload,this.onFragBuffered(e)}}}},{key:"onFragBuffered",value:function(e){var t=e.stats,n=e.frag;if(t.aborted!==!0&&1===n.loadCounter&&"main"===n.type&&(!n.bitrateTest||t.tload===t.tbuffered)){var r=t.tparsed-t.trequest;p.logger.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this.bwEstimator.sample(r,t.loaded),n.bitrateTest?this.bitrateTestDelay=r/1e3:this.bitrateTestDelay=0}}},{key:"onError",value:function(e){switch(e.details){case _.ErrorDetails.FRAG_LOAD_ERROR:case _.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}}},{key:"clearTimer",value:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}},{key:"findBestLevel",value:function(e,t,n,r,i,a,o,s,u){for(var l=i;l>=r;l--){var c=u[l],d=c.details,f=d?d.totalduration/d.fragments.length:t,h=!!d&&d.live,_=void 0;_=l<=e?o*n:s*n;var v=u[l].realBitrate?Math.max(u[l].realBitrate,u[l].bitrate):u[l].bitrate,E=v*f/_;if(p.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+l+"/"+Math.round(_)+"/"+v+"/"+f+"/"+a+"/"+E),_>v&&(!E||h||E<a))return l}return-1}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){this._autoLevelCapping=e}},{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this.bwEstimator,n=this.hls,r=n.levels,i=n.config.minAutoBitrate;if(!(e===-1||t&&t.canEstimate()))return Math.min(e,this.maxAutoLevel);var a=this.nextABRAutoLevel;if(e!==-1&&(a=Math.min(e,a)),void 0!==i)for(var o=r[a].realBitrate?Math.max(r[a].realBitrate,r[a].bitrate):r[a].bitrate;o<i;)a++;return a},set:function(e){this._nextAutoLevel=e}},{key:"minAutoLevel",get:function(){for(var e=this.hls,t=e.levels,n=e.config.minAutoBitrate,r=t?t.length:0,i=0;i<r;i++){var a=t[i].realBitrate?Math.max(t[i].realBitrate,t[i].bitrate):t[i].bitrate;if(a>n)return i}return 0}},{key:"maxAutoLevel",get:function(){var e,t=this.hls.levels,n=this._autoLevelCapping;return e=n===-1&&t&&t.length?t.length-1:n}},{key:"nextABRAutoLevel",get:function(){var e=this.hls,t=this.maxAutoLevel,n=e.levels,r=e.config,i=this.minAutoLevel,a=e.media,o=this.lastLoadedFragLevel,s=this.fragCurrent?this.fragCurrent.duration:0,u=a?a.currentTime:0,l=a&&0!==a.playbackRate?Math.abs(a.playbackRate):1,c=this.bwEstimator?this.bwEstimator.getEstimate():r.abrEwmaDefaultEstimate,d=(h.default.bufferInfo(a,u,r.maxBufferHole).end-u)/l,f=this.findBestLevel(o,s,c,i,t,d,r.abrBandWidthFactor,r.abrBandWidthUpFactor,n);if(f>=0)return f;p.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var _=s?Math.min(s,r.maxStarvationDelay):r.maxStarvationDelay,v=r.abrBandWidthFactor,E=r.abrBandWidthUpFactor;if(0===d){var g=this.bitrateTestDelay;if(g){var m=s?Math.min(s,r.maxLoadingDelay):r.maxLoadingDelay;_=m-g,p.logger.trace("bitrate test took "+Math.round(1e3*g)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*_)+" ms"),v=E=1}}return f=this.findBestLevel(o,s,c,i,t,d+_,v,E,n),Math.max(f,0)}}]),t}(d.default);n.default=g},{26:26,27:27,28:28,30:30,45:45,9:9}],5:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=e(41),c=r(l),d=e(30),f=r(d),h=e(22),_=r(h),p=e(28),v=r(p),E=e(27),g=r(E),m=e(31),y=r(m),S=e(46),T=r(S),A=e(26),R=e(45),D={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS"},C=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,v.default.MEDIA_ATTACHED,v.default.MEDIA_DETACHING,v.default.AUDIO_TRACKS_UPDATED,v.default.AUDIO_TRACK_SWITCHING,v.default.AUDIO_TRACK_LOADED,v.default.KEY_LOADED,v.default.FRAG_LOADED,v.default.FRAG_PARSING_INIT_SEGMENT,v.default.FRAG_PARSING_DATA,v.default.FRAG_PARSED,v.default.ERROR,v.default.BUFFER_CREATED,v.default.BUFFER_APPENDED,v.default.BUFFER_FLUSHED,v.default.INIT_PTS_FOUND));return n.config=e.config,n.audioCodecSwap=!1,n.ticks=0,n._state=D.STOPPED,n.ontick=n.tick.bind(n),n.initPTS=[],n.waitingFragment=null,n}return o(t,e),u(t,[{key:"destroy",value:function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),g.default.prototype.destroy.call(this),this.state=D.STOPPED}},{key:"onInitPtsFound",value:function(e){var t=e.id,n=e.cc,r=e.initPTS;"main"===t&&(this.initPTS[n]=r,R.logger.log("InitPTS for cc:"+n+" found from video track:"+r),this.state===D.WAITING_INIT_PTS&&(R.logger.log("sending pending audio frag to demuxer"),this.state=D.FRAG_LOADING,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null))}},{key:"startLoad",value:function(e){if(this.tracks){var t=this.lastCurrentTime;this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),this.fragLoadError=0,t>0&&e===-1?(R.logger.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=D.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=D.STARTING),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=e,this.state=D.STOPPED}},{key:"stopLoad",value:function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=D.STOPPED}},{key:"tick",value:function(){this.ticks++,1===this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){var e,t,n,r,i,a,o=this,u=this.hls,l=u.config,d=function(){switch(o.state){case D.ERROR:case D.PAUSED:case D.BUFFER_FLUSHING:break;case D.STARTING:o.state=D.WAITING_TRACK,o.loadedmetadata=!1;break;case D.IDLE:var s=o.tracks;if(!s)break;if(!o.media&&(o.startFragRequested||!l.startFragPrefetch))break;e=o.loadedmetadata?o.media.currentTime:o.nextLoadPosition;var d=o.mediaBuffer?o.mediaBuffer:o.media,h=f.default.bufferInfo(d,e,l.maxBufferHole),_=h.len,p=h.end,E=o.fragPrevious,g=l.maxMaxBufferLength,m=o.audioSwitch,y=o.trackId;if(_<g&&y<s.length){if(n=s[y].details,"undefined"==typeof n){o.state=D.WAITING_TRACK;break}if(!m&&!n.live&&E&&E.sn===n.endSN&&(!o.media.seeking||o.media.duration-p<E.duration/2)){o.hls.trigger(v.default.BUFFER_EOS,{type:"audio"}),o.state=D.ENDED;break}var S=n.fragments,T=S.length,C=S[0].start,w=S[T-1].start+S[T-1].duration,b=void 0;if(m)if(n.live&&!n.PTSKnown)R.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment"),p=0;else if(p=e,n.PTSKnown&&e<C){if(!(h.end>C||h.nextStart))return{v:void 0};R.logger.log("alt audio track ahead of main track, seek to start of alt audio track"),o.media.currentTime=C+.05}if(p<=C){if(b=S[0],n.live&&b.loadIdx&&b.loadIdx===o.fragLoadIdx){var O=h.nextStart?h.nextStart:C;return R.logger.log("no alt audio available @currentTime:"+o.media.currentTime+", seeking @"+(O+.05)),o.media.currentTime=O+.05,{v:void 0}}}else!function(){var e=void 0,t=l.maxFragLookUpTolerance;p<w?(p>w-t&&(t=0),e=c.default.search(S,function(e){return e.start+e.duration-t<=p?1:e.start-t>p?-1:0}),e||R.logger.log("frag not found @bufferEnd/start:"+p+"/"+C)):e=S[T-1],e&&(b=e,C=e.start,E&&b.level===E.level&&b.sn===E.sn&&(b.sn<n.endSN?(b=S[b.sn+1-n.startSN],R.logger.log("SN just loaded, load next one: "+b.sn)):b=null))}();if(b)if(null!=b.decryptdata.uri&&null==b.decryptdata.key)R.logger.log("Loading key for "+b.sn+" of ["+n.startSN+" ,"+n.endSN+"],track "+y),o.state=D.KEY_LOADING,u.trigger(v.default.KEY_LOADING,{frag:b});else{if(R.logger.log("Loading "+b.sn+" of ["+n.startSN+" ,"+n.endSN+"],track "+y+", currentTime:"+e+",bufferEnd:"+p.toFixed(3)),void 0!==o.fragLoadIdx?o.fragLoadIdx++:o.fragLoadIdx=0,b.loadCounter){b.loadCounter++;var P=l.fragLoadingLoopThreshold;if(b.loadCounter>P&&Math.abs(o.fragLoadIdx-b.loadIdx)<P)return u.trigger(v.default.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:b}),{v:void 0}}else b.loadCounter=1;b.loadIdx=o.fragLoadIdx,o.fragCurrent=b,o.startFragRequested=!0,o.nextLoadPosition=b.start+b.duration,u.trigger(v.default.FRAG_LOADING,{frag:b}),o.state=D.FRAG_LOADING}}break;case D.WAITING_TRACK:t=o.tracks[o.trackId],t&&t.details&&(o.state=D.IDLE);break;case D.FRAG_LOADING_WAITING_RETRY:r=performance.now(),i=o.retryDate,d=o.media,a=d&&d.seeking,(!i||r>=i||a)&&(R.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),o.state=D.IDLE);break;case D.WAITING_INIT_PTS:case D.STOPPED:case D.FRAG_LOADING:case D.PARSING:case D.PARSED:case D.ENDED:}}();if("object"===("undefined"==typeof d?"undefined":s(d)))return d.v}},{key:"onMediaAttached",value:function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("ended",this.onvended);var n=this.config;this.tracks&&n.autoStartLoad&&this.startLoad(n.startPosition)}},{key:"onMediaDetaching",value:function(){var e=this.media;e&&e.ended&&(R.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.tracks;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.loadCounter=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()}},{key:"onMediaSeeking",value:function(){this.state===D.ENDED&&(this.state=D.IDLE),this.media&&(this.lastCurrentTime=this.media.currentTime),void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),this.tick()}},{key:"onMediaEnded",value:function(){this.startPosition=this.lastCurrentTime=0}},{key:"onAudioTracksUpdated",value:function(e){R.logger.log("audio tracks updated"),this.tracks=e.audioTracks}},{key:"onAudioTrackSwitching",value:function(e){var t=!!e.url;this.trackId=e.id,this.state=D.IDLE,this.fragCurrent=null,this.state=D.PAUSED,this.waitingFragment=null,t?this.timer||(this.timer=setInterval(this.ontick,100)):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),t&&(this.audioSwitch=!0,this.state=D.IDLE,void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold)),this.tick()}},{key:"onAudioTrackLoaded",value:function(e){var t=e.details,n=e.id,r=this.tracks[n],i=t.totalduration,a=0;if(R.logger.log("track "+n+" loaded ["+t.startSN+","+t.endSN+"],duration:"+i),t.live){var o=r.details;o&&t.fragments.length>0?(y.default.mergeDetails(o,t),a=t.fragments[0].start,t.PTSKnown?R.logger.log("live audio playlist sliding:"+a.toFixed(3)):R.logger.log("live audio playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,R.logger.log("live audio playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(r.details=t,!this.startFragRequested){if(this.startPosition===-1){var s=t.startTimeOffset;isNaN(s)?this.startPosition=0:(R.logger.log("start time offset found in playlist, adjust startPosition to "+s),this.startPosition=s)}this.nextLoadPosition=this.startPosition}this.state===D.WAITING_TRACK&&(this.state=D.IDLE),this.tick()}},{key:"onKeyLoaded",value:function(){this.state===D.KEY_LOADING&&(this.state=D.IDLE,this.tick())}},{key:"onFragLoaded",value:function(e){var t=this.fragCurrent;if(this.state===D.FRAG_LOADING&&t&&"audio"===e.frag.type&&e.frag.level===t.level&&e.frag.sn===t.sn){this.state=D.PARSING,this.stats=e.stats;var n=this.tracks[this.trackId],r=n.details,i=r.totalduration,a=t.start,o=t.level,s=t.sn,u=t.cc,l=this.config.defaultAudioCodec||n.audioCodec;this.appended=!1,this.demuxer||(this.demuxer=new _.default(this.hls,"audio"));var c=this.initPTS[u];if(void 0!==c){this.pendingBuffering=!0,R.logger.log("Demuxing "+s+" of ["+r.startSN+" ,"+r.endSN+"],track "+o);var d=!1;this.demuxer.push(e.payload,l,null,a,u,o,s,i,t.decryptdata,d,c)}else R.logger.log("unknown video PTS for continuity counter "+u+", waiting for video PTS before demuxing audio frag "+s+" of ["+r.startSN+" ,"+r.endSN+"],track "+o),this.waitingFragment=e,this.state=D.WAITING_INIT_PTS}this.fragLoadError=0}},{key:"onFragParsingInitSegment",value:function(e){var t=this.fragCurrent;if(t&&"audio"===e.id&&e.sn===t.sn&&e.level===t.level&&this.state===D.PARSING){var n=e.tracks,r=void 0;if(n.video&&delete n.video,r=n.audio){r.levelCodec="mp4a.40.2",r.id=e.id,this.hls.trigger(v.default.BUFFER_CODECS,n),R.logger.log("audio track:audio,container:"+r.container+",codecs[level/parsed]=["+r.levelCodec+"/"+r.codec+"]");var i=r.initSegment;if(i){var a={type:"audio",data:i,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[a]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(v.default.BUFFER_APPENDING,a))}this.tick()}}}},{key:"onFragParsingData",value:function(e){var t=this,n=this.fragCurrent;n&&"audio"===e.id&&"audio"===e.type&&e.sn===n.sn&&e.level===n.level&&this.state===D.PARSING&&!function(){var n=t.trackId,r=t.tracks[n],i=t.fragCurrent,a=t.hls;R.logger.log("parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb),y.default.updateFragPTSDTS(r.details,i.sn,e.startPTS,e.endPTS);var o=t.audioSwitch,s=t.media,u=!1;if(o&&s)if(s.readyState){var l=s.currentTime;R.logger.log("switching audio track : currentTime:"+l),l>=e.startPTS&&(R.logger.log("switching audio track : flushing all audio"),t.state=D.BUFFER_FLUSHING,a.trigger(v.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),u=!0,t.audioSwitch=!1,a.trigger(v.default.AUDIO_TRACK_SWITCHED,{id:n}))}else t.audioSwitch=!1,a.trigger(v.default.AUDIO_TRACK_SWITCHED,{id:n});var c=t.pendingData;t.audioSwitch||([e.data1,e.data2].forEach(function(t){t&&c.push({type:e.type,data:t,parent:"audio",content:"data"})}),!u&&c.length&&(c.forEach(function(e){t.pendingBuffering=!0,t.hls.trigger(v.default.BUFFER_APPENDING,e)}),t.pendingData=[],t.appended=!0)),t.tick()}()}},{key:"onFragParsed",value:function(e){var t=this.fragCurrent;t&&"audio"===e.id&&e.sn===t.sn&&e.level===t.level&&this.state===D.PARSING&&(this.stats.tparsed=performance.now(),this.state=D.PARSED,this._checkAppendedParsed())}},{key:"onBufferCreated",value:function(e){var t=e.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0)}},{key:"onBufferAppended",value:function(e){if("audio"===e.parent){var t=this.state;t!==D.PARSING&&t!==D.PARSED||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}}},{key:"_checkAppendedParsed",value:function(){if(!(this.state!==D.PARSED||this.appended&&this.pendingBuffering)){var e=this.fragCurrent,t=this.stats,n=this.hls;if(e){this.fragPrevious=e,t.tbuffered=performance.now(),n.trigger(v.default.FRAG_BUFFERED,{stats:t,frag:e,id:"audio"});var r=this.mediaBuffer?this.mediaBuffer:this.media;R.logger.log("audio buffered : "+T.default.toString(r.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,n.trigger(v.default.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=D.IDLE}this.tick()}}},{key:"onError",value:function(e){var t=e.frag;if(!t||"audio"===t.type)switch(e.details){case A.ErrorDetails.FRAG_LOAD_ERROR:case A.ErrorDetails.FRAG_LOAD_TIMEOUT:if(!e.fatal){var n=this.fragLoadError;n?n++:n=1;var r=this.config;if(n<=r.fragLoadingMaxRetry){this.fragLoadError=n,t.loadCounter=0;var i=Math.min(Math.pow(2,n-1)*r.fragLoadingRetryDelay,r.fragLoadingMaxRetryTimeout);R.logger.warn("audioStreamController: frag loading failed, retry in "+i+" ms"),this.retryDate=performance.now()+i,this.state=D.FRAG_LOADING_WAITING_RETRY}else R.logger.error("audioStreamController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.hls.trigger(v.default.ERROR,e),this.state=D.ERROR}break;case A.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case A.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case A.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case A.ErrorDetails.KEY_LOAD_ERROR:case A.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==D.ERROR&&(this.state=e.fatal?D.ERROR:D.IDLE,R.logger.warn("audioStreamController: "+e.details+" while loading frag,switch to "+this.state+" state ..."))}}},{key:"onBufferFlushed",value:function(){var e=this,t=this.pendingData;t&&t.length?(R.logger.log("appending pending audio data on Buffer Flushed"),t.forEach(function(t){e.hls.trigger(v.default.BUFFER_APPENDING,t)}),this.appended=!0,this.pendingData=[],this.state=D.PARSED):(this.state=D.IDLE,this.fragPrevious=null,this.tick())}},{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,R.logger.log("audio stream:"+t+"->"+e)}},get:function(){return this._state}}]),t}(g.default);n.default=C},{22:22,26:26,27:27,28:28,30:30,31:31,41:41,45:45,46:46}],6:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e(28),l=r(u),c=e(27),d=r(c),f=e(45),h=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.MANIFEST_LOADING,l.default.MANIFEST_LOADED,l.default.AUDIO_TRACK_LOADED));return n.ticks=0,n.ontick=n.tick.bind(n),n}return o(t,e),s(t,[{key:"destroy",value:function(){d.default.prototype.destroy.call(this)}},{key:"tick",value:function(){this.ticks++,1===this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){this.updateTrack(this.trackId)}},{key:"onManifestLoading",value:function(){this.tracks=[],this.trackId=-1}},{key:"onManifestLoaded",value:function(e){var t=this,n=e.audioTracks||[],r=!1;this.tracks=n,this.hls.trigger(l.default.AUDIO_TRACKS_UPDATED,{audioTracks:n});var i=0;n.forEach(function(e){return e.default?(t.audioTrack=i,void(r=!0)):void i++}),r===!1&&n.length&&(f.logger.log("no default audio track defined, use first audio track as default"),this.audioTrack=0)}},{key:"onAudioTrackLoaded",value:function(e){e.id<this.tracks.length&&(f.logger.log("audioTrack "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.timer&&(this.timer=setInterval(this.ontick,1e3*e.details.targetduration)),!e.details.live&&this.timer&&(clearInterval(this.timer),this.timer=null))}},{key:"setAudioTrackInternal",value:function(e){if(e>=0&&e<this.tracks.length){this.timer&&(clearInterval(this.timer),this.timer=null),this.trackId=e,f.logger.log("switching to audioTrack "+e);var t=this.tracks[e],n=this.hls,r=t.type,i=t.url,a={id:e,type:r,url:i};n.trigger(l.default.AUDIO_TRACK_SWITCH,a),n.trigger(l.default.AUDIO_TRACK_SWITCHING,a);var o=t.details;!i||void 0!==o&&o.live!==!0||(f.logger.log("(re)loading playlist for audioTrack "+e),n.trigger(l.default.AUDIO_TRACK_LOADING,{url:i,id:e}))}}},{key:"updateTrack",value:function(e){if(e>=0&&e<this.tracks.length){this.timer&&(clearInterval(this.timer),this.timer=null),this.trackId=e,f.logger.log("updating audioTrack "+e);var t=this.tracks[e],n=t.url,r=t.details;!n||void 0!==r&&r.live!==!0||(f.logger.log("(re)loading playlist for audioTrack "+e),this.hls.trigger(l.default.AUDIO_TRACK_LOADING,{url:n,id:e}))}}},{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this.trackId},set:function(e){this.trackId===e&&void 0!==this.tracks[e].details||this.setAudioTrackInternal(e)}}]),t}(d.default);n.default=h},{27:27,28:28,45:45}],7:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e(28),l=r(u),c=e(27),d=r(c),f=e(45),h=e(26),_=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.MEDIA_ATTACHING,l.default.MEDIA_DETACHING,l.default.MANIFEST_PARSED,l.default.BUFFER_RESET,l.default.BUFFER_APPENDING,l.default.BUFFER_CODECS,l.default.BUFFER_EOS,l.default.BUFFER_FLUSHING,l.default.LEVEL_PTS_UPDATED,l.default.LEVEL_UPDATED));return n._msDuration=null,n._levelDuration=null,n.onsbue=n.onSBUpdateEnd.bind(n),n.onsbe=n.onSBUpdateError.bind(n),n.pendingTracks={},n.tracks={},n}return o(t,e),s(t,[{key:"destroy",value:function(){d.default.prototype.destroy.call(this)}},{key:"onLevelPtsUpdated",value:function(e){var t=e.type,n=this.tracks.audio;if("audio"===t&&n&&"audio/mpeg"===n.container){var r=this.sourceBuffer.audio,i=Math.abs(r.timestampOffset-e.start);if(i>.1){var a=r.updating;try{r.abort()}catch(e){a=!0,f.logger.warn("can not abort audio buffer: "+e)}a?this.audioTimestampOffset=e.start:(f.logger.warn("change mpeg audio timestamp offset from "+r.timestampOffset+" to "+e.start),r.timestampOffset=e.start)}}}},{key:"onManifestParsed",value:function(e){var t=e.audio,n=e.video,r=0;e.altAudio&&(t||n)&&(r=(t?1:0)+(n?1:0),f.logger.log(r+" sourceBuffer(s) expected")),this.sourceBufferNb=r}},{key:"onMediaAttaching",value:function(e){var t=this.media=e.media;if(t){var n=this.mediaSource=new MediaSource;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),n.addEventListener("sourceopen",this.onmso),n.addEventListener("sourceended",this.onmse),n.addEventListener("sourceclose",this.onmsc),t.src=URL.createObjectURL(n)}}},{key:"onMediaDetaching",value:function(){f.logger.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){f.logger.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this.onmso),e.removeEventListener("sourceended",this.onmse),e.removeEventListener("sourceclose",this.onmsc),this.media&&(URL.revokeObjectURL(this.media.src),this.media.removeAttribute("src"),this.media.load()),this.mediaSource=null,this.media=null,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(l.default.MEDIA_DETACHED)}},{key:"onMediaSourceOpen",value:function(){f.logger.log("media source opened"),this.hls.trigger(l.default.MEDIA_ATTACHED,{media:this.media});var e=this.mediaSource;e&&e.removeEventListener("sourceopen",this.onmso),this.checkPendingTracks()}},{key:"checkPendingTracks",value:function(){var e=this.pendingTracks,t=Object.keys(e).length;t&&(this.sourceBufferNb<=t||0===this.sourceBufferNb)&&(this.createSourceBuffers(e),this.pendingTracks={},this.doAppending())}},{key:"onMediaSourceClose",value:function(){f.logger.log("media source closed")}},{key:"onMediaSourceEnded",value:function(){f.logger.log("media source ended")}},{key:"onSBUpdateEnd",value:function(){if(this.audioTimestampOffset){var e=this.sourceBuffer.audio;f.logger.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+this.audioTimestampOffset),e.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset}this._needsFlush&&this.doFlush(),
        this._needsEos&&this.checkEos(),this.appending=!1;var t=this.parent,n=this.segments.reduce(function(e,n){return n.parent===t?e+1:e},0);this.hls.trigger(l.default.BUFFER_APPENDED,{parent:t,pending:n}),this._needsFlush||this.doAppending(),this.updateMediaElementDuration()}},{key:"onSBUpdateError",value:function(e){f.logger.error("sourceBuffer error:"+e),this.hls.trigger(l.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})}},{key:"onBufferReset",value:function(){var e=this.sourceBuffer;for(var t in e){var n=e[t];try{this.mediaSource.removeSourceBuffer(n),n.removeEventListener("updateend",this.onsbue),n.removeEventListener("error",this.onsbe)}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}},{key:"onBufferCodecs",value:function(e){if(0===Object.keys(this.sourceBuffer).length){for(var t in e)this.pendingTracks[t]=e[t];var n=this.mediaSource;n&&"open"===n.readyState&&this.checkPendingTracks()}}},{key:"createSourceBuffers",value:function(e){var t=this.sourceBuffer,n=this.mediaSource;for(var r in e)if(!t[r]){var i=e[r],a=i.levelCodec||i.codec,o=i.container+";codecs="+a;f.logger.log("creating sourceBuffer("+o+")");try{var s=t[r]=n.addSourceBuffer(o);s.addEventListener("updateend",this.onsbue),s.addEventListener("error",this.onsbe),this.tracks[r]={codec:a,container:i.container},i.buffer=s}catch(e){f.logger.error("error while trying to add sourceBuffer:"+e.message),this.hls.trigger(l.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:o})}}this.hls.trigger(l.default.BUFFER_CREATED,{tracks:e})}},{key:"onBufferAppending",value:function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())}},{key:"onBufferAppendFail",value:function(e){f.logger.error("sourceBuffer error:",e.event),this.hls.trigger(l.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1,frag:this.fragCurrent})}},{key:"onBufferEos",value:function(e){var t=this.sourceBuffer,n=e.type;for(var r in t)n&&r!==n||t[r].ended||(t[r].ended=!0,f.logger.log(r+" sourceBuffer now EOS"));this.checkEos()}},{key:"checkEos",value:function(){var e=this.sourceBuffer,t=this.mediaSource;if(!t||"open"!==t.readyState)return void(this._needsEos=!1);for(var n in e){var r=e[n];if(!r.ended)return;if(r.updating)return void(this._needsEos=!0)}f.logger.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){f.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}},{key:"onBufferFlushing",value:function(e){this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}),this.flushBufferCounter=0,this.doFlush()}},{key:"onLevelUpdated",value:function(e){var t=e.details;0!==t.fragments.length&&(this._levelDuration=t.totalduration+t.fragments[0].start,this.updateMediaElementDuration())}},{key:"updateMediaElementDuration",value:function(){var e=this.media,t=this.mediaSource,n=this.sourceBuffer,r=this._levelDuration;if(null!==r&&e&&t&&n&&0!==e.readyState&&"open"===t.readyState){for(var i in n)if(n[i].updating)return;null===this._msDuration&&(this._msDuration=t.duration);var a=e.duration;(r>this._msDuration&&r>a||a===1/0||isNaN(a))&&(f.logger.log("Updating mediasource duration to "+r.toFixed(3)),this._msDuration=t.duration=r)}}},{key:"doFlush",value:function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,n=this.sourceBuffer;try{for(var r in n)t+=n[r].buffered.length}catch(e){f.logger.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(l.default.BUFFER_FLUSHED)}}},{key:"doAppending",value:function(){var e=this.hls,t=this.sourceBuffer,n=this.segments;if(Object.keys(t).length){if(this.media.error)return this.segments=[],void f.logger.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(n&&n.length){var r=n.shift();try{var i=r.type,a=t[i];a?a.updating?n.unshift(r):(a.ended=!1,this.parent=r.parent,a.appendBuffer(r.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(t){f.logger.error("error while trying to append buffer:"+t.message),n.unshift(r);var o={type:h.ErrorTypes.MEDIA_ERROR};if(22===t.code)return this.segments=[],o.details=h.ErrorDetails.BUFFER_FULL_ERROR,o.fatal=!1,void e.trigger(l.default.ERROR,o);if(this.appendError?this.appendError++:this.appendError=1,o.details=h.ErrorDetails.BUFFER_APPEND_ERROR,o.frag=this.fragCurrent,this.appendError>e.config.appendErrorMaxRetry)return f.logger.log("fail "+e.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),n=[],o.fatal=!0,void e.trigger(l.default.ERROR,o);o.fatal=!1,e.trigger(l.default.ERROR,o)}}}}},{key:"flushBuffer",value:function(e,t,n){var r,i,a,o,s,u,l=this.sourceBuffer;if(Object.keys(l).length){if(f.logger.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+e+"/"+t),this.flushBufferCounter<this.appended){for(var c in l)if(!n||c===n){if(r=l[c],r.ended=!1,r.updating)return f.logger.warn("cannot flush, sb updating in progress"),!1;try{for(i=0;i<r.buffered.length;i++)if(a=r.buffered.start(i),o=r.buffered.end(i),navigator.userAgent.toLowerCase().indexOf("firefox")!==-1&&t===Number.POSITIVE_INFINITY?(s=e,u=t):(s=Math.max(a,e),u=Math.min(o,t)),Math.min(u,o)-s>.5)return this.flushBufferCounter++,f.logger.log("flush "+c+" ["+s+","+u+"], of ["+a+","+o+"], pos:"+this.media.currentTime),r.remove(s,u),!1}catch(e){f.logger.warn("exception while accessing sourcebuffer, it might have been removed from MediaSource")}}}else f.logger.warn("abort flushing too many retries");f.logger.log("buffer flushed")}return!0}}]),t}(d.default);n.default=_},{26:26,27:27,28:28,45:45}],8:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e(28),l=r(u),c=e(27),d=r(c),f=function(e){function t(e){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.FPS_DROP_LEVEL_CAPPING,l.default.MEDIA_ATTACHING,l.default.MANIFEST_PARSED))}return o(t,e),s(t,[{key:"destroy",value:function(){this.hls.config.capLevelToPlayerSize&&(this.media=this.restrictedLevels=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer)))}},{key:"onFpsDropLevelCapping",value:function(e){this.restrictedLevels||(this.restrictedLevels=[]),this.isLevelRestricted(e.droppedLevel)||this.restrictedLevels.push(e.droppedLevel)}},{key:"onMediaAttaching",value:function(e){this.media=e.media instanceof HTMLVideoElement?e.media:null}},{key:"onManifestParsed",value:function(e){var t=this.hls;t.config.capLevelToPlayerSize&&(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.levels=e.levels,t.firstLevel=this.getMaxLevel(e.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}},{key:"detectPlayerSize",value:function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}},{key:"getMaxLevel",value:function(e){var t=0,n=void 0,r=void 0,i=this.mediaWidth,a=this.mediaHeight,o=0,s=0;for(n=0;n<=e&&(r=this.levels[n],!this.isLevelRestricted(n))&&(t=n,o=r.width,s=r.height,!(i<=o||a<=s));n++);return t}},{key:"isLevelRestricted",value:function(e){return!(!this.restrictedLevels||this.restrictedLevels.indexOf(e)===-1)}},{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e}},{key:"mediaWidth",get:function(){var e=void 0,t=this.media;return t&&(e=t.width||t.clientWidth||t.offsetWidth,e*=this.contentScaleFactor),e}},{key:"mediaHeight",get:function(){var e=void 0,t=this.media;return t&&(e=t.height||t.clientHeight||t.offsetHeight,e*=this.contentScaleFactor),e}}]),t}(d.default);n.default=f},{27:27,28:28}],9:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e(44),s=r(o),u=function(){function e(t,n,r,a){i(this,e),this.hls=t,this.defaultEstimate_=a,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new s.default(n),this.fast_=new s.default(r)}return a(e,[{key:"sample",value:function(e,t){e=Math.max(e,this.minDelayMs_);var n=8e3*t/e,r=e/1e3;this.fast_.sample(r,n),this.slow_.sample(r,n)}},{key:"canEstimate",value:function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_}},{key:"getEstimate",value:function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}},{key:"destroy",value:function(){}}]),e}();n.default=u},{44:44}],10:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e(28),l=r(u),c=e(27),d=r(c),f=e(45),h=function(e){function t(e){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.MEDIA_ATTACHING))}return o(t,e),s(t,[{key:"destroy",value:function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1}},{key:"onMediaAttaching",value:function(e){var t=this.hls.config;if(t.capLevelOnFPSDrop){var n=this.video=e.media instanceof HTMLVideoElement?e.media:null;"function"==typeof n.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod)}}},{key:"checkFPS",value:function(e,t,n){var r=performance.now();if(t){if(this.lastTime){var i=r-this.lastTime,a=n-this.lastDroppedFrames,o=t-this.lastDecodedFrames,s=1e3*a/i,u=this.hls;if(u.trigger(l.default.FPS_DROP,{currentDropped:a,currentDecoded:o,totalDroppedFrames:n}),s>0&&a>u.config.fpsDroppedMonitoringThreshold*o){var c=u.currentLevel;f.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+c),c>0&&(u.autoLevelCapping===-1||u.autoLevelCapping>=c)&&(c-=1,u.trigger(l.default.FPS_DROP_LEVEL_CAPPING,{level:c,droppedLevel:u.currentLevel}),u.autoLevelCapping=c,u.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}},{key:"checkFPSInterval",value:function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}]),t}(d.default);n.default=h},{27:27,28:28,45:45}],11:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e(28),l=r(u),c=e(27),d=r(c),f=e(45),h=e(26),_=e(30),p=r(_),v=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.MANIFEST_LOADED,l.default.LEVEL_LOADED,l.default.FRAG_LOADED,l.default.ERROR));return n.ontick=n.tick.bind(n),n._manualLevel=n._autoLevelCapping=-1,n}return o(t,e),s(t,[{key:"destroy",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this._manualLevel=-1}},{key:"startLoad",value:function(){this.canload=!0;var e=this._levels;e&&e.forEach(function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)}),this.timer&&this.tick()}},{key:"stopLoad",value:function(){this.canload=!1}},{key:"onManifestLoaded",value:function(e){var t,n=[],r=[],i={},a=!1,o=!1,s=this.hls,u=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),c=function(e,t){return MediaSource.isTypeSupported(e+"/mp4;codecs="+t)};if(e.levels.forEach(function(e){e.videoCodec&&(a=!0),u&&e.audioCodec&&e.audioCodec.indexOf("mp4a.40.34")!==-1&&(e.audioCodec=void 0),(e.audioCodec||e.attrs&&e.attrs.AUDIO)&&(o=!0);var t=i[e.bitrate];void 0===t?(i[e.bitrate]=n.length,e.url=[e.url],e.urlId=0,n.push(e)):n[t].url.push(e.url)}),a&&o?n.forEach(function(e){e.videoCodec&&r.push(e)}):r=n,r=r.filter(function(e){var t=e.audioCodec,n=e.videoCodec;return(!t||c("audio",t))&&(!n||c("video",n))}),r.length){t=r[0].bitrate,r.sort(function(e,t){return e.bitrate-t.bitrate}),this._levels=r;for(var d=0;d<r.length;d++)if(r[d].bitrate===t){this._firstLevel=d,f.logger.log("manifest loaded,"+r.length+" level(s) found, first bitrate:"+t);break}s.trigger(l.default.MANIFEST_PARSED,{levels:r,firstLevel:this._firstLevel,stats:e.stats,audio:o,video:a,altAudio:e.audioTracks.length>0})}else s.trigger(l.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:s.url,reason:"no level with compatible codecs found in manifest"})}},{key:"setLevelInternal",value:function(e){var t=this._levels;if(e>=0&&e<t.length){this.timer&&(clearTimeout(this.timer),this.timer=null),this._level!==e&&(f.logger.log("switching to level "+e),this._level=e,this.hls.trigger(l.default.LEVEL_SWITCH,{level:e}));var n=t[e],r=n.details;if(!r||r.live===!0){var i=n.urlId;this.hls.trigger(l.default.LEVEL_LOADING,{url:n.url[i],level:e,id:i})}}else this.hls.trigger(l.default.ERROR,{type:h.ErrorTypes.OTHER_ERROR,details:h.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})}},{key:"onError",value:function(e){if(!e.fatal){var t=e.details,n=this.hls,r=void 0,i=void 0,a=!1,o=n.abrController,s=o.minAutoLevel;switch(t){case h.ErrorDetails.FRAG_LOAD_ERROR:case h.ErrorDetails.FRAG_LOAD_TIMEOUT:case h.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case h.ErrorDetails.KEY_LOAD_ERROR:case h.ErrorDetails.KEY_LOAD_TIMEOUT:r=e.frag.level;break;case h.ErrorDetails.LEVEL_LOAD_ERROR:case h.ErrorDetails.LEVEL_LOAD_TIMEOUT:r=e.context.level,a=!0;break;case h.ErrorDetails.REMUX_ALLOC_ERROR:r=e.level}if(void 0!==r){i=this._levels[r],i.loadError?i.loadError++:i.loadError=1;var u=i.url.length;if(u>1&&i.loadError<u)i.urlId=(i.urlId+1)%u,i.details=void 0,f.logger.warn("level controller,"+t+" for level "+r+": switching to redundant stream id "+i.urlId);else{var c=this._manualLevel===-1&&r;if(c)f.logger.warn("level controller,"+t+": switch-down for next fragment"),o.nextAutoLevel=Math.max(s,r-1);else if(i&&i.details&&i.details.live)f.logger.warn("level controller,"+t+" on live stream, discard"),a&&(this._level=void 0);else if(t===h.ErrorDetails.LEVEL_LOAD_ERROR||t===h.ErrorDetails.LEVEL_LOAD_TIMEOUT){var d=n.media,_=d&&p.default.isBuffered(d,d.currentTime)&&p.default.isBuffered(d,d.currentTime+.5);if(_){var v=n.config.levelLoadingRetryDelay;f.logger.warn("level controller,"+t+", but media buffered, retry in "+v+"ms"),this.timer=setTimeout(this.ontick,v)}else f.logger.error("cannot recover "+t+" error"),this._level=void 0,this.timer&&(clearTimeout(this.timer),this.timer=null),e.fatal=!0,n.trigger(l.default.ERROR,e)}}}}}},{key:"onFragLoaded",value:function(e){var t=e.frag;if(t&&"main"===t.type){var n=this._levels[t.level];n&&(n.loadError=0)}}},{key:"onLevelLoaded",value:function(e){var t=e.level;if(t===this._level){var n=this._levels[t];n.loadError=0;var r=e.details;if(r.live){var i=1e3*(r.averagetargetduration?r.averagetargetduration:r.targetduration),a=n.details;a&&r.endSN===a.endSN&&(i/=2,f.logger.log("same live playlist, reload twice faster")),i-=performance.now()-e.stats.trequest,i=Math.max(1e3,Math.round(i)),f.logger.log("live playlist, reload in "+i+" ms"),this.timer=setTimeout(this.ontick,i)}else this.timer=null}}},{key:"tick",value:function(){var e=this._level;if(void 0!==e&&this.canload){var t=this._levels[e],n=t.urlId;this.hls.trigger(l.default.LEVEL_LOADING,{url:t.url[n],level:e,id:n})}}},{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this._level},set:function(e){var t=this._levels;t&&t.length>e&&(this._level===e&&void 0!==t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this._manualLevel},set:function(e){this._manualLevel=e,void 0===this._startLevel&&(this._startLevel=e),e!==-1&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){e!==-1&&(e=Math.max(e,this.hls.abrController.minAutoLevel)),this._startLevel=e}},{key:"nextLoadLevel",get:function(){return this._manualLevel!==-1?this._manualLevel:this.hls.abrController.nextAutoLevel},set:function(e){this.level=e,this._manualLevel===-1&&(this.hls.abrController.nextAutoLevel=e)}}]),t}(d.default);n.default=v},{26:26,27:27,28:28,30:30,45:45}],12:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e(41),l=r(u),c=e(30),d=r(c),f=e(22),h=r(f),_=e(28),p=r(_),v=e(27),E=r(v),g=e(31),m=r(g),y=e(46),S=r(y),T=e(26),A=e(45),R={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_LEVEL:"WAITING_LEVEL",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR"},D=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,p.default.MEDIA_ATTACHED,p.default.MEDIA_DETACHING,p.default.MANIFEST_LOADING,p.default.MANIFEST_PARSED,p.default.LEVEL_LOADED,p.default.KEY_LOADED,p.default.FRAG_LOADED,p.default.FRAG_LOAD_EMERGENCY_ABORTED,p.default.FRAG_PARSING_INIT_SEGMENT,p.default.FRAG_PARSING_DATA,p.default.FRAG_PARSED,p.default.ERROR,p.default.AUDIO_TRACK_SWITCHING,p.default.AUDIO_TRACK_SWITCHED,p.default.BUFFER_CREATED,p.default.BUFFER_APPENDED,p.default.BUFFER_FLUSHED));return n.config=e.config,n.audioCodecSwap=!1,n.ticks=0,n._state=R.STOPPED,n.ontick=n.tick.bind(n),n}return o(t,e),s(t,[{key:"destroy",value:function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),E.default.prototype.destroy.call(this),this.state=R.STOPPED}},{key:"startLoad",value:function(e){if(this.levels){var t=this.lastCurrentTime,n=this.hls;if(this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var r=n.startLevel;r===-1&&(r=0,this.bitrateTest=!0),this.level=n.nextLoadLevel=r,this.loadedmetadata=!1}t>0&&e===-1&&(A.logger.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=R.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else A.logger.warn("cannot start loading as manifest not parsed yet"),this.state=R.STOPPED}},{key:"stopLoad",value:function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=R.STOPPED}},{key:"tick",value:function(){this.ticks++,1===this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){switch(this.state){case R.ERROR:break;case R.BUFFER_FLUSHING:this.fragLoadError=0;break;case R.IDLE:if(!this._doTickIdle())return;break;case R.WAITING_LEVEL:var e=this.levels[this.level];e&&e.details&&(this.state=R.IDLE);break;case R.FRAG_LOADING_WAITING_RETRY:var t=performance.now(),n=this.retryDate;(!n||t>=n||this.media&&this.media.seeking)&&(A.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=R.IDLE);break;case R.ERROR:case R.STOPPED:case R.FRAG_LOADING:case R.PARSING:case R.PARSED:case R.ENDED:}this._checkBuffer(),this._checkFragmentChanged()}},{key:"_doTickIdle",value:function(){var e=this.hls,t=e.config,n=this.media;if(void 0!==this.levelLastLoaded&&!n&&(this.startFragRequested||!t.startFragPrefetch))return!0;var r=void 0;r=this.loadedmetadata?n.currentTime:this.nextLoadPosition;var i=e.nextLoadLevel,a=this.levels[i],o=a.bitrate,s=void 0;s=o?Math.max(8*t.maxBufferSize/o,t.maxBufferLength):t.maxBufferLength,s=Math.min(s,t.maxMaxBufferLength);var u=d.default.bufferInfo(this.mediaBuffer?this.mediaBuffer:n,r,t.maxBufferHole),l=u.len;if(l>=s)return!0;A.logger.trace("buffer length of "+l.toFixed(3)+" is below max of "+s.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=i;var c=a.details;if("undefined"==typeof c||c.live&&this.levelLastLoaded!==i)return this.state=R.WAITING_LEVEL,!0;var f=this.fragPrevious;if(!c.live&&f&&f.sn===c.endSN&&n.duration-Math.max(u.end,f.start)<=Math.max(.2,f.duration/2)){var h={};return this.altAudio&&(h.type="video"),this.hls.trigger(p.default.BUFFER_EOS,h),this.state=R.ENDED,!0}return this._fetchPayloadOrEos(r,u,c)}},{key:"_fetchPayloadOrEos",value:function(e,t,n){var r=this.fragPrevious,i=this.level,a=n.fragments,o=a.length;if(0===o)return!1;var s=a[0].start,u=a[o-1].start+a[o-1].duration,l=t.end,c=void 0;if(n.live){var d=this.config.initialLiveManifestSize;if(o<d)return A.logger.warn("Can not start playback of a level, reason: not enough fragments "+o+" < "+d),!1;if(c=this._ensureFragmentAtLivePoint(n,l,s,u,r,a,o),null===c)return!1}else l<s&&(c=a[0]);return c||(c=this._findFragment(s,r,o,a,l,u,n)),!c||this._loadFragmentOrKey(c,i,n,e,l)}},{key:"_ensureFragmentAtLivePoint",value:function(e,t,n,r,i,a,o){var s=this.hls.config,u=this.media,l=void 0,c=void 0!==s.liveMaxLatencyDuration?s.liveMaxLatencyDuration:s.liveMaxLatencyDurationCount*e.targetduration;if(t<Math.max(n-s.maxFragLookUpTolerance,r-c)){var d=this.liveSyncPosition=this.computeLivePosition(n,e);A.logger.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+d.toFixed(3)),t=d,u&&u.readyState&&u.duration>d&&(u.currentTime=d)}if(e.PTSKnown&&t>r&&u&&u.readyState)return null;if(this.startFragRequested&&!e.PTSKnown){if(i){var f=i.sn+1;f>=e.startSN&&f<=e.endSN&&(l=a[f-e.startSN],A.logger.log("live playlist, switching playlist, load frag with next SN: "+l.sn))}l||(l=a[Math.min(o-1,Math.round(o/2))],A.logger.log("live playlist, switching playlist, unknown, load middle frag : "+l.sn))}return l}},{key:"_findFragment",value:function(e,t,n,r,i,a,o){var s=this.hls.config,u=void 0,c=void 0,d=s.maxFragLookUpTolerance;if(i<a?(i>a-d&&(d=0),c=l.default.search(r,function(e){return e.start+e.duration-d<=i?1:e.start-d>i&&e.start?-1:0})):c=r[n-1],c&&(u=c,e=c.start,t&&u.level===t.level&&u.sn===t.sn))if(u.sn<o.endSN){var f=t.deltaPTS,h=u.sn-o.startSN;f&&f>s.maxBufferHole&&t.dropped&&h?(u=r[h-1],A.logger.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this"),t.loadCounter--):(u=r[h+1],A.logger.log("SN just loaded, load next one: "+u.sn))}else u=null;return u}},{key:"_loadFragmentOrKey",value:function(e,t,n,r,i){var a=this.hls,o=a.config;if(null==e.decryptdata.uri||null!=e.decryptdata.key){if(A.logger.log("Loading "+e.sn+" of ["+n.startSN+" ,"+n.endSN+"],level "+t+", currentTime:"+r.toFixed(3)+",bufferEnd:"+i.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,e.loadCounter){e.loadCounter++;var s=o.fragLoadingLoopThreshold;if(e.loadCounter>s&&Math.abs(this.fragLoadIdx-e.loadIdx)<s)return a.trigger(p.default.ERROR,{type:T.ErrorTypes.MEDIA_ERROR,details:T.ErrorDetails.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:e}),!1}else e.loadCounter=1;return e.loadIdx=this.fragLoadIdx,this.fragCurrent=e,this.startFragRequested=!0,this.nextLoadPosition=e.start+e.duration,e.autoLevel=a.autoLevelEnabled,e.bitrateTest=this.bitrateTest,a.trigger(p.default.FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new h.default(a,"main")),this.state=R.FRAG_LOADING,!0}A.logger.log("Loading key for "+e.sn+" of ["+n.startSN+" ,"+n.endSN+"],level "+t),this.state=R.KEY_LOADING,a.trigger(p.default.KEY_LOADING,{frag:e})}},{key:"getBufferRange",value:function(e){return l.default.search(this.bufferRange,function(t){return e<t.start?-1:e>t.end?1:0})}},{key:"followingBufferRange",value:function(e){return e?this.getBufferRange(e.end+.5):null}},{key:"_checkFragmentChanged",value:function(){var e,t,n=this.media;if(n&&n.readyState&&n.seeking===!1&&(t=n.currentTime,t>n.playbackRate*this.lastCurrentTime&&(this.lastCurrentTime=t),d.default.isBuffered(n,t)?e=this.getBufferRange(t):d.default.isBuffered(n,t+.1)&&(e=this.getBufferRange(t+.1)),e)){var r=e.frag;r!==this.fragPlaying&&(this.fragPlaying=r,this.hls.trigger(p.default.FRAG_CHANGED,{frag:r}))}}},{key:"immediateLevelSwitch",value:function(){if(A.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e=this.media,t=void 0;e?(t=e.paused,e.pause()):t=!0,this.previouslyPaused=t}var n=this.fragCurrent;n&&n.loader&&n.loader.abort(),this.fragCurrent=null,this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}},{key:"immediateLevelSwitchEnd",value:function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,d.default.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())}},{key:"nextLevelSwitch",value:function(){var e=this.media;if(e&&e.readyState){var t=void 0,n=void 0,r=void 0;if(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,n=this.getBufferRange(e.currentTime),n&&n.start>1&&this.flushMainBuffer(0,n.start-1),e.paused)t=0;else{var i=this.hls.nextLoadLevel,a=this.levels[i],o=this.fragLastKbps;t=o&&this.fragCurrent?this.fragCurrent.duration*a.bitrate/(1e3*o)+1:0}if(r=this.getBufferRange(e.currentTime+t),r&&(r=this.followingBufferRange(r))){var s=this.fragCurrent;s&&s.loader&&s.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(r.start,Number.POSITIVE_INFINITY)}}}},{key:"flushMainBuffer",value:function(e,t){this.state=R.BUFFER_FLUSHING;var n={startOffset:e,endOffset:t};this.altAudio&&(n.type="video"),this.hls.trigger(p.default.BUFFER_FLUSHING,n)}},{key:"onMediaAttached",value:function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var n=this.config;this.levels&&n.autoStartLoad&&this.hls.startLoad(n.startPosition)}},{key:"onMediaDetaching",value:function(){var e=this.media;e&&e.ended&&(A.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.loadCounter=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()}},{key:"onMediaSeeking",value:function(){var e=this.media,t=e?e.currentTime:void 0,n=this.config;if(A.logger.log("media seeking to "+t.toFixed(3)),this.state===R.FRAG_LOADING){var r=this.mediaBuffer?this.mediaBuffer:e,i=d.default.bufferInfo(r,t,this.config.maxBufferHole),a=this.fragCurrent;if(0===i.len&&a){var o=n.maxFragLookUpTolerance,s=a.start-o,u=a.start+a.duration+o;t<s||t>u?(a.loader&&(A.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),a.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=R.IDLE):A.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else this.state===R.ENDED&&(this.state=R.IDLE);e&&(this.lastCurrentTime=t),this.state!==R.FRAG_LOADING&&void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*n.fragLoadingLoopThreshold),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=t),this.tick()}},{key:"onMediaSeeked",value:function(){A.logger.log("media seeked to "+this.media.currentTime.toFixed(3)),this.tick()}},{key:"onMediaEnded",value:function(){A.logger.log("media ended"),this.startPosition=this.lastCurrentTime=0}},{key:"onManifestLoading",value:function(){A.logger.log("trigger BUFFER_RESET"),this.hls.trigger(p.default.BUFFER_RESET),this.bufferRange=[],this.stalled=!1,this.startPosition=this.lastCurrentTime=0}},{key:"onManifestParsed",value:function(e){var t,n=!1,r=!1;e.levels.forEach(function(e){
            t=e.audioCodec,t&&(t.indexOf("mp4a.40.2")!==-1&&(n=!0),t.indexOf("mp4a.40.5")!==-1&&(r=!0))}),this.audioCodecSwitch=n&&r,this.audioCodecSwitch&&A.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startLevelLoaded=!1,this.startFragRequested=!1;var i=this.config;i.autoStartLoad&&this.hls.startLoad(i.startPosition)}},{key:"onLevelLoaded",value:function(e){var t=e.details,n=e.level,r=this.levels[n],i=t.totalduration,a=0;if(A.logger.log("level "+n+" loaded ["+t.startSN+","+t.endSN+"],duration:"+i),this.levelLastLoaded=n,t.live){var o=r.details;o&&t.fragments.length>0?(m.default.mergeDetails(o,t),a=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(a,o),t.PTSKnown?A.logger.log("live playlist sliding:"+a.toFixed(3)):A.logger.log("live playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,A.logger.log("live playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(r.details=t,this.hls.trigger(p.default.LEVEL_UPDATED,{details:t,level:n}),this.startFragRequested===!1){if(this.startPosition===-1||this.lastCurrentTime===-1){var s=t.startTimeOffset;isNaN(s)?t.live?(this.startPosition=this.computeLivePosition(a,t),A.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0:(s<0&&(A.logger.log("negative start time offset "+s+", count from end of last fragment"),s=a+i+s),A.logger.log("start time offset found in playlist, adjust startPosition to "+s),this.startPosition=s),this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===R.WAITING_LEVEL&&(this.state=R.IDLE),this.tick()}},{key:"onKeyLoaded",value:function(){this.state===R.KEY_LOADING&&(this.state=R.IDLE,this.tick())}},{key:"onFragLoaded",value:function(e){var t=this.fragCurrent,n=e.frag;if(this.state===R.FRAG_LOADING&&t&&"main"===n.type&&n.level===t.level&&n.sn===t.sn){var r=e.stats,i=this.levels[t.level],a=i.details;if(A.logger.log("Loaded  "+t.sn+" of ["+a.startSN+" ,"+a.endSN+"],level "+t.level),this.bitrateTest=!1,n.bitrateTest===!0&&this.hls.nextLoadLevel)this.state=R.IDLE,this.startFragRequested=!1,r.tparsed=r.tbuffered=performance.now(),this.hls.trigger(p.default.FRAG_BUFFERED,{stats:r,frag:t,id:"main"}),this.tick();else{this.state=R.PARSING,this.stats=r;var o=a.totalduration,s=isNaN(t.startDTS)?t.start:t.startDTS,u=t.level,l=t.sn,c=this.config.defaultAudioCodec||i.audioCodec;this.audioCodecSwap&&(A.logger.log("swapping playlist audio codec"),void 0===c&&(c=this.lastAudioCodec),c&&(c=c.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5")),this.pendingBuffering=!0,this.appended=!1,A.logger.log("Parsing "+l+" of ["+a.startSN+" ,"+a.endSN+"],level "+u+", cc "+t.cc);var d=this.demuxer;d||(d=this.demuxer=new h.default(this.hls,"main"));var f=this.media,_=f&&f.seeking,v=!_&&(a.PTSKnown||!a.live);d.push(e.payload,c,i.videoCodec,s,t.cc,u,l,o,t.decryptdata,v,null)}}this.fragLoadError=0}},{key:"onFragParsingInitSegment",value:function(e){var t=this.fragCurrent;if(t&&"main"===e.id&&e.sn===t.sn&&e.level===t.level&&this.state===R.PARSING){var n,r,i=e.tracks;if(i.audio&&this.altAudio&&delete i.audio,r=i.audio){var a=this.levels[this.level].audioCodec,o=navigator.userAgent.toLowerCase();a&&this.audioCodecSwap&&(A.logger.log("swapping playlist audio codec"),a=a.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==r.metadata.channelCount&&o.indexOf("firefox")===-1&&(a="mp4a.40.5"),o.indexOf("android")!==-1&&"audio/mpeg"!==r.container&&(a="mp4a.40.2",A.logger.log("Android: force audio codec to "+a)),r.levelCodec=a,r.id=e.id}if(r=i.video,r&&(r.levelCodec=this.levels[this.level].videoCodec,r.id=e.id),e.unique){var s={codec:"",levelCodec:""};for(n in e.tracks)r=i[n],s.container=r.container,s.codec&&(s.codec+=",",s.levelCodec+=","),r.codec&&(s.codec+=r.codec),r.levelCodec&&(s.levelCodec+=r.levelCodec);i={audiovideo:s}}this.hls.trigger(p.default.BUFFER_CODECS,i);for(n in i){r=i[n],A.logger.log("main track:"+n+",container:"+r.container+",codecs[level/parsed]=["+r.levelCodec+"/"+r.codec+"]");var u=r.initSegment;u&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(p.default.BUFFER_APPENDING,{type:n,data:u,parent:"main",content:"initSegment"}))}this.tick()}}},{key:"onFragParsingData",value:function(e){var t=this,n=this.fragCurrent;if(n&&"main"===e.id&&e.sn===n.sn&&e.level===n.level&&("audio"!==e.type||!this.altAudio)&&this.state===R.PARSING){var r=this.levels[this.level],i=this.fragCurrent;A.logger.log("Parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb+",dropped:"+(e.dropped||0));var a=m.default.updateFragPTSDTS(r.details,i.sn,e.startPTS,e.endPTS,e.startDTS,e.endDTS),o=this.hls;o.trigger(p.default.LEVEL_PTS_UPDATED,{details:r.details,level:this.level,drift:a,type:e.type,start:e.startPTS,end:e.endPTS}),"video"===e.type&&(i.dropped=e.dropped),[e.data1,e.data2].forEach(function(n){n&&(t.appended=!0,t.pendingBuffering=!0,o.trigger(p.default.BUFFER_APPENDING,{type:e.type,data:n,parent:"main",content:"data"}))}),this.tick()}}},{key:"onFragParsed",value:function(e){var t=this.fragCurrent;t&&"main"===e.id&&e.sn===t.sn&&e.level===t.level&&this.state===R.PARSING&&(this.stats.tparsed=performance.now(),this.state=R.PARSED,this._checkAppendedParsed())}},{key:"onAudioTrackSwitching",value:function(e){var t=!!e.url,n=e.id;if(!t){if(this.mediaBuffer!==this.media){A.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var r=this.fragCurrent;r.loader&&(A.logger.log("switching to main audio track, cancel main fragment load"),r.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=R.IDLE}var i=this.hls;i.trigger(p.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),i.trigger(p.default.AUDIO_TRACK_SWITCHED,{id:n}),this.altAudio=!1}}},{key:"onAudioTrackSwitched",value:function(e){var t=e.id,n=!!this.hls.audioTracks[t].url;if(n){var r=this.videoBuffer;r&&this.mediaBuffer!==r&&(A.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=r)}this.altAudio=n,this.tick()}},{key:"onBufferCreated",value:function(e){var t=e.tracks,n=void 0,r=void 0,i=!1;for(var a in t){var o=t[a];"main"===o.id?(r=a,n=o,"video"===a&&(this.videoBuffer=t[a].buffer)):i=!0}i&&n?(A.logger.log("alternate track found, use "+r+".buffered to schedule main fragment loading"),this.mediaBuffer=n.buffer):this.mediaBuffer=this.media}},{key:"onBufferAppended",value:function(e){if("main"===e.parent){var t=this.state;t!==R.PARSING&&t!==R.PARSED||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}}},{key:"_checkAppendedParsed",value:function(){var e=this;if(!(this.state!==R.PARSED||this.appended&&this.pendingBuffering)){var t=this.fragCurrent;t&&!function(){var n=e.mediaBuffer?e.mediaBuffer:e.media;A.logger.log("main buffered : "+S.default.toString(n.buffered));var r=e.bufferRange.filter(function(e){return d.default.isBuffered(n,(e.start+e.end)/2)});r.push({type:t.type,start:t.startPTS,end:t.endPTS,frag:t}),e.bufferRange=r.sort(function(e,t){return e.start-t.start}),e.fragPrevious=t;var i=e.stats;i.tbuffered=performance.now(),e.fragLastKbps=Math.round(8*i.total/(i.tbuffered-i.tfirst)),e.hls.trigger(p.default.FRAG_BUFFERED,{stats:i,frag:t,id:"main"}),e.state=R.IDLE}(),this.tick()}}},{key:"onError",value:function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var n=this.media,r=n&&d.default.isBuffered(n,n.currentTime)&&d.default.isBuffered(n,n.currentTime+.5);switch(e.details){case T.ErrorDetails.FRAG_LOAD_ERROR:case T.ErrorDetails.FRAG_LOAD_TIMEOUT:case T.ErrorDetails.KEY_LOAD_ERROR:case T.ErrorDetails.KEY_LOAD_TIMEOUT:if(!e.fatal){var i=this.fragLoadError;i?i++:i=1;var a=this.config;if(i<=a.fragLoadingMaxRetry||r||t.autoLevel&&t.level){this.fragLoadError=i,t.loadCounter=0;var o=Math.min(Math.pow(2,i-1)*a.fragLoadingRetryDelay,a.fragLoadingMaxRetryTimeout);A.logger.warn("mediaController: frag loading failed, retry in "+o+" ms"),this.retryDate=performance.now()+o,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.state=R.FRAG_LOADING_WAITING_RETRY}else A.logger.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.hls.trigger(p.default.ERROR,e),this.state=R.ERROR}break;case T.ErrorDetails.FRAG_LOOP_LOADING_ERROR:e.fatal||(r?(this._reduceMaxBufferLength(t.duration),this.state=R.IDLE):t.autoLevel&&0!==t.level||(e.fatal=!0,this.hls.trigger(p.default.ERROR,e),this.state=R.ERROR));break;case T.ErrorDetails.LEVEL_LOAD_ERROR:case T.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==R.ERROR&&(e.fatal?(this.state=R.ERROR,A.logger.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):this.state===R.WAITING_LEVEL&&(this.state=R.IDLE));break;case T.ErrorDetails.BUFFER_FULL_ERROR:this.state!==R.PARSING&&this.state!==R.PARSED||(r?(this._reduceMaxBufferLength(t.duration),this.state=R.IDLE):(A.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}}},{key:"_reduceMaxBufferLength",value:function(e){var t=this.config;t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,A.logger.warn("reduce max buffer length to "+t.maxMaxBufferLength+"s and switch to IDLE state"),this.fragLoadIdx+=2*t.fragLoadingLoopThreshold)}},{key:"_checkBuffer",value:function(){var e=this.media;if(e&&e.readyState){var t=e.currentTime,n=this.mediaBuffer?this.mediaBuffer:e,r=n.buffered;if(this.loadedmetadata||!r.length||e.seeking)if(this.immediateSwitch)this.immediateLevelSwitchEnd();else{var i=d.default.bufferInfo(e,t,0),a=!(e.paused||e.ended||0===e.buffered.length),o=.5,s=t!==this.lastCurrentTime,u=this.config;if(s)this.stallReported&&(A.logger.warn("playback not stuck anymore @"+t+", after "+Math.round(performance.now()-this.stalled)+"ms"),this.stallReported=!1),this.stalled=void 0,this.nudgeRetry=0;else if(a){var l=performance.now(),c=this.hls;if(this.stalled){var f=l-this.stalled,h=i.len,_=this.nudgeRetry||0;if(h<=o&&f>1e3*u.lowBufferWatchdogPeriod){this.stallReported||(this.stallReported=!0,A.logger.warn("playback stalling in low buffer @"+t),c.trigger(p.default.ERROR,{type:T.ErrorTypes.MEDIA_ERROR,details:T.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:h}));var v=i.nextStart,E=v-t;if(v&&E<u.maxSeekHole&&E>0){this.nudgeRetry=++_;var g=_*u.nudgeOffset;A.logger.log("adjust currentTime from "+e.currentTime+" to next buffered @ "+v+" + nudge "+g),e.currentTime=v+g,this.stalled=void 0,c.trigger(p.default.ERROR,{type:T.ErrorTypes.MEDIA_ERROR,details:T.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,hole:v+g-t})}}else if(h>o&&f>1e3*u.highBufferWatchdogPeriod)if(this.stallReported||(this.stallReported=!0,A.logger.warn("playback stalling in high buffer @"+t),c.trigger(p.default.ERROR,{type:T.ErrorTypes.MEDIA_ERROR,details:T.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:h})),this.stalled=void 0,this.nudgeRetry=++_,_<u.nudgeMaxRetry){var m=e.currentTime,y=m+_*u.nudgeOffset;A.logger.log("adjust currentTime from "+m+" to "+y),e.currentTime=y,c.trigger(p.default.ERROR,{type:T.ErrorTypes.MEDIA_ERROR,details:T.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else A.logger.error("still stuck in high buffer @"+t+" after "+u.nudgeMaxRetry+", raise fatal error"),c.trigger(p.default.ERROR,{type:T.ErrorTypes.MEDIA_ERROR,details:T.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}else this.stalled=l,this.stallReported=!1}}else{this.loadedmetadata=!0;var S=this.startPosition,R=d.default.isBuffered(n,S);t===S&&R||(A.logger.log("target start position:"+S),R||(S=r.start(0),A.logger.log("target start position not buffered, seek to buffered.start(0) "+S)),A.logger.log("adjust currentTime from "+t+" to "+S),e.currentTime=S)}}}},{key:"onFragLoadEmergencyAborted",value:function(){this.state=R.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()}},{key:"onBufferFlushed",value:function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferRange=this.bufferRange.filter(function(t){return d.default.isBuffered(e,(t.start+t.end)/2)}),this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.state=R.IDLE,this.fragPrevious=null}},{key:"swapAudioCodec",value:function(){this.audioCodecSwap=!this.audioCodecSwap}},{key:"computeLivePosition",value:function(e,t){var n=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-n)}},{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,A.logger.log("main stream:"+t+"->"+e),this.hls.trigger(p.default.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getBufferRange(e.currentTime);if(t)return t.frag.level}return-1}},{key:"nextBufferRange",get:function(){var e=this.media;return e?this.followingBufferRange(this.getBufferRange(e.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferRange;return e?e.frag.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}]),t}(E.default);n.default=D},{22:22,26:26,27:27,28:28,30:30,31:31,41:41,45:45,46:46}],13:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e(28),l=r(u),c=e(27),d=r(c),f=e(42),h=r(f),_=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.MEDIA_ATTACHING,l.default.MEDIA_DETACHING,l.default.FRAG_PARSING_USERDATA,l.default.MANIFEST_LOADING,l.default.FRAG_LOADED,l.default.LEVEL_SWITCH));if(n.hls=e,n.config=e.config,n.enabled=!0,n.Cues=e.config.cueHandler,n.config.enableCEA708Captions){var r=n,o=function(e,t){var n=null;try{n=new window.Event("addtrack")}catch(e){n=document.createEvent("Event"),n.initEvent("addtrack",!1,!1)}n.track=e,t.dispatchEvent(n)},s={newCue:function(e,t,n){if(!r.textTrack1){var i=r.getExistingTrack("1");i?(r.textTrack1=i,r.clearCurrentCues(r.textTrack1),o(r.textTrack1,r.media)):(r.textTrack1=r.createTextTrack("captions","English","en"),r.textTrack1.textTrack1=!0)}r.Cues.newCue(r.textTrack1,e,t,n)}},u={newCue:function(e,t,n){if(!r.textTrack2){var i=r.getExistingTrack("2");i?(r.textTrack2=i,r.clearCurrentCues(r.textTrack2),o(r.textTrack2,r.media)):(r.textTrack2=r.createTextTrack("captions","Spanish","es"),r.textTrack2.textTrack2=!0)}r.Cues.newCue(r.textTrack2,e,t,n)}};n.cea608Parser=new h.default(0,s,u)}return n}return o(t,e),s(t,[{key:"clearCurrentCues",value:function(e){if(e&&e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}},{key:"getExistingTrack",value:function(e){var t=this.media;if(t)for(var n=0;n<t.textTracks.length;n++){var r=t.textTracks[n],i="textTrack"+e;if(r[i]===!0)return r}return null}},{key:"createTextTrack",value:function(e,t,n){if(this.media)return this.media.addTextTrack(e,t,n)}},{key:"destroy",value:function(){d.default.prototype.destroy.call(this)}},{key:"onMediaAttaching",value:function(e){this.media=e.media}},{key:"onMediaDetaching",value:function(){this.clearCurrentCues(this.textTrack1),this.clearCurrentCues(this.textTrack2)}},{key:"onManifestLoading",value:function(){this.lastPts=Number.NEGATIVE_INFINITY}},{key:"onLevelSwitch",value:function(){"NONE"===this.hls.currentLevel.closedCaptions?this.enabled=!1:this.enabled=!0}},{key:"onFragLoaded",value:function(e){if("main"===e.frag.type){var t=e.frag.start;t<=this.lastPts&&(this.clearCurrentCues(this.textTrack1),this.clearCurrentCues(this.textTrack2)),this.lastPts=t}}},{key:"onFragParsingUserdata",value:function(e){if(this.enabled&&this.config.enableCEA708Captions)for(var t=0;t<e.samples.length;t++){var n=this.extractCea608Data(e.samples[t].bytes);this.cea608Parser.addData(e.samples[t].pts,n)}}},{key:"extractCea608Data",value:function(e){for(var t,n,r,i,a,o=31&e[0],s=2,u=[],l=0;l<o;l++)t=e[s++],n=127&e[s++],r=127&e[s++],i=0!==(4&t),a=3&t,0===n&&0===r||i&&0===a&&(u.push(n),u.push(r));return u}}]),t}(d.default);n.default=_},{27:27,28:28,42:42}],14:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t,n){r(this,e),this.subtle=t,this.aesIV=n}return i(e,[{key:"decrypt",value:function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}]),e}();n.default=a},{}],15:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(){r(this,e),this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[],this.subMix[0]=new Uint32Array(256),this.subMix[1]=new Uint32Array(256),this.subMix[2]=new Uint32Array(256),this.subMix[3]=new Uint32Array(256),this.invSubMix=[],this.invSubMix[0]=new Uint32Array(256),this.invSubMix[1]=new Uint32Array(256),this.invSubMix[2]=new Uint32Array(256),this.invSubMix[3]=new Uint32Array(256),this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}return i(e,[{key:"uint8ArrayToUint32Array_",value:function(e){for(var t=new DataView(e),n=new Uint32Array(4),r=0;r<n.length;r++)n[r]=t.getUint32(4*r);return n}},{key:"initTable",value:function(){var e=this.sBox,t=this.invSBox,n=this.subMix[0],r=this.subMix[1],i=this.subMix[2],a=this.subMix[3],o=this.invSubMix[0],s=this.invSubMix[1],u=this.invSubMix[2],l=this.invSubMix[3],c=new Uint32Array(256),d=0,f=0,h=0;for(h=0;h<256;h++)h<128?c[h]=h<<1:c[h]=h<<1^283;for(h=0;h<256;h++){var _=f^f<<1^f<<2^f<<3^f<<4;_=_>>>8^255&_^99,e[d]=_,t[_]=d;var p=c[d],v=c[p],E=c[v],g=257*c[_]^16843008*_;n[d]=g<<24|g>>>8,r[d]=g<<16|g>>>16,i[d]=g<<8|g>>>24,a[d]=g,g=16843009*E^65537*v^257*p^16843008*d,o[_]=g<<24|g>>>8,s[_]=g<<16|g>>>16,u[_]=g<<8|g>>>24,l[_]=g,d?(d=p^c[c[c[E^p]]],f^=c[c[f]]):d=f=1}}},{key:"expandKey",value:function(e){for(var t=this.uint8ArrayToUint32Array_(e),n=!0,r=0;r<t.length&&n;)n=t[r]===this.key[r],r++;if(!n){this.key=t;var i=this.keySize=t.length;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size="+i);var a=this.ksRows=4*(i+6+1),o=void 0,s=void 0,u=this.keySchedule=new Uint32Array(this.ksRows),l=this.invKeySchedule=new Uint32Array(this.ksRows),c=this.sBox,d=this.rcon,f=this.invSubMix[0],h=this.invSubMix[1],_=this.invSubMix[2],p=this.invSubMix[3],v=void 0,E=void 0;for(o=0;o<a;o++)o<i?v=u[o]=t[o]:(E=v,o%i===0?(E=E<<8|E>>>24,E=c[E>>>24]<<24|c[E>>>16&255]<<16|c[E>>>8&255]<<8|c[255&E],E^=d[o/i|0]<<24):i>6&&o%i===4&&(E=c[E>>>24]<<24|c[E>>>16&255]<<16|c[E>>>8&255]<<8|c[255&E]),u[o]=v=(u[o-i]^E)>>>0);for(s=0;s<a;s++)o=a-s,E=3&s?u[o]:u[o-4],s<4||o<=4?l[s]=E:l[s]=f[c[E>>>24]]^h[c[E>>>16&255]]^_[c[E>>>8&255]]^p[c[255&E]],l[s]=l[s]>>>0}}},{key:"networkToHostOrderSwap",value:function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}},{key:"decrypt",value:function(e,t,n){for(var r,i,a=this.keySize+6,o=this.invKeySchedule,s=this.invSBox,u=this.invSubMix[0],l=this.invSubMix[1],c=this.invSubMix[2],d=this.invSubMix[3],f=this.uint8ArrayToUint32Array_(n),h=f[0],_=f[1],p=f[2],v=f[3],E=new Int32Array(e),g=new Int32Array(E.length),m=void 0,y=void 0,S=void 0,T=void 0,A=void 0,R=void 0,D=void 0,C=void 0,w=void 0,b=void 0,O=void 0,P=void 0;t<E.length;){for(w=this.networkToHostOrderSwap(E[t]),b=this.networkToHostOrderSwap(E[t+1]),O=this.networkToHostOrderSwap(E[t+2]),P=this.networkToHostOrderSwap(E[t+3]),A=w^o[0],R=P^o[1],D=O^o[2],C=b^o[3],r=4,i=1;i<a;i++)m=u[A>>>24]^l[R>>16&255]^c[D>>8&255]^d[255&C]^o[r],y=u[R>>>24]^l[D>>16&255]^c[C>>8&255]^d[255&A]^o[r+1],S=u[D>>>24]^l[C>>16&255]^c[A>>8&255]^d[255&R]^o[r+2],T=u[C>>>24]^l[A>>16&255]^c[R>>8&255]^d[255&D]^o[r+3],A=m,R=y,D=S,C=T,r+=4;m=s[A>>>24]<<24^s[R>>16&255]<<16^s[D>>8&255]<<8^s[255&C]^o[r],y=s[R>>>24]<<24^s[D>>16&255]<<16^s[C>>8&255]<<8^s[255&A]^o[r+1],S=s[D>>>24]<<24^s[C>>16&255]<<16^s[A>>8&255]<<8^s[255&R]^o[r+2],T=s[C>>>24]<<24^s[A>>16&255]<<16^s[R>>8&255]<<8^s[255&D]^o[r+3],r+=3,g[t]=this.networkToHostOrderSwap(m^h),g[t+1]=this.networkToHostOrderSwap(T^_),g[t+2]=this.networkToHostOrderSwap(S^p),g[t+3]=this.networkToHostOrderSwap(y^v),h=w,_=b,p=O,v=P,t+=4}return g.buffer}},{key:"destroy",value:function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0}}]),e}();n.default=a},{}],16:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e(14),s=r(o),u=e(17),l=r(u),c=e(15),d=r(c),f=e(26),h=e(45),_=function(){function e(t,n){i(this,e),this.observer=t,this.config=n;try{var r=crypto?crypto:self.crypto;this.subtle=r.subtle||r.webkitSubtle}catch(e){}this.disableWebCrypto=!this.subtle}return a(e,[{key:"decrypt",value:function(e,t,n,r){var i=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){h.logger.log("JS AES decrypt");var a=this.decryptor;a||(this.decryptor=a=new d.default),a.expandKey(t),r(a.decrypt(e,0,n))}else!function(){h.logger.log("WebCrypto AES decrypt");var a=i.subtle;i.key!==t&&(i.key=t,i.fastAesKey=new l.default(a,t)),i.fastAesKey.expandKey().then(function(t){var i=new s.default(a,n);i.decrypt(e,t).then(function(e){r(e)})}).catch(function(a){i.onWebCryptoError(a,e,t,n,r)})}()}},{key:"onWebCryptoError",value:function(e,t,n,r,i){this.config.enableSoftwareAES?(h.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.decrypt(t,n,r,i)):(h.logger.error("decrypting error : "+e.message),this.observer.trigger(Event.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))}},{key:"destroy",value:function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)}}]),e}();n.default=_},{14:14,15:15,17:17,26:26,45:45}],17:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t,n){r(this,e),this.subtle=t,this.key=n}return i(e,[{key:"expandKey",value:function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}]),e}();n.default=a},{}],18:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e(19),s=r(o),u=e(45),l=e(24),c=r(l),d=function(){function e(t,n,r,a,o){i(this,e),this.observer=t,this.id=n,this.remuxerClass=r,this.config=a,this.remuxer=new this.remuxerClass(t,n,a,o),this.insertDiscontinuity()}return a(e,[{key:"insertDiscontinuity",value:function(){this._aacTrack={container:"audio/adts",type:"audio",id:-1,sequenceNumber:0,isAAC:!0,samples:[],len:0}}},{key:"push",value:function(e,t,n,r,i,a,o,l,d,f){var h,_,p,v,E,g,m,y,S,T,A=new c.default(e),R=90*A.timeStamp,D=!1;for(i!==this.lastCC?(u.logger.log(this.id+" discontinuity detected"),this.lastCC=i,this.insertDiscontinuity(),this.remuxer.switchLevel(),this.remuxer.insertDiscontinuity()):a!==this.lastLevel?(u.logger.log("audio track switch detected"),this.lastLevel=a,this.remuxer.switchLevel(),this.insertDiscontinuity()):o===this.lastSN+1&&(D=!0),h=this._aacTrack,this.lastSN=o,this.lastLevel=a,g=A.length,S=e.length;g<S-1&&(255!==e[g]||240!==(240&e[g+1]));g++);for(h.audiosamplerate||(_=s.default.getAudioConfig(this.observer,e,g,t),h.config=_.config,h.audiosamplerate=_.samplerate,h.channelCount=_.channelCount,h.codec=_.codec,h.manifestCodec=_.manifestCodec,h.duration=l,u.logger.log("parsed codec:"+h.codec+",rate:"+_.samplerate+",nb channel:"+_.channelCount)),E=0,v=9216e4/h.audiosamplerate;g+5<S&&(m=1&e[g+1]?7:9,p=(3&e[g+3])<<11|e[g+4]<<3|(224&e[g+5])>>>5,p-=m,p>0&&g+m+p<=S);)for(y=R+E*v,T={unit:e.subarray(g+m,g+m+p),pts:y,dts:y},h.samples.push(T),h.len+=p,g+=p+m,E++;g<S-1&&(255!==e[g]||240!==(240&e[g+1]));g++);this.remuxer.remux(a,o,i,h,{samples:[]},{samples:[{pts:R,dts:R,unit:A.payload}]},{samples:[]},r,D,d,f)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(e){var t,n,r=new c.default(e);if(r.hasTimeStamp)for(t=r.length,n=e.length;t<n-1;t++)if(255===e[t]&&240===(240&e[t+1]))return!0;return!1}}]),e}();n.default=d},{19:19,24:24,45:45}],19:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=e(45),o=e(26),s=function(){function e(){r(this,e)}return i(e,null,[{key:"getAudioConfig",value:function(e,t,n,r){var i,s,u,l,c,d=navigator.userAgent.toLowerCase(),f=r,h=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];return i=((192&t[n+2])>>>6)+1,s=(60&t[n+2])>>>2,s>h.length-1?void e.trigger(Event.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+s}):(l=(1&t[n+2])<<2,l|=(192&t[n+3])>>>6,a.logger.log("manifest codec:"+r+",ADTS data:type:"+i+",sampleingIndex:"+s+"["+h[s]+"Hz],channelConfig:"+l),/firefox/i.test(d)?s>=6?(i=5,c=new Array(4),u=s-3):(i=2,c=new Array(2),u=s):d.indexOf("android")!==-1?(i=2,c=new Array(2),u=s):(i=5,c=new Array(4),r&&(r.indexOf("mp4a.40.29")!==-1||r.indexOf("mp4a.40.5")!==-1)||!r&&s>=6?u=s-3:((r&&r.indexOf("mp4a.40.2")!==-1&&s>=6&&1===l||!r&&1===l)&&(i=2,c=new Array(2)),u=s)),c[0]=i<<3,c[0]|=(14&s)>>1,c[1]|=(1&s)<<7,c[1]|=l<<3,5===i&&(c[1]|=(14&u)>>1,c[2]=(1&u)<<7,c[2]|=8,c[3]=0),{config:c,samplerate:h[s],channelCount:l,codec:"mp4a.40."+i,manifestCodec:f})}}]),e}();n.default=s},{26:26,45:45}],20:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e(28),s=r(o),u=e(26),l=e(16),c=r(l),d=e(18),f=r(d),h=e(25),_=r(h),p=e(38),v=r(p),E=e(39),g=r(E),m=function(){function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;i(this,e),this.hls=t,this.id=n,this.config=this.hls.config||a,this.typeSupported=r}return a(e,[{key:"destroy",value:function(){var e=this.demuxer;e&&e.destroy()}},{key:"push",value:function(e,t,n,r,i,a,o,u,l,d,f){if(e.byteLength>0&&null!=l&&null!=l.key&&"AES-128"===l.method){null==this.decrypter&&(this.decrypter=new c.default(this.hls,this.config));var h,_=this;try{h=performance.now()}catch(e){h=Date.now()}this.decrypter.decrypt(e,l.key.buffer,l.iv.buffer,function(e){var l;try{l=performance.now()}catch(e){l=Date.now()}_.hls.trigger(s.default.FRAG_DECRYPTED,{level:a,sn:o,stats:{tstart:h,tdecrypt:l}}),_.pushDecrypted(new Uint8Array(e),t,n,r,i,a,o,u,d,f)})}else this.pushDecrypted(new Uint8Array(e),t,n,r,i,a,o,u,d,f)}},{key:"pushDecrypted",value:function(e,t,n,r,i,a,o,l,c,d){var h=this.demuxer;if(!h||i!==this.cc&&!h.probe(e)){var p=this.hls,E=this.id,m=this.config,y=this.typeSupported;if(_.default.probe(e))h=this.typeSupported.mp2t===!0?new _.default(p,E,g.default,m,y):new _.default(p,E,v.default,m,y),h.probe=_.default.probe;else{if(!f.default.probe(e))return void p.trigger(s.default.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,id:E,details:u.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});h=new f.default(p,E,v.default,m,y),h.probe=f.default.probe}this.demuxer=h}h.push(e,t,n,r,i,a,o,l,c,d),this.cc=i}}]),e}();n.default=m},{16:16,18:18,25:25,26:26,28:28,38:38,39:39}],21:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i=e(20),a=r(i),o=e(28),s=r(o),u=e(45),l=e(1),c=r(l),d=function(e){var t=new c.default;t.trigger=function(e){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t.emit.apply(t,[e,e].concat(r))},t.off=function(e){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t.removeListener.apply(t,[e].concat(r))};var n=function(t,n){e.postMessage({event:t,data:n})};e.addEventListener("message",function(r){var i=r.data;switch(i.cmd){case"init":var o=JSON.parse(i.config);e.demuxer=new a.default(t,i.id,i.typeSupported,o);try{(0,u.enableLogs)(o.debug===!0)}catch(e){}n("init",null);break;case"demux":e.demuxer.push(i.data,i.audioCodec,i.videoCodec,i.timeOffset,i.cc,i.level,i.sn,i.duration,i.decryptdata,i.accurateTimeOffset,i.defaultInitPTS)}}),t.on(s.default.FRAG_DECRYPTED,n),t.on(s.default.FRAG_PARSING_INIT_SEGMENT,n),t.on(s.default.FRAG_PARSED,n),t.on(s.default.ERROR,n),t.on(s.default.FRAG_PARSING_METADATA,n),t.on(s.default.FRAG_PARSING_USERDATA,n),t.on(s.default.INIT_PTS_FOUND,n),t.on(s.default.FRAG_PARSING_DATA,function(t,n){var r=n.data1.buffer,i=n.data2.buffer;delete n.data1,delete n.data2,e.postMessage({event:t,data:n,data1:r,data2:i},[r,i])})};n.default=d},{1:1,20:20,28:28,45:45}],22:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");
        }Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e(28),s=r(o),u=e(20),l=r(u),c=e(21),d=r(c),f=e(45),h=e(26),_=function(){function t(n,r){i(this,t),this.hls=n,this.id=r;var a={mp4:MediaSource.isTypeSupported("video/mp4"),mp2t:n.config.enableMP2TPassThrough&&MediaSource.isTypeSupported("video/mp2t"),mpeg:MediaSource.isTypeSupported("audio/mpeg"),mp3:MediaSource.isTypeSupported('audio/mp4; codecs="mp3"')};if(n.config.enableWorker&&"undefined"!=typeof Worker){f.logger.log("demuxing in webworker");var o=void 0;try{var u=e(3);o=this.w=u(d.default),this.onwmsg=this.onWorkerMessage.bind(this),o.addEventListener("message",this.onwmsg),o.onerror=function(e){n.trigger(s.default.ERROR,{type:h.ErrorTypes.OTHER_ERROR,details:h.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:e.message+" ("+e.filename+":"+e.lineno+")"}})},o.postMessage({cmd:"init",typeSupported:a,id:r,config:JSON.stringify(n.config)})}catch(e){f.logger.error("error while initializing DemuxerWorker, fallback on DemuxerInline"),o&&URL.revokeObjectURL(o.objectURL),this.demuxer=new l.default(n,r,a),this.w=void 0}}else this.demuxer=new l.default(n,r,a);this.demuxInitialized=!0}return a(t,[{key:"destroy",value:function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}}},{key:"push",value:function(e,t,n,r,i,a,o,s,u,l,c){var d=this.w;if(d)d.postMessage({cmd:"demux",data:e,audioCodec:t,videoCodec:n,timeOffset:r,cc:i,level:a,sn:o,duration:s,decryptdata:u,accurateTimeOffset:l,defaultInitPTS:c},[e]);else{var f=this.demuxer;f&&f.push(e,t,n,r,i,a,o,s,u,l,c)}}},{key:"onWorkerMessage",value:function(e){var t=e.data,n=this.hls;switch(t.event){case"init":URL.revokeObjectURL(this.w.objectURL);break;case s.default.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data.data2=new Uint8Array(t.data2);default:n.trigger(t.event,t.data)}}}]),t}();n.default=_},{20:20,21:21,26:26,28:28,3:3,45:45}],23:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=e(45),o=function(){function e(t){r(this,e),this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}return i(e,[{key:"loadWord",value:function(){var e=this.data,t=this.bytesAvailable,n=e.byteLength-t,r=new Uint8Array(4),i=Math.min(4,t);if(0===i)throw new Error("no bytes available");r.set(e.subarray(n,n+i)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=8*i,this.bytesAvailable-=i}},{key:"skipBits",value:function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}},{key:"readBits",value:function(e){var t=Math.min(this.bitsAvailable,e),n=this.word>>>32-t;return e>32&&a.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}},{key:"skipLZ",value:function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!==(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"skipEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var e=this.skipLZ();return this.readBits(e+1)-1}},{key:"readEG",value:function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}},{key:"readBoolean",value:function(){return 1===this.readBits(1)}},{key:"readUByte",value:function(){return this.readBits(8)}},{key:"readUShort",value:function(){return this.readBits(16)}},{key:"readUInt",value:function(){return this.readBits(32)}},{key:"skipScalingList",value:function(e){var t,n,r=8,i=8;for(t=0;t<e;t++)0!==i&&(n=this.readEG(),i=(r+n+256)%256),r=0===i?r:i}},{key:"readSPS",value:function(){var e,t,n,r,i,a,o,s,u,l=0,c=0,d=0,f=0,h=this.readUByte.bind(this),_=this.readBits.bind(this),p=this.readUEG.bind(this),v=this.readBoolean.bind(this),E=this.skipBits.bind(this),g=this.skipEG.bind(this),m=this.skipUEG.bind(this),y=this.skipScalingList.bind(this);if(h(),e=h(),t=_(5),E(3),n=h(),m(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var S=p();if(3===S&&E(1),m(),m(),E(1),v())for(s=3!==S?8:12,u=0;u<s;u++)v()&&y(u<6?16:64)}m();var T=p();if(0===T)p();else if(1===T)for(E(1),g(),g(),r=p(),u=0;u<r;u++)g();m(),E(1),i=p(),a=p(),o=_(1),0===o&&E(1),E(1),v()&&(l=p(),c=p(),d=p(),f=p());var A=[1,1];if(v()&&v()){var R=h();switch(R){case 1:A=[1,1];break;case 2:A=[12,11];break;case 3:A=[10,11];break;case 4:A=[16,11];break;case 5:A=[40,33];break;case 6:A=[24,11];break;case 7:A=[20,11];break;case 8:A=[32,11];break;case 9:A=[80,33];break;case 10:A=[18,11];break;case 11:A=[15,11];break;case 12:A=[64,33];break;case 13:A=[160,99];break;case 14:A=[4,3];break;case 15:A=[3,2];break;case 16:A=[2,1];break;case 255:A=[h()<<8|h(),h()<<8|h()]}}return{width:Math.ceil(16*(i+1)-2*l-2*c),height:(2-o)*(a+1)*16-(o?2:4)*(d+f),pixelRatio:A}}},{key:"readSliceType",value:function(){return this.readUByte(),this.readUEG(),this.readUEG()}}]),e}();n.default=o},{45:45}],24:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=e(45),o=function(){function e(t){r(this,e),this._hasTimeStamp=!1;for(var n,i,o,s,u,l,c,d,f=0;;)if(c=this.readUTF(t,f,3),f+=3,"ID3"===c)f+=3,n=127&t[f++],i=127&t[f++],o=127&t[f++],s=127&t[f++],u=(n<<21)+(i<<14)+(o<<7)+s,l=f+u,this._parseID3Frames(t,f,l),f=l;else{if("3DI"!==c)return f-=3,d=f,void(d&&(this.hasTimeStamp||a.logger.warn("ID3 tag found, but no timestamp"),this._length=d,this._payload=t.subarray(0,d)));f+=7,a.logger.log("3DI footer found, end: "+f)}}return i(e,[{key:"readUTF",value:function(e,t,n){var r="",i=t,a=t+n;do r+=String.fromCharCode(e[i++]);while(i<a);return r}},{key:"_parseID3Frames",value:function(e,t,n){for(var r,i,o,s,u;t+8<=n;)switch(r=this.readUTF(e,t,4),t+=4,i=e[t++]<<24+e[t++]<<16+e[t++]<<8+e[t++],s=e[t++]<<8+e[t++],o=t,r){case"PRIV":if("com.apple.streaming.transportStreamTimestamp"===this.readUTF(e,t,44)){t+=44,t+=4;var l=1&e[t++];this._hasTimeStamp=!0,u=((e[t++]<<23)+(e[t++]<<15)+(e[t++]<<7)+e[t++])/45,l&&(u+=47721858.84),u=Math.round(u),a.logger.trace("ID3 timestamp found: "+u),this._timeStamp=u}}}},{key:"hasTimeStamp",get:function(){return this._hasTimeStamp}},{key:"timeStamp",get:function(){return this._timeStamp}},{key:"length",get:function(){return this._length}},{key:"payload",get:function(){return this._payload}}]),e}();n.default=o},{45:45}],25:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e(19),s=r(o),u=e(28),l=r(u),c=e(23),d=r(c),f=e(45),h=e(26),_=function(){function e(t,n,r,a,o){i(this,e),this.observer=t,this.id=n,this.remuxerClass=r,this.config=a,this.typeSupported=o,this.lastCC=0,this.remuxer=new this.remuxerClass(t,n,a,o)}return a(e,[{key:"switchLevel",value:function(){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack={container:"video/mp2t",type:"video",id:-1,sequenceNumber:0,samples:[],len:0,dropped:0},this._audioTrack={container:"video/mp2t",type:"audio",id:-1,sequenceNumber:0,samples:[],len:0,isAAC:!0},this._id3Track={type:"id3",id:-1,sequenceNumber:0,samples:[],len:0},this._txtTrack={type:"text",id:-1,sequenceNumber:0,samples:[],len:0},this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.remuxer.switchLevel()}},{key:"insertDiscontinuity",value:function(){this.switchLevel(),this.remuxer.insertDiscontinuity()}},{key:"push",value:function(e,t,n,r,i,a,o,s,u,c){var d,_,p,v,E,g,m=e.length,y=this.remuxer.passthrough,S=!1;this.audioCodec=t,this.videoCodec=n,this._duration=s,this.contiguous=!1,this.accurateTimeOffset=u,i!==this.lastCC&&(f.logger.log("discontinuity detected"),this.insertDiscontinuity(),this.lastCC=i),a!==this.lastLevel?(f.logger.log("level switch detected"),this.switchLevel(),this.lastLevel=a):o===this.lastSN+1&&(this.contiguous=!0),this.lastSN=o;var T=this.pmtParsed,A=this._avcTrack,R=this._audioTrack,D=this._id3Track,C=A.id,w=R.id,b=D.id,O=this._pmtId,P=A.pesData,L=R.pesData,I=D.pesData,k=this._parsePAT,N=this._parsePMT,M=this._parsePES,U=this._parseAVCPES.bind(this),x=this._parseAACPES.bind(this),F=this._parseMPEGPES.bind(this),B=this._parseID3PES.bind(this);for(m-=m%188,d=0;d<m;d+=188)if(71===e[d]){if(_=!!(64&e[d+1]),p=((31&e[d+1])<<8)+e[d+2],v=(48&e[d+3])>>4,v>1){if(E=d+5+e[d+4],E===d+188)continue}else E=d+4;switch(p){case C:if(_){if(P&&(g=M(P))&&(U(g,!1),y&&A.codec&&(w===-1||R.codec)))return void this.remux(a,o,i,e,r);P={data:[],size:0}}P&&(P.data.push(e.subarray(E,d+188)),P.size+=d+188-E);break;case w:if(_){if(L&&(g=M(L))&&(R.isAAC?x(g):F(g),y&&R.codec&&(C===-1||A.codec)))return void this.remux(a,o,i,e,r);L={data:[],size:0}}L&&(L.data.push(e.subarray(E,d+188)),L.size+=d+188-E);break;case b:_&&(I&&(g=M(I))&&B(g),I={data:[],size:0}),I&&(I.data.push(e.subarray(E,d+188)),I.size+=d+188-E);break;case 0:_&&(E+=e[E]+1),O=this._pmtId=k(e,E);break;case O:_&&(E+=e[E]+1);var G=N(e,E,this.typeSupported.mpeg===!0||this.typeSupported.mp3===!0);C=G.avc,C>0&&(A.id=C),w=G.audio,w>0&&(R.id=w,R.isAAC=G.isAAC),b=G.id3,b>0&&(D.id=b),S&&!T&&(f.logger.log("reparse from beginning"),S=!1,d=-188),T=this.pmtParsed=!0;break;case 17:case 8191:break;default:S=!0}}else this.observer.trigger(l.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,id:this.id,details:h.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});P&&(g=M(P))?(U(g,!0),A.pesData=null):A.pesData=P,L&&(g=M(L))?(R.isAAC?x(g):F(g),R.pesData=null):(L&&L.size&&f.logger.log("last AAC PES packet truncated,might overlap between fragments"),R.pesData=L),I&&(g=M(I))?(B(g),D.pesData=null):D.pesData=I,this.remux(a,o,i,null,r,c)}},{key:"remux",value:function(e,t,n,r,i,a){for(var o=this._avcTrack,s=o.samples,u=0,l=0,c=0;c<s.length;c++){for(var d=s[c],f=d.units.units,h=f.length,_=0,p=0;p<h;p++)_+=f[p].data.length;l+=_,u+=h,d.length=_}o.len=l,o.nbNalu=u,this.remuxer.remux(e,t,n,this._audioTrack,this._avcTrack,this._id3Track,this._txtTrack,i,this.contiguous,this.accurateTimeOffset,a,r)}},{key:"destroy",value:function(){this.switchLevel(),this._initPTS=this._initDTS=void 0,this._duration=0}},{key:"_parsePAT",value:function(e,t){return(31&e[t+10])<<8|e[t+11]}},{key:"_parsePMT",value:function(e,t,n){var r,i,a,o,s={audio:-1,avc:-1,id3:-1,isAAC:!0};for(r=(15&e[t+1])<<8|e[t+2],i=t+3+r-4,a=(15&e[t+10])<<8|e[t+11],t+=12+a;t<i;){switch(o=(31&e[t+1])<<8|e[t+2],e[t]){case 15:s.audio===-1&&(s.audio=o);break;case 21:s.id3===-1&&(s.id3=o);break;case 27:s.avc===-1&&(s.avc=o);break;case 3:case 4:n?s.audio===-1&&(s.audio=o,s.isAAC=!1):f.logger.log("MPEG audio found, not supported in this browser for now");break;case 36:f.logger.warn("HEVC stream type found, not supported for now");break;default:f.logger.log("unkown stream type:"+e[t])}t+=((15&e[t+3])<<8|e[t+4])+5}return s}},{key:"_parsePES",value:function(e){var t,n,r,i,a,o,s,u,l,c=0,d=e.data;if(!e||0===e.size)return null;for(;d[0].length<19&&d.length>1;){var h=new Uint8Array(d[0].length+d[1].length);h.set(d[0]),h.set(d[1],d[0].length),d[0]=h,d.splice(1,1)}if(t=d[0],r=(t[0]<<16)+(t[1]<<8)+t[2],1===r){if(i=(t[4]<<8)+t[5],i&&i>e.size-6)return null;n=t[7],192&n&&(s=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,s>4294967295&&(s-=8589934592),64&n?(u=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2,u>4294967295&&(u-=8589934592),s-u>54e5&&(f.logger.warn(Math.round((s-u)/9e4)+"s delta between PTS and DTS, align them"),s=u)):u=s),a=t[8],l=a+9,e.size-=l,o=new Uint8Array(e.size);for(var _=0,p=d.length;_<p;_++){t=d[_];var v=t.byteLength;if(l){if(l>v){l-=v;continue}t=t.subarray(l),v-=l,l=0}o.set(t,c),c+=v}return i&&(i-=a+3),{data:o,pts:s,dts:u,len:i}}return null}},{key:"pushAccesUnit",value:function(e,t){e.units.units.length&&e.frame&&(!this.config.forceKeyFrameOnDiscontinuity||e.key===!0||t.sps&&(t.samples.length||this.contiguous)?t.samples.push(e):t.dropped++),e.debug.length&&f.logger.log(e.pts+"/"+e.dts+":"+e.debug+","+e.units.length)}},{key:"_parseAVCPES",value:function(e,t){var n,r,i,a=this,o=this._avcTrack,s=this._parseAVCNALu(e.data),u=!1,l=this.avcSample;e.data=null,s.forEach(function(t){switch(t.type){case 1:r=!0,u&&l&&(l.debug+="NDR "),l.frame=!0;var s=t.data;if(s.length>4){var c=new d.default(s).readSliceType();2!==c&&4!==c&&7!==c&&9!==c||(l.key=!0)}break;case 5:r=!0,l||(l=a.avcSample=a._createAVCSample(!0,e.pts,e.dts,"")),u&&(l.debug+="IDR "),l.key=!0,l.frame=!0;break;case 6:r=!0,u&&l&&(l.debug+="SEI "),n=new d.default(a.discardEPB(t.data)),n.readUByte();for(var f=0,h=0,_=!1,p=0;!_&&n.bytesAvailable>1;){f=0;do p=n.readUByte(),f+=p;while(255===p);h=0;do p=n.readUByte(),h+=p;while(255===p);if(4===f&&0!==n.bytesAvailable){_=!0;var v=n.readUByte();if(181===v){var E=n.readUShort();if(49===E){var g=n.readUInt();if(1195456820===g){var m=n.readUByte();if(3===m){var y=n.readUByte(),S=n.readUByte(),T=31&y,A=[y,S];for(i=0;i<T;i++)A.push(n.readUByte()),A.push(n.readUByte()),A.push(n.readUByte());a._insertSampleInOrder(a._txtTrack.samples,{type:3,pts:e.pts,bytes:A})}}}}}else if(h<n.bytesAvailable)for(i=0;i<h;i++)n.readUByte()}break;case 7:if(r=!0,u&&l&&(l.debug+="SPS "),!o.sps){n=new d.default(t.data);var R=n.readSPS();o.width=R.width,o.height=R.height,o.pixelRatio=R.pixelRatio,o.sps=[t.data],o.duration=a._duration;var D=t.data.subarray(1,4),C="avc1.";for(i=0;i<3;i++){var w=D[i].toString(16);w.length<2&&(w="0"+w),C+=w}o.codec=C}break;case 8:r=!0,u&&l&&(l.debug+="PPS "),o.pps||(o.pps=[t.data]);break;case 9:r=!1,l&&a.pushAccesUnit(l,o),l=a.avcSample=a._createAVCSample(!1,e.pts,e.dts,u?"AUD ":"");break;case 12:r=!1;break;default:r=!1,l&&(l.debug+="unknown NAL "+t.type+" ")}if(l&&r){var b=l.units;b.units.push(t)}}),t&&l&&(this.pushAccesUnit(l,o),this.avcSample=null)}},{key:"_createAVCSample",value:function(e,t,n,r){return{key:e,pts:t,dts:n,units:{units:[],length:0},debug:r}}},{key:"_insertSampleInOrder",value:function(e,t){var n=e.length;if(n>0){if(t.pts>=e[n-1].pts)e.push(t);else for(var r=n-1;r>=0;r--)if(t.pts<e[r].pts){e.splice(r,0,t);break}}else e.push(t)}},{key:"_getLastNalUnit",value:function(){var e=this.avcSample,t=void 0;if(!e||0===e.units.units.length){var n=this._avcTrack,r=n.samples;e=r[r.length-1]}if(e){var i=e.units.units;t=i[i.length-1]}return t}},{key:"_parseAVCNALu",value:function(e){var t,n,r,i,a,o=0,s=e.byteLength,u=this._avcTrack,l=u.naluState||0,c=l,d=[],f=-1;for(l===-1&&(f=0,a=31&e[0],l=0,o=1);o<s;)if(t=e[o++],l)if(1!==l)if(t)if(1===t){if(f>=0)r={data:e.subarray(f,o-l-1),type:a},d.push(r);else{var h=this._getLastNalUnit();if(h&&(c&&o<=4-c&&h.state&&(h.data=h.data.subarray(0,h.data.byteLength-c)),n=o-l-1,n>0)){var _=new Uint8Array(h.data.byteLength+n);_.set(h.data,0),_.set(e.subarray(0,n),h.data.byteLength),h.data=_}}o<s?(i=31&e[o],f=o,a=i,l=0):l=-1}else l=0;else l=3;else l=t?0:2;else l=t?0:1;if(f>=0&&l>=0&&(r={data:e.subarray(f,s),type:a,state:l},d.push(r)),0===d.length){var p=this._getLastNalUnit();if(p){var v=new Uint8Array(p.data.byteLength+e.byteLength);v.set(p.data,0),v.set(e,p.data.byteLength),p.data=v}}return u.naluState=l,d}},{key:"discardEPB",value:function(e){for(var t,n,r=e.byteLength,i=[],a=1;a<r-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(i.push(a+2),a+=2):a++;if(0===i.length)return e;t=r-i.length,n=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===i[0]&&(o++,i.shift()),n[a]=e[o];return n}},{key:"_parseAACPES",value:function(e){var t,n,r,i,a,o,u,c,d,_=this._audioTrack,p=e.data,v=e.pts,E=0,g=this.aacOverFlow,m=this.aacLastPTS;if(g){var y=new Uint8Array(g.byteLength+p.byteLength);y.set(g,0),y.set(p,g.byteLength),p=y}for(a=E,c=p.length;a<c-1&&(255!==p[a]||240!==(240&p[a+1]));a++);if(a){var S,T;if(a<c-1?(S="AAC PES did not start with ADTS header,offset:"+a,T=!1):(S="no ADTS header found in AAC PES",T=!0),f.logger.warn("parsing error:"+S),this.observer.trigger(l.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,id:this.id,details:h.ErrorDetails.FRAG_PARSING_ERROR,fatal:T,reason:S}),T)return}if(!_.audiosamplerate){var A=this.audioCodec;t=s.default.getAudioConfig(this.observer,p,a,A),_.config=t.config,_.audiosamplerate=t.samplerate,_.channelCount=t.channelCount,_.codec=t.codec,_.manifestCodec=t.manifestCodec,_.duration=this._duration,f.logger.log("parsed codec:"+_.codec+",rate:"+t.samplerate+",nb channel:"+t.channelCount)}if(i=0,r=9216e4/_.audiosamplerate,g&&m){var R=m+r;Math.abs(R-v)>1&&(f.logger.log("AAC: align PTS for overlapping frames by "+Math.round((R-v)/90)),v=R)}for(;a+5<c&&(o=1&p[a+1]?7:9,n=(3&p[a+3])<<11|p[a+4]<<3|(224&p[a+5])>>>5,n-=o,n>0&&a+o+n<=c);)for(u=v+i*r,d={unit:p.subarray(a+o,a+o+n),pts:u,dts:u},_.samples.push(d),_.len+=n,a+=n+o,i++;a<c-1&&(255!==p[a]||240!==(240&p[a+1]));a++);g=a<c?p.subarray(a,c):null,this.aacOverFlow=g,this.aacLastPTS=u}},{key:"_parseMPEGPES",value:function(e){for(var t,n=e.data,r=e.pts,i=n.length,a=0,o=0;o<i&&(t=this._parseMpeg(n,o,i,a++,r))>0;)o+=t}},{key:"_onMpegFrame",value:function(e,t,n,r,i,a){var o=1152/n*1e3,s=a+i*o,u=this._audioTrack;u.config=[],u.channelCount=r,u.audiosamplerate=n,u.duration=this._duration,u.samples.push({unit:e,pts:s,dts:s}),u.len+=e.length}},{key:"_onMpegNoise",value:function(e){f.logger.warn("mpeg audio has noise: "+e.length+" bytes")}},{key:"_parseMpeg",value:function(e,t,n,r,i){var a=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],o=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3];if(t+2>n)return-1;if(255===e[t]||224===(224&e[t+1])){if(t+24>n)return-1;var s=e[t+1]>>3&3,u=e[t+1]>>1&3,l=e[t+2]>>4&15,c=e[t+2]>>2&3,d=!!(2&e[t+2]);if(1!==s&&0!==l&&15!==l&&3!==c){var f=3===s?3-u:3===u?3:4,h=1e3*a[14*f+l-1],_=3===s?0:2===s?1:2,p=o[3*_+c],v=d?1:0,E=e[t+3]>>6===3?1:2,g=3===u?(3===s?12:6)*h/p+v<<2:(3===s?144:72)*h/p+v|0;return t+g>n?-1:(this._onMpegFrame&&this._onMpegFrame(e.subarray(t,t+g),h,p,E,r,i),g)}}for(var m=t+2;m<n;){if(255===e[m-1]&&224===(224&e[m]))return this._onMpegNoise&&this._onMpegNoise(e.subarray(t,m-1)),m-t-1;m++}return-1}},{key:"_parseID3PES",value:function(e){this._id3Track.samples.push(e)}}],[{key:"probe",value:function(e){return e.length>=564&&71===e[0]&&71===e[188]&&71===e[376]}}]),e}();n.default=_},{19:19,23:23,26:26,28:28,45:45}],26:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.ErrorTypes={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},n.ErrorDetails={MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOOP_LOADING_ERROR:"fragLoopLoadingError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException"}},{}],27:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e(45),u=e(26),l=e(28),c=r(l),d=function(){function e(t){i(this,e),this.hls=t,this.onEvent=this.onEvent.bind(this);for(var n=arguments.length,r=Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];this.handledEvents=r,this.useGenericHandler=!0,this.registerListeners()}return o(e,[{key:"destroy",value:function(){this.unregisterListeners()}},{key:"isEventHandler",value:function(){return"object"===a(this.handledEvents)&&this.handledEvents.length&&"function"==typeof this.onEvent}},{key:"registerListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){if("hlsEventGeneric"===e)throw new Error("Forbidden event name: "+e);this.hls.on(e,this.onEvent)}.bind(this))}},{key:"unregisterListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.hls.off(e,this.onEvent)}.bind(this))}},{key:"onEvent",value:function(e,t){this.onEventGeneric(e,t)}},{key:"onEventGeneric",value:function(e,t){var n=function(e,t){var n="on"+e.replace("hls","");if("function"!=typeof this[n])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+n+")");return this[n].bind(this,t)};try{n.call(this,e,t).call()}catch(t){s.logger.error("internal error happened while processing "+e+":"+t.message),this.hls.trigger(c.default.ERROR,{type:u.ErrorTypes.OTHER_ERROR,details:u.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:e,err:t})}}}]),e}();n.default=d},{26:26,28:28,45:45}],28:[function(e,t,n){"use strict";t.exports={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",LEVEL_SWITCH:"hlsLevelSwitch",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCH:"hlsAudioTrackSwitch",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},{}],29:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(){r(this,e)}return i(e,null,[{key:"getSilentFrame",value:function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}}]),e}();n.default=a},{}],30:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(){r(this,e)}return i(e,null,[{key:"isBuffered",value:function(e,t){if(e)for(var n=e.buffered,r=0;r<n.length;r++)if(t>=n.start(r)&&t<=n.end(r))return!0;return!1}},{key:"bufferInfo",value:function(e,t,n){if(e){var r,i=e.buffered,a=[];for(r=0;r<i.length;r++)a.push({start:i.start(r),end:i.end(r)});return this.bufferedInfo(a,t,n)}return{len:0,start:0,end:0,nextStart:void 0}}},{key:"bufferedInfo",value:function(e,t,n){var r,i,a,o,s,u=[];for(e.sort(function(e,t){var n=e.start-t.start;return n?n:t.end-e.end}),s=0;s<e.length;s++){var l=u.length;if(l){var c=u[l-1].end;e[s].start-c<n?e[s].end>c&&(u[l-1].end=e[s].end):u.push(e[s])}else u.push(e[s])}for(s=0,r=0,i=a=t;s<u.length;s++){var d=u[s].start,f=u[s].end;if(t+n>=d&&t<f)i=d,a=f,r=a-t;else if(t+n<d){o=d;break}}return{len:r,start:i,end:a,nextStart:o}}}]),e}();n.default=a},{}],31:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=e(45),o=function(){function e(){r(this,e)}return i(e,null,[{key:"mergeDetails",value:function(t,n){var r,i=Math.max(t.startSN,n.startSN)-n.startSN,o=Math.min(t.endSN,n.endSN)-n.startSN,s=n.startSN-t.startSN,u=t.fragments,l=n.fragments,c=0;if(o<i)return void(n.PTSKnown=!1);for(var d=i;d<=o;d++){var f=u[s+d],h=l[d];h&&f&&(c=f.cc-h.cc,isNaN(f.startPTS)||(h.start=h.startPTS=f.startPTS,h.endPTS=f.endPTS,h.duration=f.duration,r=h))}if(c)for(a.logger.log("discontinuity sliding from playlist, take drift into account"),d=0;d<l.length;d++)l[d].cc+=c;if(r)e.updateFragPTSDTS(n,r.sn,r.startPTS,r.endPTS,r.startDTS,r.endDTS);else if(s>=0&&s<u.length){var _=u[s].start;for(d=0;d<l.length;d++)l[d].start+=_}n.PTSKnown=t.PTSKnown}},{key:"updateFragPTSDTS",value:function(t,n,r,i,a,o){var s,u,l,c;if(!t||n<t.startSN||n>t.endSN)return 0;if(s=n-t.startSN,u=t.fragments,l=u[s],!isNaN(l.startPTS)){var d=Math.abs(l.startPTS-r);isNaN(l.deltaPTS)?l.deltaPTS=d:l.deltaPTS=Math.max(d,l.deltaPTS),r=Math.min(r,l.startPTS),i=Math.max(i,l.endPTS),a=Math.min(a,l.startDTS),o=Math.max(o,l.endDTS)}var f=r-l.start;for(l.start=l.startPTS=r,l.endPTS=i,l.startDTS=a,l.endDTS=o,l.duration=i-r,c=s;c>0;c--)e.updatePTS(u,c,c-1);for(c=s;c<u.length-1;c++)e.updatePTS(u,c,c+1);return t.PTSKnown=!0,f}},{key:"updatePTS",value:function(e,t,n){var r=e[t],i=e[n],o=i.startPTS;isNaN(o)?n>t?i.start=r.start+r.duration:i.start=r.start-i.duration:n>t?(r.duration=o-r.start,r.duration<0&&a.logger.warn("negative duration computed for frag "+r.sn+",level "+r.level+", there should be some duration drift between playlist and fragment!")):(i.duration=r.start-o,i.duration<0&&a.logger.warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!"))}}]),e}();n.default=o},{45:45}],32:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e(28),s=r(o),u=e(26),l=e(36),c=r(l),d=e(34),f=r(d),h=e(4),_=r(h),p=e(7),v=r(p),E=e(8),g=r(E),m=e(5),y=r(m),S=e(12),T=r(S),A=e(11),R=r(A),D=e(13),C=r(D),w=e(10),b=r(w),O=e(6),P=r(O),L=e(45),I=e(47),k=r(I),N=e(1),M=r(N),U=e(35),x=r(U),F=e(43),B=r(F),G=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e);var n=e.DefaultConfig;if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var r in n)r in t||(t[r]=n[r]);if(void 0!==t.liveMaxLatencyDurationCount&&t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(t.liveMaxLatencyDuration<=t.liveSyncDuration||void 0===t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');(0,L.enableLogs)(t.debug),this.config=t;var a=this.observer=new M.default;a.trigger=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];a.emit.apply(a,[e,e].concat(n))},a.off=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];a.removeListener.apply(a,[e].concat(n))},this.on=a.on.bind(a),this.off=a.off.bind(a),
            this.trigger=a.trigger.bind(a),this.playlistLoader=new c.default(this),this.fragmentLoader=new f.default(this),this.levelController=new R.default(this),this.abrController=new t.abrController(this),this.bufferController=new t.bufferController(this),this.capLevelController=new t.capLevelController(this),this.fpsController=new t.fpsController(this),this.streamController=new t.streamController(this),this.audioStreamController=new t.audioStreamController(this),this.timelineController=new t.timelineController(this),this.audioTrackController=new P.default(this),this.keyLoader=new x.default(this)}return a(e,null,[{key:"isSupported",value:function(){return window.MediaSource=window.MediaSource||window.WebKitMediaSource,window.MediaSource&&"function"==typeof window.MediaSource.isTypeSupported&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')}},{key:"version",get:function(){return"0.6.21"}},{key:"Events",get:function(){return s.default}},{key:"ErrorTypes",get:function(){return u.ErrorTypes}},{key:"ErrorDetails",get:function(){return u.ErrorDetails}},{key:"DefaultConfig",get:function(){return e.defaultConfig||(e.defaultConfig={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,maxMaxBufferLength:600,maxSeekHole:2,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.2,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,fragLoadingLoopThreshold:3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:k.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,fetchSetup:void 0,abrController:_.default,bufferController:v.default,capLevelController:g.default,fpsController:b.default,streamController:T.default,audioStreamController:y.default,timelineController:C.default,cueHandler:B.default,enableCEA708Captions:!0,enableMP2TPassThrough:!1,stretchShortVideoTrack:!1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0}),e.defaultConfig},set:function(t){e.defaultConfig=t}}]),a(e,[{key:"destroy",value:function(){L.logger.log("destroy"),this.trigger(s.default.DESTROYING),this.detachMedia(),this.playlistLoader.destroy(),this.fragmentLoader.destroy(),this.levelController.destroy(),this.abrController.destroy(),this.bufferController.destroy(),this.capLevelController.destroy(),this.fpsController.destroy(),this.streamController.destroy(),this.audioStreamController.destroy(),this.timelineController.destroy(),this.audioTrackController.destroy(),this.keyLoader.destroy(),this.url=null,this.observer.removeAllListeners()}},{key:"attachMedia",value:function(e){L.logger.log("attachMedia"),this.media=e,this.trigger(s.default.MEDIA_ATTACHING,{media:e})}},{key:"detachMedia",value:function(){L.logger.log("detachMedia"),this.trigger(s.default.MEDIA_DETACHING),this.media=null}},{key:"loadSource",value:function(e){L.logger.log("loadSource:"+e),this.url=e,this.trigger(s.default.MANIFEST_LOADING,{url:e})}},{key:"startLoad",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;L.logger.log("startLoad("+e+")"),this.levelController.startLoad(),this.streamController.startLoad(e),this.audioStreamController.startLoad(e)}},{key:"stopLoad",value:function(){L.logger.log("stopLoad"),this.levelController.stopLoad(),this.streamController.stopLoad(),this.audioStreamController.stopLoad()}},{key:"swapAudioCodec",value:function(){L.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}},{key:"recoverMediaError",value:function(){L.logger.log("recoverMediaError");var e=this.media;this.detachMedia(),this.attachMedia(e)}},{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){L.logger.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){L.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){L.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.abrController.minAutoLevel)},set:function(e){L.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){L.logger.log("set startLevel:"+e),this.levelController.startLevel=e}},{key:"autoLevelCapping",get:function(){return this.abrController.autoLevelCapping},set:function(e){L.logger.log("set autoLevelCapping:"+e),this.abrController.autoLevelCapping=e}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"audioTracks",get:function(){return this.audioTrackController.audioTracks}},{key:"audioTrack",get:function(){return this.audioTrackController.audioTrack},set:function(e){this.audioTrackController.audioTrack=e}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}}]),e}();n.default=G},{1:1,10:10,11:11,12:12,13:13,26:26,28:28,34:34,35:35,36:36,4:4,43:43,45:45,47:47,5:5,6:6,7:7,8:8}],33:[function(e,t,n){"use strict";t.exports=e(32).default},{32:32}],34:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e(28),l=r(u),c=e(27),d=r(c),f=e(26),h=e(45),_=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.FRAG_LOADING));return n.loaders={},n}return o(t,e),s(t,[{key:"destroy",value:function(){var e=this.loaders;for(var t in e){var n=e[t];n&&n.destroy()}this.loaders={},d.default.prototype.destroy.call(this)}},{key:"onFragLoading",value:function(e){var t=e.frag,n=t.type,r=this.loaders[n],i=this.hls.config;t.loaded=0,r&&(h.logger.warn("abort previous fragment loader for type:"+n),r.abort()),r=this.loaders[n]=t.loader="undefined"!=typeof i.fLoader?new i.fLoader(i):new i.loader(i);var a=void 0,o=void 0,s=void 0;a={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};var u=t.byteRangeStartOffset,l=t.byteRangeEndOffset;isNaN(u)||isNaN(l)||(a.rangeStart=u,a.rangeEnd=l),o={timeout:i.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:i.fragLoadingMaxRetryTimeout},s={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},r.load(a,o,s)}},{key:"loadsuccess",value:function(e,t,n){var r=e.data,i=n.frag;i.loader=void 0,this.loaders[i.type]=void 0,this.hls.trigger(l.default.FRAG_LOADED,{payload:r,frag:i,stats:t})}},{key:"loaderror",value:function(e,t){var n=t.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(l.default.ERROR,{type:f.ErrorTypes.NETWORK_ERROR,details:f.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e})}},{key:"loadtimeout",value:function(e,t){var n=t.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(l.default.ERROR,{type:f.ErrorTypes.NETWORK_ERROR,details:f.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag})}},{key:"loadprogress",value:function(e,t,n){var r=t.frag;r.loaded=e.loaded,this.hls.trigger(l.default.FRAG_LOAD_PROGRESS,{frag:r,stats:e})}}]),t}(d.default);n.default=_},{26:26,27:27,28:28,45:45}],35:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e(28),l=r(u),c=e(27),d=r(c),f=e(26),h=e(45),_=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.KEY_LOADING));return n.loaders={},n.decryptkey=null,n.decrypturl=null,n}return o(t,e),s(t,[{key:"destroy",value:function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},d.default.prototype.destroy.call(this)}},{key:"onKeyLoading",value:function(e){var t=e.frag,n=t.type,r=this.loaders[n],i=t.decryptdata,a=i.uri;if(a!==this.decrypturl||null===this.decryptkey){var o=this.hls.config;r&&(h.logger.warn("abort previous key loader for type:"+n),r.abort()),t.loader=this.loaders[n]=new o.loader(o),this.decrypturl=a,this.decryptkey=null;var s=void 0,u=void 0,c=void 0;s={url:a,frag:t,responseType:"arraybuffer"},u={timeout:o.fragLoadingTimeOut,maxRetry:o.fragLoadingMaxRetry,retryDelay:o.fragLoadingRetryDelay,maxRetryDelay:o.fragLoadingMaxRetryTimeout},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},t.loader.load(s,u,c)}else this.decryptkey&&(i.key=this.decryptkey,this.hls.trigger(l.default.KEY_LOADED,{frag:t}))}},{key:"loadsuccess",value:function(e,t,n){var r=n.frag;this.decryptkey=r.decryptdata.key=new Uint8Array(e.data),r.loader=void 0,this.loaders[r.type]=void 0,this.hls.trigger(l.default.KEY_LOADED,{frag:r})}},{key:"loaderror",value:function(e,t){var n=t.frag,r=n.loader;r&&r.abort(),this.loaders[t.type]=void 0,this.hls.trigger(l.default.ERROR,{type:f.ErrorTypes.NETWORK_ERROR,details:f.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:n,response:e})}},{key:"loadtimeout",value:function(e,t){var n=t.frag,r=n.loader;r&&r.abort(),this.loaders[t.type]=void 0,this.hls.trigger(l.default.ERROR,{type:f.ErrorTypes.NETWORK_ERROR,details:f.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:n})}}]),t}(d.default);n.default=_},{26:26,27:27,28:28,45:45}],36:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e(2),l=r(u),c=e(28),d=r(c),f=e(27),h=r(f),_=e(26),p=e(40),v=r(p),E=e(45),g=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,m=/#EXT-X-MEDIA:(.*)/g,y=/#EXTINF:(\d*(?:\.\d+)?)(?:,(.*))?|(?!#)(\S.+)|#EXT-X-BYTERANGE: *(.+)|#EXT-X-PROGRAM-DATE-TIME:(.+)|#.*/g,S=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)(.*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,T=function(){function e(){o(this,e),this.method=null,this.key=null,this.iv=null,this._uri=null}return s(e,[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=l.default.buildAbsoluteURL(this.baseuri,this.reluri)),this._uri}}]),e}(),A=function(){function e(){o(this,e),this._url=null,this._byteRange=null,this._decryptdata=null,this.tagList=[]}return s(e,[{key:"createInitializationVector",value:function(e){for(var t=new Uint8Array(16),n=12;n<16;n++)t[n]=e>>8*(15-n)&255;return t}},{key:"fragmentDecryptdataFromLevelkey",value:function(e,t){var n=e;return e&&e.method&&e.uri&&!e.iv&&(n=new T,n.method=e.method,n.baseuri=e.baseuri,n.reluri=e.reluri,n.iv=this.createInitializationVector(t)),n}},{key:"cloneObj",value:function(e){return JSON.parse(JSON.stringify(e))}},{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=l.default.buildAbsoluteURL(this.baseurl,this.relurl)),this._url},set:function(e){this._url=e}},{key:"programDateTime",get:function(){return!this._programDateTime&&this.rawProgramDateTime&&(this._programDateTime=new Date(Date.parse(this.rawProgramDateTime))),this._programDateTime}},{key:"byteRange",get:function(){if(!this._byteRange){var e=this._byteRange=[];if(this.rawByteRange){var t=this.rawByteRange.split("@",2);if(1===t.length){var n=this.lastByteRangeEndOffset;e[0]=n?n:0}else e[0]=parseInt(t[1]);e[1]=parseInt(t[0])+e[0]}}return this._byteRange}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata}}]),e}(),R=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,d.default.MANIFEST_LOADING,d.default.LEVEL_LOADING,d.default.AUDIO_TRACK_LOADING));return n.loaders={},n}return a(t,e),s(t,[{key:"destroy",value:function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},h.default.prototype.destroy.call(this)}},{key:"onManifestLoading",value:function(e){this.load(e.url,{type:"manifest"})}},{key:"onLevelLoading",value:function(e){this.load(e.url,{type:"level",level:e.level,id:e.id})}},{key:"onAudioTrackLoading",value:function(e){this.load(e.url,{type:"audioTrack",id:e.id})}},{key:"load",value:function(e,t){var n=this.loaders[t.type];if(n){var r=n.context;if(r&&r.url===e)return void E.logger.trace("playlist request ongoing");E.logger.warn("abort previous loader for type:"+t.type),n.abort()}var i=this.hls.config,a=void 0,o=void 0,s=void 0,u=void 0;"manifest"===t.type?(a=i.manifestLoadingMaxRetry,o=i.manifestLoadingTimeOut,s=i.manifestLoadingRetryDelay,u=i.manifestLoadingMaxRetryTimeout):(a=i.levelLoadingMaxRetry,o=i.levelLoadingTimeOut,s=i.levelLoadingRetryDelay,u=i.levelLoadingMaxRetryTimeout,E.logger.log("loading playlist for "+t.type+" "+(t.level||t.id))),n=this.loaders[t.type]=t.loader="undefined"!=typeof i.pLoader?new i.pLoader(i):new i.loader(i),t.url=e,t.responseType="";var l=void 0,c=void 0;l={timeout:o,maxRetry:a,retryDelay:s,maxRetryDelay:u},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},n.load(t,l,c)}},{key:"resolve",value:function(e,t){return l.default.buildAbsoluteURL(t,e)}},{key:"parseMasterPlaylist",value:function(e,t){var n=[],r=void 0;for(g.lastIndex=0;null!=(r=g.exec(e));){var i={},a=i.attrs=new v.default(r[1]);i.url=this.resolve(r[2],t);var o=a.decimalResolution("RESOLUTION");o&&(i.width=o.width,i.height=o.height),i.bitrate=a.decimalInteger("AVERAGE-BANDWIDTH")||a.decimalInteger("BANDWIDTH"),i.name=a.NAME;var s=a.CODECS;if(s){s=s.split(/[ ,]+/);for(var u=0;u<s.length;u++){var l=s[u];l.indexOf("avc1")!==-1?i.videoCodec=this.avc1toavcoti(l):i.audioCodec=l}}n.push(i)}return n}},{key:"parseMasterPlaylistMedia",value:function(e,t,n){var r=void 0,i=[];for(m.lastIndex=0;null!=(r=m.exec(e));){var a={},o=new v.default(r[1]);o.TYPE===n&&(a.groupId=o["GROUP-ID"],a.name=o.NAME,a.type=n,a.default="YES"===o.DEFAULT,a.autoselect="YES"===o.AUTOSELECT,a.forced="YES"===o.FORCED,o.URI&&(a.url=this.resolve(o.URI,t)),a.lang=o.LANGUAGE,a.name||(a.name=a.lang),i.push(a))}return i}},{key:"avc1toavcoti",value:function(e){var t,n=e.split(".");return n.length>2?(t=n.shift()+".",t+=parseInt(n.shift()).toString(16),t+=("000"+parseInt(n.shift()).toString(16)).substr(-4)):t=e,t}},{key:"parseLevelPlaylist",value:function(e,t,n,r){var i,a,o=0,s=0,u={type:null,version:null,url:t,fragments:[],live:!0,startSN:0},l=new T,c=0,d=null,f=new A;for(y.lastIndex=0;null!==(i=y.exec(e));){var h=i[1];if(h){f.duration=parseFloat(h);var _=(" "+i[2]).slice(1);f.title=_?_:null,f.tagList.push(_?["INF",h,_]:["INF",h])}else if(i[3]){if(!isNaN(f.duration)){var p=o++;f.type=r,f.start=s,f.levelkey=l,f.sn=p,f.level=n,f.cc=c,f.baseurl=t,f.relurl=(" "+i[3]).slice(1),u.fragments.push(f),d=f,s+=f.duration,f=new A}}else if(i[4]){if(f.rawByteRange=(" "+i[4]).slice(1),d){var g=d.byteRangeEndOffset;g&&(f.lastByteRangeEndOffset=g)}}else if(i[5])f.rawProgramDateTime=(" "+i[5]).slice(1),f.tagList.push(["PROGRAM-DATE-TIME",f.rawProgramDateTime]);else{for(i=i[0].match(S),a=1;a<i.length&&void 0===i[a];a++);var m=(" "+i[a+1]).slice(1),R=(" "+i[a+2]).slice(1);switch(i[a]){case"#":f.tagList.push(R?[m,R]:[m]);break;case"PLAYLIST-TYPE":u.type=m.toUpperCase();break;case"MEDIA-SEQUENCE":o=u.startSN=parseInt(m);break;case"TARGETDURATION":u.targetduration=parseFloat(m);break;case"VERSION":u.version=parseInt(m);break;case"EXTM3U":break;case"ENDLIST":u.live=!1;break;case"DIS":c++,f.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":c=parseInt(m);break;case"KEY":var D=m,C=new v.default(D),w=C.enumeratedString("METHOD"),b=C.URI,O=C.hexadecimalInteger("IV");w&&(l=new T,b&&"AES-128"===w&&(l.method=w,l.baseuri=t,l.reluri=b,l.key=null,l.iv=O));break;case"START":var P=m,L=new v.default(P),I=L.decimalFloatingPoint("TIME-OFFSET");isNaN(I)||(u.startTimeOffset=I);break;case"MAP":var k=new v.default(m);f.relurl=k.URI,f.rawByteRange=k.BYTERANGE,f.baseurl=t,f.level=n,f.type=r,f.sn="initSegment",u.initSegment=f,f=new A;break;default:E.logger.warn("line parsed but not handled: "+i)}}}return f=d,f&&!f.relurl&&(u.fragments.pop(),s-=f.duration),u.totalduration=s,u.averagetargetduration=s/u.fragments.length,u.endSN=o-1,u}},{key:"loadsuccess",value:function(e,t,n){var r=e.data,i=e.url,a=n.type,o=n.id,s=n.level,u=this.hls;if(this.loaders[a]=void 0,void 0!==i&&0!==i.indexOf("data:")||(i=n.url),t.tload=performance.now(),0===r.indexOf("#EXTM3U"))if(r.indexOf("#EXTINF:")>0){var l="audioTrack"!==a,c=this.parseLevelPlaylist(r,i,(l?s:o)||0,l?"main":"audio");"manifest"===a&&u.trigger(d.default.MANIFEST_LOADED,{levels:[{url:i,details:c}],audioTracks:[],url:i,stats:t}),t.tparsed=performance.now(),c.targetduration?l?u.trigger(d.default.LEVEL_LOADED,{details:c,level:s||0,id:o||0,stats:t}):u.trigger(d.default.AUDIO_TRACK_LOADED,{details:c,id:o,stats:t}):u.trigger(d.default.ERROR,{type:_.ErrorTypes.NETWORK_ERROR,details:_.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:i,reason:"invalid targetduration"})}else{var f=this.parseMasterPlaylist(r,i);if(f.length){var h=this.parseMasterPlaylistMedia(r,i,"AUDIO");if(h.length){var p=!1;h.forEach(function(e){e.url||(p=!0)}),p===!1&&f[0].audioCodec&&!f[0].attrs.AUDIO&&(E.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),h.unshift({type:"main",name:"main"}))}u.trigger(d.default.MANIFEST_LOADED,{levels:f,audioTracks:h,url:i,stats:t})}else u.trigger(d.default.ERROR,{type:_.ErrorTypes.NETWORK_ERROR,details:_.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:i,reason:"no level found in manifest"})}else u.trigger(d.default.ERROR,{type:_.ErrorTypes.NETWORK_ERROR,details:_.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:i,reason:"no EXTM3U delimiter"})}},{key:"loaderror",value:function(e,t){var n,r,i=t.loader;switch(t.type){case"manifest":n=_.ErrorDetails.MANIFEST_LOAD_ERROR,r=!0;break;case"level":n=_.ErrorDetails.LEVEL_LOAD_ERROR,r=!1;break;case"audioTrack":n=_.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,r=!1}i&&(i.abort(),this.loaders[t.type]=void 0),this.hls.trigger(d.default.ERROR,{type:_.ErrorTypes.NETWORK_ERROR,details:n,fatal:r,url:i.url,loader:i,response:e,context:t})}},{key:"loadtimeout",value:function(e,t){var n,r,i=t.loader;switch(t.type){case"manifest":n=_.ErrorDetails.MANIFEST_LOAD_TIMEOUT,r=!0;break;case"level":n=_.ErrorDetails.LEVEL_LOAD_TIMEOUT,r=!1;break;case"audioTrack":n=_.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT,r=!1}i&&(i.abort(),this.loaders[t.type]=void 0),this.hls.trigger(d.default.ERROR,{type:_.ErrorTypes.NETWORK_ERROR,details:n,fatal:r,url:i.url,loader:i,context:t})}}]),t}(h.default);n.default=R},{2:2,26:26,27:27,28:28,40:40,45:45}],37:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(){r(this,e)}return i(e,null,[{key:"init",value:function(){e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var t;for(t in e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var n=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:n,audio:r};var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=a,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),u=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,o,u,o,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,i))}},{key:"box",value:function(e){for(var t,n=Array.prototype.slice.call(arguments,1),r=8,i=n.length,a=i;i--;)r+=n[i].byteLength;for(t=new Uint8Array(r),t[0]=r>>24&255,t[1]=r>>16&255,t[2]=r>>8&255,t[3]=255&r,t.set(e,4),i=0,r=8;i<a;i++)t.set(n[i],r),r+=n[i].byteLength;return t}},{key:"hdlr",value:function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])}},{key:"mdat",value:function(t){return e.box(e.types.mdat,t)}},{key:"mdhd",value:function(t,n){return n*=t,e.box(e.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,85,196,0,0]))}},{key:"mdia",value:function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))}},{key:"mfhd",value:function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"minf",value:function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))}},{key:"moof",value:function(t,n,r){return e.box(e.types.moof,e.mfhd(t),e.traf(r,n))}},{key:"moov",value:function(t){for(var n=t.length,r=[];n--;)r[n]=e.trak(t[n]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(r).concat(e.mvex(t)))}},{key:"mvex",value:function(t){for(var n=t.length,r=[];n--;)r[n]=e.trex(t[n]);return e.box.apply(null,[e.types.mvex].concat(r))}},{key:"mvhd",value:function(t,n){n*=t;var r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24&255,n>>16&255,n>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,r)}},{key:"sdtp",value:function(t){var n,r,i=t.samples||[],a=new Uint8Array(4+i.length);for(r=0;r<i.length;r++)n=i[r].flags,a[r+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;return e.box(e.types.sdtp,a)}},{key:"stbl",value:function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))}},{key:"avc1",value:function(t){var n,r,i,a=[],o=[];for(n=0;n<t.sps.length;n++)r=t.sps[n],i=r.byteLength,a.push(i>>>8&255),a.push(255&i),a=a.concat(Array.prototype.slice.call(r));for(n=0;n<t.pps.length;n++)r=t.pps[n],i=r.byteLength,o.push(i>>>8&255),o.push(255&i),o=o.concat(Array.prototype.slice.call(r));var s=e.box(e.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|t.sps.length].concat(a).concat([t.pps.length]).concat(o))),u=t.width,l=t.height,c=t.pixelRatio[0],d=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,u>>8&255,255&u,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,d>>24,d>>16&255,d>>8&255,255&d])))}},{key:"esds",value:function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}},{key:"mp4a",value:function(t){var n=t.audiosamplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,n>>8&255,255&n,0,0]),e.box(e.types.esds,e.esds(t)))}},{key:"mp3",value:function(t){var n=t.audiosamplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,n>>8&255,255&n,0,0]))}},{key:"stsd",value:function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))}},{key:"tkhd",value:function(t){var n=t.id,r=t.duration*t.timescale,i=t.width,a=t.height;return e.box(e.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,n>>24&255,n>>16&255,n>>8&255,255&n,0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,a>>8&255,255&a,0,0]))}},{key:"traf",value:function(t,n){var r=e.sdtp(t),i=t.id;return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),e.box(e.types.tfdt,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n])),e.trun(t,r.length+16+16+8+16+8+8),r)}},{key:"trak",value:function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))}},{key:"trex",value:function(t){var n=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trun",value:function(t,n){var r,i,a,o,s,u,l=t.samples||[],c=l.length,d=12+16*c,f=new Uint8Array(d);for(n+=8+d,f.set([0,0,15,1,c>>>24&255,c>>>16&255,c>>>8&255,255&c,n>>>24&255,n>>>16&255,n>>>8&255,255&n],0),r=0;r<c;r++)i=l[r],a=i.duration,o=i.size,s=i.flags,u=i.cts,f.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,u>>>24&255,u>>>16&255,u>>>8&255,255&u],12+16*r);return e.box(e.types.trun,f)}},{key:"initSegment",value:function(t){e.types||e.init();var n,r=e.moov(t);return n=new Uint8Array(e.FTYP.byteLength+r.byteLength),n.set(e.FTYP),n.set(r,e.FTYP.byteLength),n}}]),e}();n.default=a},{}],38:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e(29),s=r(o),u=e(28),l=r(u),c=e(45),d=e(37),f=r(d),h=e(26),_=function(){function e(t,n,r,a){i(this,e),this.observer=t,this.id=n,this.config=r,this.typeSupported=a,this.ISGenerated=!1,this.PES2MP4SCALEFACTOR=4,this.PES_TIMESCALE=9e4,this.MP4_TIMESCALE=this.PES_TIMESCALE/this.PES2MP4SCALEFACTOR}return a(e,[{key:"destroy",value:function(){}},{key:"insertDiscontinuity",value:function(){this._initPTS=this._initDTS=void 0}},{key:"switchLevel",value:function(){this.ISGenerated=!1}},{key:"remux",value:function(e,t,n,r,i,a,o,s,u,c,d){if(this.level=e,this.sn=t,this.ISGenerated||this.generateIS(r,i,s,n),null!==d&&(this._initPTS=this._initDTS=d),this.ISGenerated)if(r.samples.length){var f=this.remuxAudio(r,s,u,c);if(i.samples.length){var h=void 0;f&&(h=f.endPTS-f.startPTS),this.remuxVideo(i,s,u,h)}}else{var _=void 0;i.samples.length&&(_=this.remuxVideo(i,s,u)),_&&r.codec&&this.remuxEmptyAudio(r,s,u,_)}a.samples.length&&this.remuxID3(a,s),o.samples.length&&this.remuxText(o,s),this.observer.trigger(l.default.FRAG_PARSED,{id:this.id,level:this.level,sn:this.sn})}},{key:"generateIS",value:function(e,t,n,r){var i,a,o=this.observer,s=e.samples,u=t.samples,d=this.PES_TIMESCALE,_=this.typeSupported,p="audio/mp4",v={},E={id:this.id,level:this.level,sn:this.sn,tracks:v,unique:!1},g=void 0===this._initPTS;g&&(i=a=1/0),e.config&&s.length&&(e.timescale=e.audiosamplerate,e.timescale*e.duration>Math.pow(2,32)&&!function(){var t=function e(t,n){return n?e(n,t%n):t};e.timescale=e.audiosamplerate/t(e.audiosamplerate,e.isAAC?1024:1152)}(),c.logger.log("audio mp4 timescale :"+e.timescale),e.isAAC||(_.mpeg?(p="audio/mpeg",e.codec=""):_.mp3&&(e.codec="mp3")),v.audio={container:p,codec:e.codec,initSegment:!e.isAAC&&_.mpeg?new Uint8Array:f.default.initSegment([e]),metadata:{channelCount:e.channelCount}},g&&(i=a=s[0].pts-d*n)),t.sps&&t.pps&&u.length&&(t.timescale=this.MP4_TIMESCALE,
            v.video={container:"video/mp4",codec:t.codec,initSegment:f.default.initSegment([t]),metadata:{width:t.width,height:t.height}},g&&(i=Math.min(i,u[0].pts-d*n),a=Math.min(a,u[0].dts-d*n),this.observer.trigger(l.default.INIT_PTS_FOUND,{id:this.id,initPTS:i,cc:r}))),Object.keys(v).length?(o.trigger(l.default.FRAG_PARSING_INIT_SEGMENT,E),this.ISGenerated=!0,g&&(this._initPTS=i,this._initDTS=a)):o.trigger(l.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,id:this.id,details:h.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})}},{key:"remuxVideo",value:function(e,t,n,r){var i,a,o,s,u,d,_,p,v=8,E=this.PES_TIMESCALE,g=this.PES2MP4SCALEFACTOR,m=e.samples,y=[],S=m.length,T=this._PTSNormalize,A=this._initDTS;m.sort(function(e,t){var n=e.dts-t.dts;return n?n:e.pts-t.pts});var R=m.reduce(function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-18e3)},0);if(R<0){c.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(R/90)+" ms to overcome this issue");for(var D=0;D<m.length;D++)m[D].dts+=R}var C=void 0;C=n?this.nextAvcDts:t*E;var w=m[0];u=Math.max(T(w.dts-A,C),0),s=Math.max(T(w.pts-A,C),0);var b=Math.round((u-C)/90);n&&b&&(b>1?c.logger.log("AVC:"+b+" ms hole between fragments detected,filling it"):b<-1&&c.logger.log("AVC:"+-b+" ms overlapping between fragments detected"),u=C,m[0].dts=u+A,s=Math.max(s-b,C),m[0].pts=s+A,c.logger.log("Video/PTS/DTS adjusted: "+Math.round(s/90)+"/"+Math.round(u/90)+",delta:"+b+" ms")),d=u,w=m[m.length-1],p=Math.max(T(w.dts-A,C),0),_=Math.max(T(w.pts-A,C),0),_=Math.max(_,p);var O=navigator.vendor,P=navigator.userAgent,L=O&&O.indexOf("Apple")>-1&&P&&!P.match("CriOS");L&&(i=Math.round((p-u)/(g*(m.length-1))));for(var I=0;I<S;I++){var k=m[I];L?k.dts=u+I*g*i:(k.dts=Math.max(T(k.dts-A,C),u),k.dts=Math.round(k.dts/g)*g),k.pts=Math.max(T(k.pts-A,C),k.dts),k.pts=Math.round(k.pts/g)*g}var N=e.len+4*e.nbNalu+8;try{a=new Uint8Array(N)}catch(e){return void this.observer.trigger(l.default.ERROR,{type:h.ErrorTypes.MUX_ERROR,level:this.level,id:this.id,details:h.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:N,reason:"fail allocating video mdat "+N})}var M=new DataView(a.buffer);M.setUint32(0,N),a.set(f.default.types.mdat,4);for(var U=0;U<S;U++){for(var x=m[U],F=x.units.units,B=0,G=void 0,H=0,j=F.length;H<j;H++){var W=F[H],V=W.data,K=W.data.byteLength;M.setUint32(v,K),v+=4,a.set(V,v),v+=K,B+=4+K}if(L)G=Math.max(0,i*Math.round((x.pts-x.dts)/(g*i)));else{if(U<S-1)i=m[U+1].dts-x.dts;else{var q=this.config,Y=x.dts-m[U>0?U-1:U].dts;if(q.stretchShortVideoTrack){var X=q.maxBufferHole,z=q.maxSeekHole,Q=Math.floor(Math.min(X,z)*E),Z=(r?s+r*E:this.nextAudioPts)-x.pts;Z>Q?(i=Z-Y,i<0&&(i=Y),c.logger.log("It is approximately "+Z/90+" ms to the next segment; using duration "+i/90+" ms for the last video frame.")):i=Y}else i=Y}i/=g,G=Math.round((x.pts-x.dts)/g)}y.push({size:B,duration:i,cts:G,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:x.key?2:1,isNonSync:x.key?0:1}})}this.nextAvcDts=p+i*g;var $=e.dropped;if(e.len=0,e.nbNalu=0,e.dropped=0,y.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var J=y[0].flags;J.dependsOn=2,J.isNonSync=0}e.samples=y,o=f.default.moof(e.sequenceNumber++,u/g,e),e.samples=[];var ee={id:this.id,level:this.level,sn:this.sn,data1:o,data2:a,startPTS:s/E,endPTS:(_+g*i)/E,startDTS:u/E,endDTS:this.nextAvcDts/E,type:"video",nb:y.length,dropped:$};return this.observer.trigger(l.default.FRAG_PARSING_DATA,ee),ee}},{key:"remuxAudio",value:function(e,t,n,r){var i,a,o,u,d,_,p,v,E,g,m,y,S,T,A,R,D=this.PES_TIMESCALE,C=e.timescale,w=D/C,b=e.timescale*(e.isAAC?1024:1152)/e.audiosamplerate,O=b*w,P=this._PTSNormalize,L=this._initDTS,I=!e.isAAC&&this.typeSupported.mpeg,k=I?0:8,N=[],M=[];if(e.samples.sort(function(e,t){return e.pts-t.pts}),M=e.samples,R=this.nextAudioPts,n|=M.length&&R&&(Math.abs(t-R/D)<.1||Math.abs(M[0].pts-R-this._initDTS)<20*O),n||(R=t*D),r&&e.isAAC)for(var U=0,x=R;U<M.length;){var F=M[U],B=P(F.pts-L,R),G=B-x;if(G<=-O)c.logger.warn("Dropping 1 audio frame @ "+Math.round(x/90)/1e3+"s due to "+Math.round(Math.abs(G/90))+" ms overlap."),M.splice(U,1),e.len-=F.unit.length;else if(G>=O&&x){var H=Math.round(G/O);c.logger.warn("Injecting "+H+" audio frame @ "+Math.round(x/90)/1e3+"s due to "+Math.round(G/90)+" ms gap.");for(var j=0;j<H;j++)A=x+L,A=Math.max(A,L),T=s.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount),T||(c.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),T=F.unit.subarray()),M.splice(U,0,{unit:T,pts:A,dts:A}),e.len+=T.length,x+=O,U+=1;F.pts=F.dts=x+L,x+=O,U+=1}else Math.abs(G)>.1*O,x+=O,0===U?F.pts=F.dts=L+R:F.pts=F.dts=M[U-1].pts+O,U+=1}for(var W=0,V=M.length;W<V;W++){if(a=M[W],u=a.unit,g=a.pts-L,m=a.dts-L,void 0!==E)y=P(g,E),S=P(m,E),o.duration=Math.round((S-E)/w);else{y=P(g,R),S=P(m,R);var K=Math.round(1e3*(y-R)/D),q=0;if(n&&e.isAAC&&K){if(K>0)q=Math.round((y-R)/O),c.logger.log(K+" ms hole between AAC samples detected,filling it"),q>0&&(T=s.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount),T||(T=u.subarray()),e.len+=q*T.length);else if(K<-12){c.logger.log(-K+" ms overlapping between AAC samples detected, drop frame"),e.len-=u.byteLength;continue}y=S=R}if(p=Math.max(0,y),v=Math.max(0,S),!(e.len>0))return;var Y=I?e.len:e.len+8;try{d=new Uint8Array(Y)}catch(e){return void this.observer.trigger(l.default.ERROR,{type:h.ErrorTypes.MUX_ERROR,level:this.level,id:this.id,details:h.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:Y,reason:"fail allocating audio mdat "+Y})}I||(i=new DataView(d.buffer),i.setUint32(0,Y),d.set(f.default.types.mdat,4));for(var X=0;X<q;X++)A=y-(q-X)*O,T=s.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount),T||(c.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),T=u.subarray()),d.set(T,k),k+=T.byteLength,o={size:T.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},N.push(o)}d.set(u,k);var z=u.byteLength;k+=z,o={size:z,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},N.push(o),E=S}var Q=0,Z=N.length;if(Z>=2&&(Q=N[Z-2].duration,o.duration=Q),Z){this.nextAudioPts=y+w*Q,e.len=0,e.samples=N,_=I?new Uint8Array:f.default.moof(e.sequenceNumber++,v/w,e),e.samples=[];var $={id:this.id,level:this.level,sn:this.sn,data1:_,data2:d,startPTS:p/D,endPTS:this.nextAudioPts/D,startDTS:v/D,endDTS:(S+w*Q)/D,type:"audio",nb:Z};return this.observer.trigger(l.default.FRAG_PARSING_DATA,$),$}return null}},{key:"remuxEmptyAudio",value:function(e,t,n,r){var i=this.PES_TIMESCALE,a=e.timescale?e.timescale:e.audiosamplerate,o=i/a,u=this.nextAudioPts,l=(void 0!==u?u:r.startDTS*i)+this._initDTS,d=r.endDTS*i+this._initDTS,f=1024,h=o*f,_=Math.ceil((d-l)/h),p=s.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(c.logger.warn("remux empty Audio"),!p)return void c.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!");for(var v=[],E=0;E<_;E++){var g=l+E*h;v.push({unit:p,pts:g,dts:g}),e.len+=p.length}e.samples=v,this.remuxAudio(e,t,n)}},{key:"remuxID3",value:function(e,t){var n,r=e.samples.length;if(r){for(var i=0;i<r;i++)n=e.samples[i],n.pts=(n.pts-this._initPTS)/this.PES_TIMESCALE,n.dts=(n.dts-this._initDTS)/this.PES_TIMESCALE;this.observer.trigger(l.default.FRAG_PARSING_METADATA,{id:this.id,level:this.level,sn:this.sn,samples:e.samples})}e.samples=[],t=t}},{key:"remuxText",value:function(e,t){e.samples.sort(function(e,t){return e.pts-t.pts});var n,r=e.samples.length;if(r){for(var i=0;i<r;i++)n=e.samples[i],n.pts=(n.pts-this._initPTS)/this.PES_TIMESCALE;this.observer.trigger(l.default.FRAG_PARSING_USERDATA,{id:this.id,level:this.level,sn:this.sn,samples:e.samples})}e.samples=[],t=t}},{key:"_PTSNormalize",value:function(e,t){var n;if(void 0===t)return e;for(n=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=n;return e}},{key:"passthrough",get:function(){return!1}}]),e}();n.default=_},{26:26,28:28,29:29,37:37,45:45}],39:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e(28),s=r(o),u=function(){function e(t,n){i(this,e),this.observer=t,this.id=n,this.ISGenerated=!1}return a(e,[{key:"destroy",value:function(){}},{key:"insertDiscontinuity",value:function(){}},{key:"switchLevel",value:function(){this.ISGenerated=!1}},{key:"remux",value:function(e,t,n,r,i,a){var o=this.observer;if(!this.ISGenerated){var u={},l={id:this.id,tracks:u,unique:!0},c=t,d=c.codec;d&&(l.tracks.video={container:c.container,codec:d,metadata:{width:c.width,height:c.height}}),c=e,d=c.codec,d&&(l.tracks.audio={container:c.container,codec:d,metadata:{channelCount:c.channelCount}}),this.ISGenerated=!0,o.trigger(s.default.FRAG_PARSING_INIT_SEGMENT,l)}o.trigger(s.default.FRAG_PARSING_DATA,{id:this.id,data1:a,startPTS:i,startDTS:i,type:"audiovideo",nb:1,dropped:0})}},{key:"passthrough",get:function(){return!0}}]),e}();n.default=u},{28:28}],40:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=/^(\d+)x(\d+)$/,o=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,s=function(){function e(t){r(this,e),"string"==typeof t&&(t=e.parseAttrList(t));for(var n in t)t.hasOwnProperty(n)&&(this[n]=t[n])}return i(e,[{key:"decimalInteger",value:function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"hexadecimalInteger",value:function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var n=new Uint8Array(t.length/2),r=0;r<t.length/2;r++)n[r]=parseInt(t.slice(2*r,2*r+2),16);return n}return null}},{key:"hexadecimalIntegerAsNumber",value:function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"decimalFloatingPoint",value:function(e){return parseFloat(this[e])}},{key:"enumeratedString",value:function(e){return this[e]}},{key:"decimalResolution",value:function(e){var t=a.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}}],[{key:"parseAttrList",value:function(e){var t,n={};for(o.lastIndex=0;null!==(t=o.exec(e));){var r=t[2],i='"';0===r.indexOf(i)&&r.lastIndexOf(i)===r.length-1&&(r=r.slice(1,-1)),n[t[1]]=r}return n}}]),e}();n.default=s},{}],41:[function(e,t,n){"use strict";var r={search:function(e,t){for(var n=0,r=e.length-1,i=null,a=null;n<=r;){i=(n+r)/2|0,a=e[i];var o=t(a);if(o>0)n=i+1;else{if(!(o<0))return a;r=i-1}}return null}};t.exports=r},{}],42:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},o=function(e){var t=e;return a.hasOwnProperty(e)&&(t=a[e]),String.fromCharCode(t)},s=15,u=32,l={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},c={17:2,18:4,21:6,22:8,23:10,19:13,20:15},d={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},f={25:2,26:4,29:6,30:8,31:10,27:13,28:15},h=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],_={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){var n=this.verboseFilter[e];this.verboseLevel>=n}},p=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toString(16));return t},v=function(){function e(t,n,i,a,o){r(this,e),this.foreground=t||"white",this.underline=n||!1,this.italics=i||!1,this.background=a||"black",this.flash=o||!1}return i(e,[{key:"reset",value:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}},{key:"setStyles",value:function(e){for(var t=["foreground","underline","italics","background","flash"],n=0;n<t.length;n++){var r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}}},{key:"isDefault",value:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}},{key:"equals",value:function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}},{key:"copy",value:function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}},{key:"toString",value:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}]),e}(),E=function(){function e(t,n,i,a,o,s){r(this,e),this.uchar=t||" ",this.penState=new v(n,i,a,o,s)}return i(e,[{key:"reset",value:function(){this.uchar=" ",this.penState.reset()}},{key:"setChar",value:function(e,t){this.uchar=e,this.penState.copy(t)}},{key:"setPenState",value:function(e){this.penState.copy(e)}},{key:"equals",value:function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}},{key:"copy",value:function(e){this.uchar=e.uchar,this.penState.copy(e.penState)}},{key:"isEmpty",value:function(){return" "===this.uchar&&this.penState.isDefault()}}]),e}(),g=function(){function e(){r(this,e),this.chars=[];for(var t=0;t<u;t++)this.chars.push(new E);this.pos=0,this.currPenState=new v}return i(e,[{key:"equals",value:function(e){for(var t=!0,n=0;n<u;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t}},{key:"copy",value:function(e){for(var t=0;t<u;t++)this.chars[t].copy(e.chars[t])}},{key:"isEmpty",value:function(){for(var e=!0,t=0;t<u;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}},{key:"setCursor",value:function(e){this.pos!==e&&(this.pos=e),this.pos<0?(_.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>u&&(_.log("ERROR","Too large cursor position "+this.pos),this.pos=u)}},{key:"moveCursor",value:function(e){var t=this.pos+e;if(e>1)for(var n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}},{key:"backSpace",value:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}},{key:"insertChar",value:function(e){e>=144&&this.backSpace();var t=o(e);return this.pos>=u?void _.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),void this.moveCursor(1))}},{key:"clearFromPos",value:function(e){var t;for(t=e;t<u;t++)this.chars[t].reset()}},{key:"clear",value:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}},{key:"clearToEndOfRow",value:function(){this.clearFromPos(this.pos)}},{key:"getTextString",value:function(){for(var e=[],t=!0,n=0;n<u;n++){var r=this.chars[n].uchar;" "!==r&&(t=!1),e.push(r)}return t?"":e.join("")}},{key:"setPenStyles",value:function(e){this.currPenState.setStyles(e);var t=this.chars[this.pos];t.setPenState(this.currPenState)}}]),e}(),m=function(){function e(){r(this,e),this.rows=[];for(var t=0;t<s;t++)this.rows.push(new g);this.currRow=s-1,this.nrRollUpRows=null,this.reset()}return i(e,[{key:"reset",value:function(){for(var e=0;e<s;e++)this.rows[e].clear();this.currRow=s-1}},{key:"equals",value:function(e){for(var t=!0,n=0;n<s;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}},{key:"copy",value:function(e){for(var t=0;t<s;t++)this.rows[t].copy(e.rows[t])}},{key:"isEmpty",value:function(){for(var e=!0,t=0;t<s;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}},{key:"backSpace",value:function(){var e=this.rows[this.currRow];e.backSpace()}},{key:"clearToEndOfRow",value:function(){var e=this.rows[this.currRow];e.clearToEndOfRow()}},{key:"insertChar",value:function(e){var t=this.rows[this.currRow];t.insertChar(e)}},{key:"setPen",value:function(e){var t=this.rows[this.currRow];t.setPenStyles(e)}},{key:"moveCursor",value:function(e){var t=this.rows[this.currRow];t.moveCursor(e)}},{key:"setCursor",value:function(e){_.log("INFO","setCursor: "+e);var t=this.rows[this.currRow];t.setCursor(e)}},{key:"setPAC",value:function(e,t){_.log("INFO","pacData = "+JSON.stringify(e));var n=e.row-1;if(this.nrRollUpRows&&n<this.nrRollUpRows-1&&(n=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==n){for(var r=0;r<s;r++)this.rows[r].clear();var i=this.currRow+1-this.nrRollUpRows,a=t.rows[i].cueStartTime;if(a&&a<_.time)for(r=0;r<this.nrRollUpRows;r++)this.rows[n-this.nrRollUpRows+r+1].copy(t.rows[i+r])}this.currRow=n;var o=this.rows[this.currRow];if(null!==e.indent){var u=e.indent,l=Math.max(u-1,0);o.setCursor(e.indent),e.color=o.chars[l].penState.foreground}var c={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(c)}},{key:"setBkgData",value:function(e){_.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}},{key:"setRollUpRows",value:function(e){this.nrRollUpRows=e}},{key:"rollUp",value:function(){if(null===this.nrRollUpRows)return void _.log("DEBUG","roll_up but nrRollUpRows not set yet");_.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),_.log("INFO","Rolling up")}},{key:"getDisplayText",value:function(e){e=e||!1;for(var t=[],n="",r=-1,i=0;i<s;i++){var a=this.rows[i].getTextString();a&&(r=i+1,e?t.push("Row "+r+": '"+a+"'"):t.push(a.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n}},{key:"getTextAndFormat",value:function(){return this.rows}}]),e}(),y=function(){function e(t,n){r(this,e),this.chNr=t,this.outputFilter=n,this.mode=null,this.verbose=0,this.displayedMemory=new m,this.nonDisplayedMemory=new m,this.lastOutputScreen=new m,this.currRollUpRow=this.displayedMemory.rows[s-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}return i(e,[{key:"reset",value:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[s-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null}},{key:"getHandler",value:function(){return this.outputFilter}},{key:"setHandler",value:function(e){this.outputFilter=e}},{key:"setPAC",value:function(e){this.writeScreen.setPAC(e,this.lastOutputScreen)}},{key:"setBkgData",value:function(e){this.writeScreen.setBkgData(e)}},{key:"setMode",value:function(e){e!==this.mode&&(this.mode=e,_.log("INFO","MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset(),this.lastOutputScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}},{key:"insertChars",value:function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";_.log("INFO",n+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(_.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}},{key:"ccRCL",value:function(){_.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}},{key:"ccBS",value:function(){_.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}},{key:"ccAOF",value:function(){}},{key:"ccAON",value:function(){}},{key:"ccDER",value:function(){_.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}},{key:"ccRU",value:function(e){_.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}},{key:"ccFON",value:function(){_.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})}},{key:"ccRDC",value:function(){_.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}},{key:"ccTR",value:function(){_.log("INFO","TR"),this.setMode("MODE_TEXT")}},{key:"ccRTD",value:function(){_.log("INFO","RTD"),this.setMode("MODE_TEXT")}},{key:"ccEDM",value:function(){_.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()}},{key:"ccCR",value:function(){_.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()}},{key:"ccENM",value:function(){_.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}},{key:"ccEOC",value:function(){if(_.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,_.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()}},{key:"ccTO",value:function(e){_.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}},{key:"ccMIDROW",value:function(e){var t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{var n=Math.floor(e/2)-16,r=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=r[n]}_.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}},{key:"outputDataUpdate",value:function(){var e=_.time;null!==e&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(e,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))}},{key:"cueSplitAtTime",value:function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}]),e}(),S=function(){function e(t,n,i){r(this,e),this.field=t||1,this.outputs=[n,i],this.channels=[new y(1,n),new y(2,i)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}}return i(e,[{key:"getHandler",value:function(e){return this.channels[e].getHandler()}},{key:"setHandler",value:function(e,t){this.channels[e].setHandler(t)}},{key:"addData",value:function(e,t){var n,r,i,a=!1;this.lastTime=e,_.setTime(e);for(var o=0;o<t.length;o+=2)if(r=127&t[o],i=127&t[o+1],0!==r||0!==i){if(_.log("DATA","["+p([t[o],t[o+1]])+"] -> ("+p([r,i])+")"),n=this.parseCmd(r,i),n||(n=this.parseMidrow(r,i)),n||(n=this.parsePAC(r,i)),n||(n=this.parseBackgroundAttributes(r,i)),!n&&(a=this.parseChars(r,i)))if(this.currChNr&&this.currChNr>=0){var s=this.channels[this.currChNr-1];s.insertChars(a)}else _.log("WARNING","No channel found yet. TEXT-MODE?");n?this.dataCounters.cmd+=2:a?this.dataCounters.char+=2:(this.dataCounters.other+=2,_.log("WARNING","Couldn't parse cleaned data "+p([r,i])+" orig: "+p([t[o],t[o+1]])))}else this.dataCounters.padding+=2}},{key:"parseCmd",value:function(e,t){var n=null,r=(20===e||28===e)&&32<=t&&t<=47,i=(23===e||31===e)&&33<=t&&t<=35;if(!r&&!i)return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,_.log("DEBUG","Repeated command ("+p([e,t])+") is dropped"),!0;n=20===e||23===e?1:2;var a=this.channels[n-1];return 20===e||28===e?32===t?a.ccRCL():33===t?a.ccBS():34===t?a.ccAOF():35===t?a.ccAON():36===t?a.ccDER():37===t?a.ccRU(2):38===t?a.ccRU(3):39===t?a.ccRU(4):40===t?a.ccFON():41===t?a.ccRDC():42===t?a.ccTR():43===t?a.ccRTD():44===t?a.ccEDM():45===t?a.ccCR():46===t?a.ccENM():47===t&&a.ccEOC():a.ccTO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0}},{key:"parseMidrow",value:function(e,t){var n=null;if((17===e||25===e)&&32<=t&&t<=47){if(n=17===e?1:2,n!==this.currChNr)return _.log("ERROR","Mismatch channel in midrow parsing"),!1;var r=this.channels[n-1];return r.ccMIDROW(t),_.log("DEBUG","MIDROW ("+p([e,t])+")"),!0}return!1}},{key:"parsePAC",value:function(e,t){var n=null,r=null,i=(17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127,a=(16===e||24===e)&&64<=t&&t<=95;if(!i&&!a)return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,!0;n=e<=23?1:2,r=64<=t&&t<=95?1===n?l[e]:d[e]:1===n?c[e]:f[e];var o=this.interpretPAC(r,t),s=this.channels[n-1];return s.setPAC(o),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0}},{key:"interpretPAC",value:function(e,t){var n=t,r={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,r.underline=1===(1&n),n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((n-16)/2),r}},{key:"parseChars",value:function(e,t){var n=null,r=null,i=null;if(e>=25?(n=2,i=e-8):(n=1,i=e),17<=i&&i<=19){var a=t;a=17===i?t+80:18===i?t+112:t+144,_.log("INFO","Special char '"+o(a)+"' in channel "+n),r=[a]}else 32<=e&&e<=127&&(r=0===t?[e]:[e,t]);if(r){var s=p(r);_.log("DEBUG","Char codes =  "+s.join(",")),this.lastCmdA=null,this.lastCmdB=null}return r}},{key:"parseBackgroundAttributes",value:function(e,t){var n,r,i,a,o=(16===e||24===e)&&32<=t&&t<=47,s=(23===e||31===e)&&45<=t&&t<=47;return!(!o&&!s)&&(n={},16===e||24===e?(r=Math.floor((t-32)/2),n.background=h[r],t%2===1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0)),i=e<24?1:2,a=this.channels[i-1],a.setBkgData(n),this.lastCmdA=null,this.lastCmdB=null,!0)}},{key:"reset",value:function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null}},{key:"cueSplitAtTime",value:function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)}}]),e}();n.default=S},{}],43:[function(e,t,n){"use strict";var r={newCue:function(e,t,n,r){for(var i,a,o,s,u,l=window.VTTCue||window.TextTrackCue,c=0;c<r.rows.length;c++)if(i=r.rows[c],o=!0,s=0,u="",!i.isEmpty()){for(var d=0;d<i.chars.length;d++)i.chars[d].uchar.match(/\s/)&&o?s++:(u+=i.chars[d].uchar,o=!1);i.cueStartTime=t,a=new l(t,n,u.trim()),s>=16?s--:s++,navigator.userAgent.match(/Firefox\//)?a.line=c+1:a.line=c>7?c-2:c+1,a.align="left",a.position=Math.max(0,Math.min(100,100*(s/32)+(navigator.userAgent.match(/Firefox\//)?50:0))),e.addCue(a)}}};t.exports=r},{}],44:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t){r(this,e),this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=0,this.totalWeight_=0}return i(e,[{key:"sample",value:function(e,t){var n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}},{key:"getTotalWeight",value:function(){return this.totalWeight_}},{key:"getEstimate",value:function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_}}]),e}();n.default=a},{}],45:[function(e,t,n){"use strict";function r(){}function i(e,t){return t="["+e+"] > "+t}function a(e){var t=self.console[e];return t?function(){for(var n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];r[0]&&(r[0]=i(e,r[0])),t.apply(self.console,r)}:r}function o(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.forEach(function(t){l[t]=e[t]?e[t].bind(e):a(t)})}Object.defineProperty(n,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u={trace:r,debug:r,log:r,warn:r,info:r,error:r},l=u;n.enableLogs=function(e){if(e===!0||"object"===("undefined"==typeof e?"undefined":s(e))){o(e,"debug","log","info","warn","error");try{l.log()}catch(e){l=u}}else l=u},n.logger=l},{}],46:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(){r(this,e)}return i(e,null,[{key:"toString",value:function(e){for(var t="",n=e.length,r=0;r<n;r++)t+="["+e.start(r).toFixed(3)+","+e.end(r).toFixed(3)+"]";return t}}]),e}();n.default=a},{}],47:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=e(45),o=function(){function e(t){r(this,e),t&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}return i(e,[{key:"destroy",value:function(){this.abort(),this.loader=null}},{key:"abort",value:function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null}},{key:"load",value:function(e,t,n){this.context=e,this.config=t,this.callbacks=n,this.stats={trequest:performance.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()}},{key:"loadInternal",value:function(){var e,t=this.context;e="undefined"!=typeof XDomainRequest?this.loader=new XDomainRequest:this.loader=new XMLHttpRequest,e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.open("GET",t.url,!0),t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.responseType=t.responseType;var n=this.stats;n.tfirst=0,n.loaded=0,this.xhrSetup&&this.xhrSetup(e,t.url),this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()}},{key:"readystatechange",value:function(e){var t=e.currentTarget,n=t.readyState,r=this.stats,i=this.context,o=this.config;
            if(!r.aborted&&n>=2)if(window.clearTimeout(this.requestTimeout),0===r.tfirst&&(r.tfirst=Math.max(performance.now(),r.trequest)),4===n){var s=t.status;if(s>=200&&s<300){r.tload=Math.max(r.tfirst,performance.now());var u=void 0,l=void 0;"arraybuffer"===i.responseType?(u=t.response,l=u.byteLength):(u=t.responseText,l=u.length),r.loaded=r.total=l;var c={url:t.responseURL,data:u};this.callbacks.onSuccess(c,r,i)}else r.retry>=o.maxRetry||s>=400&&s<499?(a.logger.error(s+" while loading "+i.url),this.callbacks.onError({code:s,text:t.statusText},i)):(a.logger.warn(s+" while loading "+i.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,o.maxRetryDelay),r.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),o.timeout)}},{key:"loadtimeout",value:function(){a.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context)}},{key:"loadprogress",value:function(e){var t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total);var n=this.callbacks.onProgress;n&&n(t,this.context,null)}}]),e}();n.default=o},{45:45}]},{},[33])(33)})},function(e,t,n){function r(e,t,n){var r=n.length;switch(r){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function i(e,t,n,r){return void 0===e||a(e,u[n])&&!l.call(r,n)?t:e}function a(e,t){return e===t||e!==e&&t!==t}var o=n(5),s=n(20),u=Object.prototype,l=u.hasOwnProperty,c=s(function(e){return e.push(void 0,i),r(o,void 0,e)});e.exports=c},function(e,t){function n(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function r(e,t){return t=A(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,a=A(r.length-t,0),o=Array(a);++i<a;)o[i]=r[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=r[i];return s[t]=o,n(e,this,s)}}function i(e,t){if("function"!=typeof e)throw new TypeError(d);return t=void 0===t?t:l(t),r(e,t)}function a(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function o(e){return!!e&&"object"==typeof e}function s(e){return"symbol"==typeof e||o(e)&&T.call(e)==p}function u(e){if(!e)return 0===e?e:0;if(e=c(e),e===f||e===-f){var t=e<0?-1:1;return t*h}return e===e?e:0}function l(e){var t=u(e),n=t%1;return t===t?n?t-n:t:0}function c(e){if("number"==typeof e)return e;if(s(e))return _;if(a(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=a(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(v,"");var n=g.test(e);return n||m.test(e)?y(e.slice(2),n?2:8):E.test(e)?_:+e}var d="Expected a function",f=1/0,h=1.7976931348623157e308,_=NaN,p="[object Symbol]",v=/^\s+|\s+$/g,E=/^[-+]0x[0-9a-f]+$/i,g=/^0b[01]+$/i,m=/^0o[0-7]+$/i,y=parseInt,S=Object.prototype,T=S.toString,A=Math.max;e.exports=i},function(e,t){!function(n,r){"object"==typeof t&&"object"==typeof e?e.exports=r(): true?!(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_FACTORY__ = (r),
            __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
                (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),
        __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)):"object"==typeof t?t.Downloader=r():(n.Streamroot=n.Streamroot||{},n.Streamroot.Downloader=r())}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=187)}([function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,n){"use strict";t.__esModule=!0;var r=n(244),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,i.default)(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={ChunkManager:{CHUNK_DOWNLOADED:"chunkDownloaded"},Config:{CONFIG_UPDATED:"configUpdated"},Distributor:{READY:"DISTRIBUTOR_READY"},Metrics:{TRACK_SWITCH:"metricsTrackSwitch"},Media:{ENDED:"mediaEnded"},Scheduler:{REACHED_LIVE_EDGE_STATE_CHANGED:"schedulerReachedLiveEdgeStateChanged"},SRModuleInterface:{ABR_FEEDBACK:"srModuleInterfaceAbrFeedback",UNCOMPLETE_SEGMENT_REQUESTED:"srmoduleinterfaceUncompleteSegmentRequested",SEGMENT_TRANSFERED_TO_MEDIA_ENGINE:"segmentTransferedToMediaEngine"},PeerPool:{PEER_OPEN:"peerpoolPeerOpen",PEER_DESTROYED:"peerpoolPeerDestroyed",PEER_STATS_UPDATE:"peerPoolStat",START_ASKING_PEERS:"startAskingPeers",STOP_ASKING_PEERS:"stopAskingPeers"},BufferManager:{LOW_BUFFER:"buffermanagerLowBuffer",HIGH_BUFFER:"buffermanagerHighBuffer",STATE_CHANGED:"buffermanagerStateChanged"},PeerConnection:{DISCONNECTED:"peerConnectionDisconnected",MESSAGE_RECEIVED:"peerConnectionMessageReceived",BINARY_DATA_RECEIVED:"peerConnectionBinaryDataReceived"},Peer:{PEER_DISCONNECTED:"PeerDisconnected"},UploadQueue:{CHUNK_REQUESTED:"chunkRequested"},P2PCache:{REMOVE_SEGMENT_FROM_CACHE:"removeSegmentFromCache",ATTEMPTED_GC_TRACK_EDGE_FROM_CACHE:"attemptedGCTrackEdgeFromCache"},BufferedAmountObserver:{BUFFER_CHECK:"bufferCheck"},Tracker:{PERM_TRACKER_DISCONNECTION_REQUEST:"permTrackerDisconnectionRequest",TEMP_TRACKER_DISCONNECTION_REQUEST:"tempTrackerDisconnectionRequest",TRACKER_RECONNECTION_REQUEST:"trackerReconnectionRequest"},TrafficAnalytics:{STOP_SENDING_USAGE:"stopSendingUsage",RESTART_SENDING_USAGE:"restartSendingUsage"},Signaling:{PERM_SIGNALING_DISCONNECTION_REQUEST:"permSignalingDisconnectionRequest",TEMP_SIGNALING_DISCONNECTION_REQUEST:"tempSignalingDisconnectionRequest",SIGNALING_RECONNECTION_REQUEST:"signalingReconnectionRequest"}},e.exports=t.default},function(e,t){var n=e.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)},function(e,t,n){"use strict";function r(e,t){return new o(e,t,a.TIMER_TYPE.INTERVAL)}function i(e,t){return new o(e,t,a.TIMER_TYPE.TIMEOUT)}Object.defineProperty(t,"__esModule",{value:!0}),t.createInterval=r,t.createTimeout=i;var a=n(101),o=void 0;o=n(237)},function(e,t,n){"use strict";e.exports=n(168)},function(e,t,n){var r=n(12),i=n(3),a=n(22),o=n(23),s=function(e,t,n){var u,l,c,d=e&s.F,f=e&s.G,h=e&s.S,_=e&s.P,p=e&s.B,v=e&s.W,E=f?i:i[t]||(i[t]={}),g=E.prototype,m=f?r:h?r[t]:(r[t]||{}).prototype;f&&(n=t);for(u in n)(l=!d&&m&&void 0!==m[u])&&u in E||(c=l?m[u]:n[u],E[u]=f&&"function"!=typeof m[u]?n[u]:p&&l?a(c,r):v&&m[u]==c?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(c):_&&"function"==typeof c?a(Function.call,c):c,_&&((E.virtual||(E.virtual={}))[u]=c,e&s.R&&g&&!g[u]&&o(g,u,c)))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,e.exports=s},function(e,t,n){e.exports={default:n(269),__esModule:!0}},function(e,t,n){e.exports={default:n(255),__esModule:!0}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var i=n(248),a=r(i),o=n(242),s=r(o),u=n(31),l=r(u);t.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,l.default)(t)));e.prototype=(0,s.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(a.default?(0,a.default)(e,t):e.__proto__=t)}},function(e,t,n){"use strict";t.__esModule=!0;var r=n(31),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,i.default)(t))&&"function"!=typeof t?e:t}},function(e,t,n){var r=n(78)("wks"),i=n(59),a=n(12).Symbol,o="function"==typeof a;(e.exports=function(e){return r[e]||(r[e]=o&&a[e]||(o?a:i)("Symbol."+e))}).store=r},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){e.exports=!n(25)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(19),i=n(111),a=n(80),o=Object.defineProperty;t.f=n(14)?Object.defineProperty:function(e,t,n){if(r(e),t=a(t,!0),r(n),i)try{return o(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){e.exports={default:n(258),__esModule:!0}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){return"number"==typeof e&&!isNaN(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.isNumeric=t.Delta=void 0;var a=n(0),o=r(a),s=n(1),u=r(s),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;(0,o.default)(this,e),this._lastDeltaValue=t}return(0,u.default)(e,[{key:"calcDelta",value:function(e){var t=e-this._lastDeltaValue;return this._lastDeltaValue=e,t}}]),e}();t.Delta=l,t.isNumeric=i},function(e,t,n){e.exports={default:n(262),__esModule:!0}},function(e,t,n){var r=n(13);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){var r=n(72),i=n(54);e.exports=function(e){return r(i(e))}},function(e,t,n){"use strict";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function a(){this._events=new r,this._eventsCount=0}var o=Object.prototype.hasOwnProperty,s="~";Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(s=!1)),a.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)o.call(e,t)&&n.push(s?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},a.prototype.listeners=function(e,t){var n=s?s+e:e,r=this._events[n];if(t)return!!r;if(!r)return[];if(r.fn)return[r.fn];for(var i=0,a=r.length,o=new Array(a);i<a;i++)o[i]=r[i].fn;return o},a.prototype.emit=function(e,t,n,r,i,a){var o=s?s+e:e;if(!this._events[o])return!1;var u,l,c=this._events[o],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,r),!0;case 5:return c.fn.call(c.context,t,n,r,i),!0;case 6:return c.fn.call(c.context,t,n,r,i,a),!0}for(l=1,u=new Array(d-1);l<d;l++)u[l-1]=arguments[l];c.fn.apply(c.context,u)}else{var f,h=c.length;for(l=0;l<h;l++)switch(c[l].once&&this.removeListener(e,c[l].fn,void 0,!0),d){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,t);break;case 3:c[l].fn.call(c[l].context,t,n);break;case 4:c[l].fn.call(c[l].context,t,n,r);break;default:if(!u)for(f=1,u=new Array(d-1);f<d;f++)u[f-1]=arguments[f];c[l].fn.apply(c[l].context,u)}}return!0},a.prototype.on=function(e,t,n){var r=new i(t,n||this),a=s?s+e:e;return this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],r]:this._events[a].push(r):(this._events[a]=r,this._eventsCount++),this},a.prototype.once=function(e,t,n){var r=new i(t,n||this,!0),a=s?s+e:e;return this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],r]:this._events[a].push(r):(this._events[a]=r,this._eventsCount++),this},a.prototype.removeListener=function(e,t,n,i){var a=s?s+e:e;if(!this._events[a])return this;if(!t)return 0==--this._eventsCount?this._events=new r:delete this._events[a],this;var o=this._events[a];if(o.fn)o.fn!==t||i&&!o.once||n&&o.context!==n||(0==--this._eventsCount?this._events=new r:delete this._events[a]);else{for(var u=0,l=[],c=o.length;u<c;u++)(o[u].fn!==t||i&&!o[u].once||n&&o[u].context!==n)&&l.push(o[u]);l.length?this._events[a]=1===l.length?l[0]:l:0==--this._eventsCount?this._events=new r:delete this._events[a]}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=s?s+e:e,this._events[t]&&(0==--this._eventsCount?this._events=new r:delete this._events[t])):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prototype.setMaxListeners=function(){return this},a.prefixed=s,a.EventEmitter=a,e.exports=a},function(e,t,n){var r=n(68);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){var r=n(15),i=n(44);e.exports=n(14)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){"use strict";function r(e,t){return parseFloat(e.toFixed(t))}function i(e,t){for(var n=[],r=t>=e?1:-1,i=Math.min(e*r,t*r),a=Math.max(e*r,t*r),o=i;o<=a;o++)n.push(o*r);return n}function a(e,t,n){return Math.min(Math.max(e,t),n)}Object.defineProperty(t,"__esModule",{value:!0}),t.toDecimal=r,t.range=i,t.clamp=a},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(121),i=n(71);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){var r=n(6),i=n(3),a=n(25);e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],o={};o[e]=t(n),r(r.S+r.F*a(function(){n(1)}),"Object",o)}},function(e,t,n){"use strict";var r=n(298)(!0);n(73)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),a=r(i),o=n(16),s=r(o),u=n(0),l=r(u),c=n(1),d=r(c),f=n(5),h=r(f),_=function(){function e(){(0,l.default)(this,e),this._timers=new s.default}return(0,d.default)(e,[{key:"register",value:function(e){var t=e.name;return!this._timers.has(t)&&(this._timers.set(t,e),!0)}},{key:"registerAs",value:function(e,t){return!this._timers.has(e)&&(t.name=e,this._timers.set(e,t),!0)}},{key:"clear",value:function(e){return!!e&&this.clearNamedTimer(e.name)}},{key:"clearNamedTimer",value:function(e){var t=this._timers.get(e);return!!t&&(t.clear(),this._timers.delete(t.name))}},{key:"clearAll",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=(0,a.default)(this._timers.values());!(e=(r=i.next()).done);e=!0){var o=r.value;this.clear(o)||h.default.notify("Cannot remove timer","Timer "+o.id+" was not found in timers map.")}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}}]),e}();t.default=_,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var i=n(251),a=r(i),o=n(250),s=r(o),u="function"==typeof s.default&&"symbol"==typeof a.default?function(e){return typeof e}:function(e){return e&&"function"==typeof s.default&&e.constructor===s.default&&e!==s.default.prototype?"symbol":typeof e};t.default="function"==typeof s.default&&"symbol"===u(a.default)?function(e){return void 0===e?"undefined":u(e)}:function(e){return e&&"function"==typeof s.default&&e.constructor===s.default&&e!==s.default.prototype?"symbol":void 0===e?"undefined":u(e)}},function(e,t){e.exports={}},function(e,t,n){var r=n(54);e.exports=function(e){return Object(r(e))}},function(e,t,n){n(303);for(var r=n(12),i=n(23),a=n(32),o=n(11)("toStringTag"),s=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],u=0;u<5;u++){var l=s[u],c=r[l],d=c&&c.prototype;d&&!d[o]&&i(d,o,l),a[l]=a.Array}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u="Unvalid weight parameter for EMWA: must be an number in ]0,1[",l=function(){function e(t,n){if((0,a.default)(this,e),n<=0||n>=1)throw new Error(u);this._emwaValue=t,this._weight=n}return(0,s.default)(e,[{key:"update",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=null!==t?t:this._weight;this._emwaValue=(1-n)*this._emwaValue+n*e}},{key:"value",get:function(){return this._emwaValue}}],[{key:"Errors",value:function(){return{UNVALID_WEIGHT:u}}},{key:"fromHalfLife",value:function(t,n,r){return new e(t,this.halfLifeToEMAWeight(n,r))}},{key:"halfLifeToEMAWeight",value:function(e,t){var n=e/t;return 1-1/Math.pow(2,1/n)}}]),e}();t.default=l,e.exports=t.default},function(e,t,n){"use strict";function r(){var e=window&&window.navigator?window.navigator.userAgent:"";return(new o.default).setUA(e).getResult()}function i(){var e=r();return"mobile"===e.device.type||"tablet"===e.device.type||"console"===e.device.type||"Android"===e.os.name||"iOS"===e.os.name}Object.defineProperty(t,"__esModule",{value:!0});var a=n(333),o=function(e){return e&&e.__esModule?e:{default:e}}(a);t.default={getUAObject:r,isMobile:i},e.exports=t.default},function(e,t,n){e.exports={default:n(254),__esModule:!0}},function(e,t,n){e.exports={default:n(257),__esModule:!0}},function(e,t,n){e.exports={default:n(261),__esModule:!0}},function(e,t,n){"use strict";t.__esModule=!0;var r=n(37),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return(0,i.default)(e)}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var r=n(59)("meta"),i=n(13),a=n(26),o=n(15).f,s=0,u=Object.isExtensible||function(){return!0},l=!n(25)(function(){return u(Object.preventExtensions({}))}),c=function(e){o(e,r,{value:{i:"O"+ ++s,w:{}}})},d=function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!a(e,r)){if(!u(e))return"F";if(!t)return"E";c(e)}return e[r].i},f=function(e,t){if(!a(e,r)){if(!u(e))return!0;if(!t)return!1;c(e)}return e[r].w},h=function(e){return l&&_.NEED&&u(e)&&!a(e,r)&&c(e),e},_=e.exports={KEY:r,NEED:!1,fastKey:d,getWeak:f,onFreeze:h}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var r=n(15).f,i=n(26),a=n(11)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,a)&&r(e,a,{configurable:!0,value:t})}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n=e.prototype,r=!0,i=!1,o=void 0;try{for(var s,u=(0,h.default)(a(n));!(r=(s=u.next()).done);r=!0){var l=s.value;if((0,d.default)(t[l])!==(0,d.default)(n[l])){var c=t.constructor.name;throw new Error("The method "+l+" of "+e.name+" is not defined in "+c)}}}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}}function a(e){var t=(0,l.default)(e).filter(function(e){return"constructor"!==e}),n=Object.prototype;if((0,s.default)(e)===n)return t;var r=(0,s.default)(e);return t.concat(a(r))}Object.defineProperty(t,"__esModule",{value:!0}),t._getEveryPropertyNames=t.checkInterface=void 0;var o=n(7),s=r(o),u=n(103),l=r(u),c=n(31),d=r(c),f=n(8),h=r(f);t.checkInterface=i,t._getEveryPropertyNames=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.assertStreamType=t.StreamTypes=void 0;var i=n(249),a=r(i),o=n(51),s=r(o),u={HLS:"hls",DASH:"dash",SMOOTH:"smooth"};(0,s.default)(u);var l=function(e){if(-1===(0,a.default)(u).indexOf(e))throw new TypeError("'"+e+"' is not a valid value for stream type.")};t.StreamTypes=u,t.assertStreamType=l},function(e,t,n){"use strict";e.exports=n(171)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){return(0,S.default)(e,t)}function a(e){(0,m.default)(e);for(var t=(0,E.default)(e),n=0;n<t.length;n++){var r=t[n],i=e[r];null===i||"object"!==(void 0===i?"undefined":(0,p.default)(i))||(0,h.default)(i)||a(i)}}function o(e,t){for(var n={},r=(0,d.default)(e),i=0;i<r.length;i++){var a=r[i];t!==a&&(n[a]=e[a])}return n}function s(e){return JSON.parse((0,l.default)(e))}Object.defineProperty(t,"__esModule",{value:!0});var u=n(38),l=r(u),c=n(52),d=r(c),f=n(246),h=r(f),_=n(31),p=r(_),v=n(103),E=r(v),g=n(51),m=r(g),y=n(18),S=r(y);t.default={merge:i,deepFreeze:a,omit:o,deepCopy:s},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={SAFE:"safe",UNSAFE:"unsafe"};t.default=r,e.exports=t.default},function(e,t,n){e.exports={default:n(266),__esModule:!0}},function(e,t,n){e.exports={default:n(272),__esModule:!0}},function(e,t,n){var r=n(41),i=n(11)("toStringTag"),a="Arguments"==r(function(){return arguments}()),o=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,n,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=o(t=Object(e),i))?n:a?r(t):"Object"==(s=r(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var r=n(22),i=n(114),a=n(112),o=n(19),s=n(58),u=n(83),l={},c={},t=e.exports=function(e,t,n,d,f){var h,_,p,v,E=f?function(){return e}:u(e),g=r(n,d,t?2:1),m=0;if("function"!=typeof E)throw TypeError(e+" is not iterable!");if(a(E)){for(h=s(e.length);h>m;m++)if((v=t?g(o(_=e[m])[0],_[1]):g(e[m]))===l||v===c)return v}else for(p=E.call(e);!(_=p.next()).done;)if((v=i(p,g,_.value,t))===l||v===c)return v};t.BREAK=l,t.RETURN=c},function(e,t){e.exports=!0},function(e,t,n){var r=n(19),i=n(117),a=n(71),o=n(77)("IE_PROTO"),s=function(){},u=function(){var e,t=n(70)("iframe"),r=a.length;for(t.style.display="none",n(110).appendChild(t),t.src="javascript:",e=t.contentWindow.document,e.open(),e.write("<script>document.F=Object<\/script>"),e.close(),u=e.F;r--;)delete u.prototype[a[r]];return u()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=r(e),n=new s,s.prototype=null,n[o]=e):n=u(),void 0===t?n:i(n,t)}},function(e,t,n){var r=n(79),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t){},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(){(0,a.default)(this,e)}return(0,s.default)(e,[{key:"isEqual",value:function(e){return!0}},{key:"viewToString",value:function(){return""}},{key:"toArrayBuffer",value:function(){return new ArrayBuffer(0)}},{key:"isInTrack",value:function(e){return!1}},{key:"getId",value:function(){return 0}}],[{key:"fromArrayBuffer",value:function(t){return new e}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(38),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),c=n(160),d=r(c),f=n(236),h=r(f),_=function(){function e(t,n){(0,s.default)(this,e),this._sharedState=t,this._namespace=n}return(0,l.default)(e,[{key:"send",value:function(e,t){var n=this._sharedState,r=n.conf,i=n.moduleState,o=n.peerToken,s=r.ANALYTICS.KLARA_URL;e.customer=r.ID_CLIENT,e.content=i.content,e.peerAgentVersion="4.10.14",e.token=o,e.platform=h.default.get();var u=(0,a.default)(e),l=""+s+this._namespace;t&&(l+="/"+t),d.default.send(l,u,this._sharedState)}}]),e}();t.default=_,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u="Method not implemented",l=function(){function e(){(0,a.default)(this,e)}return(0,s.default)(e,[{key:"getUpdatedRange",value:function(e){throw new Error(u)}},{key:"getFullSegment",value:function(e,t,n){throw new Error(u)}},{key:"isComplete",value:function(){throw new Error(u)}},{key:"isLocked",value:function(){throw new Error(u)}},{key:"p2pSpeed",get:function(){throw new Error(u)}},{key:"p2pAmount",get:function(){throw new Error(u)}}]),e}();t.default=l,e.exports=t.default},function(e,t,n){"use strict";function r(e){if(null===e)throw new Error("Panic! Attempted to unwrap null");if(void 0===e)throw new Error("Panic! Attempted to unwrap undefined");return e}Object.defineProperty(t,"__esModule",{value:!0}),t.unwrap=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(t){(0,a.default)(this,e),this._expirationThreshold=t,this._values=[]}return(0,s.default)(e,[{key:"push",value:function(e){this._cleanExpiredValues(),this._values.push({time:Date.now(),value:e})}},{key:"_cleanExpiredValues",value:function(){for(var e=Date.now();this._values.length>0&&e-this._expirationThreshold>=this._values[0].time;)this._values.shift()}},{key:"subDelta",value:function(e){if(this._cleanExpiredValues(),e>this._expirationThreshold)return null;for(var t=Date.now()-e,n=0;n<this._values.length&&this._values[n].time<=t;)n++;return n<this._values.length-1?this._values[this._values.length-1].value-this._values[n].value:null}},{key:"subTimeDelta",value:function(e){if(this._cleanExpiredValues(),e>this._expirationThreshold)return null;for(var t=Date.now()-e,n=0;n<this._values.length&&this._values[n].time<=t;)n++;return n<this._values.length-1?this._values[this._values.length-1].time-this._values[n].time:null}},{key:"delta",get:function(){return this._cleanExpiredValues(),this._values.length>1?this._values[this._values.length-1].value-this._values[0].value:null}},{key:"timeDelta",get:function(){return this._cleanExpiredValues(),this._values.length>1?this._values[this._values.length-1].time-this._values[0].time:null}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(17),l=function(){function e(){(0,a.default)(this,e);var t=Date.now();this._metricSum=0,this._latestValue=0,this._integralTimestampDelta=new u.Delta(t),this._getterTimestampDelta=new u.Delta(t)}return(0,s.default)(e,[{key:"getAverage",value:function(){var e=this.getIntegral();return e.intervalLength?e.value/e.intervalLength:e.value}},{key:"getIntegral",value:function(){var e=Date.now(),t=this._integralTimestampDelta.calcDelta(e),n=this._getterTimestampDelta.calcDelta(e);this._metricSum+=this._latestValue*t;var r=this._metricSum;return this._metricSum=0,{value:r,intervalLength:n}}},{key:"updateMetric",value:function(e){var t=Date.now(),n=this._integralTimestampDelta.calcDelta(t);this._metricSum+=this._latestValue*n,this._latestValue=e}}]),e}();t.default=l,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var i=n(240),a=r(i),o=n(8),s=r(o);t.default=function(){function e(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=(0,s.default)(e);!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if((0,a.default)(Object(t)))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(13),i=n(12).document,a=r(i)&&r(i.createElement);e.exports=function(e){return a?i.createElement(e):{}}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var r=n(41);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){"use strict";var r=n(56),i=n(6),a=n(122),o=n(23),s=n(26),u=n(32),l=n(290),c=n(45),d=n(120),f=n(11)("iterator"),h=!([].keys&&"next"in[].keys()),_=function(){return this};e.exports=function(e,t,n,p,v,E,g){l(n,t,p);var m,y,S,T=function(e){if(!h&&e in C)return C[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},A=t+" Iterator",R="values"==v,D=!1,C=e.prototype,w=C[f]||C["@@iterator"]||v&&C[v],b=w||T(v),O=v?R?T("entries"):b:void 0,P="Array"==t?C.entries||w:w;if(P&&(S=d(P.call(new e)))!==Object.prototype&&(c(S,A,!0),r||s(S,f)||o(S,f,_)),R&&w&&"values"!==w.name&&(D=!0,b=function(){return w.call(this)}),r&&!g||!h&&!D&&C[f]||o(C,f,b),u[t]=b,u[A]=_,v)if(m={values:R?b:T("values"),keys:E?b:T("keys"),entries:O},g)for(y in m)y in C||a(C,y,m[y]);else i(i.P+i.F*(h||D),t,m);return m}},function(e,t,n){var r=n(43),i=n(44),a=n(20),o=n(80),s=n(26),u=n(111),l=Object.getOwnPropertyDescriptor;t.f=n(14)?l:function(e,t){if(e=a(e),t=o(t,!0),u)try{return l(e,t)}catch(e){}if(s(e,t))return i(!r.f.call(e,t),e[t])}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(23);e.exports=function(e,t,n){for(var i in t)n&&e[i]?e[i]=t[i]:r(e,i,t[i]);return e}},function(e,t,n){var r=n(78)("keys"),i=n(59);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t,n){var r=n(12),i=r["__core-js_shared__"]||(r["__core-js_shared__"]={});e.exports=function(e){return i[e]||(i[e]={})}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(13);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var r=n(12),i=n(3),a=n(56),o=n(82),s=n(15).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=a?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:o.f(e)})}},function(e,t,n){t.f=n(11)},function(e,t,n){var r=n(53),i=n(11)("iterator"),a=n(32);e.exports=n(3).getIteratorMethod=function(e){if(void 0!=e)return e[i]||e["@@iterator"]||a[r(e)]}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";function r(){var e=s.default.getUAObject();if(!e.ua)return!1;var t=e.browser;return"Edge"===t.name||"Safari"===t.name||"Mobile Safari"===t.name}function i(){return!!(window.RTCPeerConnection||window.webkitPeerConnection00||window.webkitRTCPeerConnection)}function a(e){return!(!(i()&&e.ALLOW_P2P&&e.CONTENT_ACTIVATED)||r())&&(!s.default.isMobile()||e.ENABLE_MOBILE_BROWSER)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(36),s=function(e){return e&&e.__esModule?e:{default:e}}(o);t.default={isP2PAvailable:i,isP2PEnabled:a},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(102),a=r(i),o=n(49),s=r(o),u={BACKEND_USE_SSL:!0,TRACKER_URL:"",SIGNALING_URL:"",FALLBACK_URLS:{KLARA_URL:"https://klara.streamroot.io"},DISTRIBUTOR:{URL:"https://distributor.streamroot.io",OVERRIDDEN:!1,TIMEOUT_DELAY:1e4,MAX_RETRY:1},SIGNALING_DELAY_STEP:1e4,SIGNALING_DELAY_MAX:3e5,SIGNALING_DELAY_MAX_INITIAL:3e4,TRACKER_DELAY_MAX:3e5,TRACKER_DELAY_INIT:2e3,
            MAX_NUMBER_OF_PEERS_ASKED_BY_GET_PEERS_MESSAGE:10,ASK_PEERS_INTERVAL:6e4,ASK_PEERS_AFTER_TRACK_SWITCH_INTERVAL:1e4,SEND_TRACKS_INTERVAL:6e4,GEOLOCATION_REQUEST_TIMEOUT:3e3,GEOLOCATION_REQUEST_MAX_RETRY:1,CONF_LABEL:"default",ANALYTICS:{KLARA_URL:"",EXPOSE_CONF_LABEL:!1,RETRY_NUMBER:3,RETRY_DELAY:1e4,TIMEOUT_DELAY:3e3,TRAFFIC_INTERVAL_ARRAY:function(e){for(var t=e.from,n=e.to,r=e.step,i=[],a=t;a<n;a+=r)i.push(a);return i.push(n),i}({from:5e3,to:12e4,step:1e4}),STATS_INTERVAL:12e4,CONTROL_INTERVAL:6e5},QOS_REF_PERCENTAGE:0,QOS_P2P_DISABLED:!1,ERRORS:{API_KEY:"d04c6fa616c255ac55dec6b068ad7172",HANDLER:"xhr",STAGES:["staging","qa","production"]},PEER_CONNECTION_TIMEOUT:5e4,ICECANDIDATES_TIMEOUT:15e3,SEND_HEARTBEAT_INTERVAL:5e3,CHECK_HEARTBEAT_INTERVAL:1e4,DATACHANNEL_TYPE:"limited-retransmits",DATACHANNEL_MAX_PACKET_LIFETIME:1e3,DATACHANNEL_MAX_RETRANSMITS:1,ENABLE_STUN:!0,ENABLE_TURN:!1,TRANSFORM_SDP:!0,STUNSERVERS:["stun.l.google.com:19302"],TURNSERVERS:[{urls:"turn:23.97.160.254:3478?transport=udp",credential:"streamroot",username:"streamroot"}],CLIENT_TRACKER_PROTOCOL_VERSION:"3.0.0",P2P_PROTOCOL_VERSION:"3.3.1",CHUNK_SIZE:15360,ALLOW_LIVE_PUSH_SEGMENT:!0,ALLOW_VOD_PUSH_SEGMENT:!0,MIN_CHUNK_PERCENTAGE_DOWNLOADED_FOR_HAS_SEGMENT_ANSWER:80,P2P_CACHE_MAX_SIZE:136314880,MAX_DISTRIBUTED_SEGMENT_LIST_LENGTH:300,GETSEGMENTTIME_CACHE_MAX_SIZE:1e3,NB_SEGMENT_P2P_PREBUFFER:10,MAX_BUFFER_DURATION:300,SEGMENT_ID_ACCEPTABLE_RANGE:a.default,CHUNK_BATCHING_INTERVAL:1e3,CHUNK_TIMEOUT:2500,CHUNK_GRACE_DURATION:1e4,UP_BUFFERED_AMOUNT_LOW_THRESHOLD:15e3,UP_MAX_BUFFERED_AMOUNT:6e4,CHUNK_UP_TIMEOUT:1900,SPLIT_UPLOAD_QUEUE:!1,ENABLE_UPLOAD_DEQUEUE_ALL:!1,LIVE:{LOWER_BUFFER_TARGET:15,HIGHER_BUFFER_TARGET:30,BUFFER_LEVEL_UPLOAD_SPEED_EMWA_WEIGHT:.1,UPLOAD_THRESHOLD_MAX_BUFFER_TARGET_LOCKING:6e3,P2P_CACHE_MAX_SIZE:62914560,CHUNK_TIMEOUT:2e3,CHUNK_UP_TIMEOUT:1400,QOS_REF_PERCENTAGE:0,NEAR_EDGE_MARGIN:12e4,LOW_TARGET_P2P_DL_BLOCK_DURATION:2e4,ENABLE_DYNAMIC_LOWER_TARGET:!1,CRITICAL_LOWER_TARGET_RATIO:.5,FAST_BUFFER_FILL_FRACTION:.5,LOWER_BUFFER_TARGET_DECREASE_STEP:.2,LOWER_BUFFER_TARGET_INCREASE_STEP:.3},BUFFER_CHECK_INTERVAL:100,BUFFER_ZERO_THRESHOLD:2,VOD_CRITICAL_BUFFER_THRESHOLD:-1,VOD_CRITICAL_BUFFER_P2P_STOP_DURATION:1e4,VOD_SAFE_BUFFER_THRESHOLD:20,SPEED_MONITOR_INTERVAL:1e3,MEAN_SPEED_CALCULATION_INTERVAL:500,PEER_UPLOAD_SPEED_EMA_HALF_LIFE:1e4,PEER_DOWNLOAD_SPEED_EMA_HALF_LIFE:15e3,PEER_SPEED_MONITOR_INTERVAL:1e3,PEER_TIMEOUT_RATIO_WINDOW:3e4,PEER_UPLOAD_CAPACITY_SAFE_RATIO:.8,PEER_UPLOAD_CAPACITY_EXTRA_RATIO:.1,PEER_UPLOAD_CAPACITY_COMPUTATION_INTERVAL:1e3,DEFAULT_PEER_UPLOAD_CAPACITY:1e3,MIN_PEER_UPLOAD_CAPACITY:200,MAX_PEER_UPLOAD_CAPACITY_TIMEOUT_RATIO:.1,PEER_UPLOAD_CAPACITY_EWMA_WEIGHT_UP:.3,PEER_UPLOAD_CAPACITY_EWMA_WEIGHT_DOWN:.5,PUC_EMWA_WEIGHT_USE_TIMEOUT_RATIO:!1,PUC_EMWA_WEIGHT_CAP:.9,PEER_INIT_LOCKED_DURATION:1e4,PEER_LOCKED_UPLOAD_THRESHOLD:.05,PEER_LOCKED_DOWNLOAD_THRESHOLD:.1,POST_TRACK_SWITCH_PEER_LOCK_SENSITIVITY_ON:!1,POST_TRACK_SWITCH_PEER_SPEED_SENSITIVITY_DURATION:5e3,PEER_UPLOAD_SPEED_SENSITIVE_EMA_HALF_LIFE:2e3,PEER_DOWNLOAD_SPEED_SENSITIVE_EMA_HALF_LIFE:3e3,PEER_CRITICAL_CHUNK_TIMEOUT_THRESHOLD:.6,LOOSER_UPLOAD_THRESHOLD:50,PEER_POOL_LIMIT:16,PEER_POOL_MAINTENANCE_INTERVAL:1e3,EXPECTED_CONNECTION_SUCCESS_RATE:.4,RESERVED_OFFER_SLOTS:3,CANDIDATE_PEERS_TRY_DEQUEUE_INTERVAL:1e3,MAX_TRACKER_EXCLUSION_LENGTH:100,PEER_DISCONNECTED_EXCLUSION_DURATION:6e4,PEER_DISCONNECTED_EXCLUSION_RANK:1,OFFER_DECLINED_EXCLUSION_DURATION:6e4,OFFER_DECLINED_EXCLUSION_RANK:1,PEER_REMOVED_EXCLUSION_DURATION:9e5,PEER_REMOVED_EXCLUSION_RANK:1,PEER_CONNECTION_ATTEMPT_TIMED_OUT_EXCLUSION_DURATION:9e5,PEER_CONNECTION_ATTEMPT_EXCLUSION_RANK:1,CDN_SPEED_ESTIMATE_CONSIDER_P2P:!0,CDN_CONCURRENT_SCALING_CAP:1.5,P2P_SPEED_ZERO_THRESHOLD:50,P2P_SPEED_ESTIMATION_BUCKET_DURATION:100,P2P_SPEED_ESTIMATION_BUCKET_COUNT:10,P2P_SPEED_EMA_WEIGHT:.5,P2P_SPEED_EMA_ZERO_HALF_LIFE:12e4,P2P_USEFUL_CALCULATION_INTERVAL:5e3,P2P_USEFUL_SMA_WINDOW:12e4,P2P_DL_THRESHOLD_FOR_USEFUL_CORRECTION:50,P2P_USEFUL_RATIO_WEIGHT:.8,ABR_SEGMENT_CDN_RATIO_THRESHOLD:.3,ABR_CDN_SPEED_UPDATE_RATIO_THRESHOLD:.3,ABR_CDN_DL_THRESHOLD:100,ABR_CDN_DL_DECAY_TIME:6e4,USE_COMBINED_ABR_FEEDBACK:!0,BITRATE_ESTIMATION_WINDOW:3e4,ENABLE_PREBUFFER_FEEDBACK:!1,BLOCK_SEEDER_SCHEDULING_WINDOW:6e4,BLOCK_SEEDER_SCHEDULING_DURATION:12e4,BLOCK_SEEDER_SCHEDULING_TIMEOUT_THRESHOLD:1.1,BLOCK_SEEDER_SCHEDULING_REQUEST_THRESHOLD:50,PEER_COMPUTE_RTT_INTERVAL:5e3,USE_CONTINOUS_PROGRESS_FEEDBACK:!1,PROGRESS_ADD_TOTAL:!1,ENABLE_LATENCY_FEEDBACK:!1,LATENCY_CAPPING_RATIO:.5,MAX_PEER_CONNECTION_FAILURES:a.default,SEGMENT_REQUEST_TIMEOUT_TO_STOP_ASKING_PEERS:null,TRANSFER_ACTIVITY_TIMEOUT_TO_DISCONNECT_FROM_BACKEND:null,LOCKED_RETRY_INTERVAL:30,LOCKED_RETRY_TIMEOUT:500,TIMEOUT_GET_FULL_SEGMENT:500,RETURN_COPY_SEGMENT:!0,ENABLE_FIX_UNRELIABLE_SEGMENT_TIME:!1,ALLOW_P2P:!0,RANGE_REQUEST_ALLOWED:!0,DEVICE_INFO:"",ID_CLIENT:"",ENABLE_MOBILE_BROWSER:!1,CONTENT_ACTIVATED:!0,ENABLE_TRACK_EDGE_GC_BLOCK:!1,P2P_CACHE_GC_TRACK_EDGE_BLOCK_DURATION:0,DEBUG:!1,ENABLE_FILTER_BANNED_SEEDERS:!1,ENABLE_PUSH_SEGMENT_OPTIM:!1,ENABLE_P2P_SCHEDULER_OPTIM:!1};s.default.deepFreeze(u),t.default=u,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(e){return e&&e.__esModule?e:{default:e}}(r),a=function e(t){(0,i.default)(this,e),this.message=t.error.message,this.stacktrace=t.error.stack,this.fileName=t.filename,this.lineNumber=t.lineno,this.columnNumber=t.colno?t.colno:void 0};t.default=a,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(t,n,r){(0,a.default)(this,e),this._segmentCoord=t,this._chunkIndex=n,this._bandwidthSafety=r,this._timestamp=Date.now()}return(0,s.default)(e,[{key:"segmentCoord",get:function(){return this._segmentCoord}},{key:"chunkIndex",get:function(){return this._chunkIndex}},{key:"bandwidthSafety",get:function(){return this._bandwidthSafety}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";e.exports=n(194)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={IDLE:"IDLE",NO_PEER:"NO_PEER",RANDOM:"RANDOM",DYNAMIC:"DYNAMIC",TOP_SEEDER:"TOP_SEEDER"};t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(37),a=r(i),o=n(16),s=r(o),u=n(106),l=r(u),c=n(8),d=r(c),f=n(0),h=r(f),_=n(1),p=r(_),v=n(222),E=r(v),g=n(182),m=r(g),y=n(2),S=r(y),T=n(5),A=r(T),R=function(){function e(t,n,r,i){(0,h.default)(this,e),this._reachedLiveEdge=!1,this._cachedSegmentToDownload=[],this._sharedState=i,this._currentTracks=i.moduleState.currentTracks,this._p2pCache=n,this._distributedSegmentList=r,this._mediaMapCache=new m.default(t,i),this._edges=new E.default(this._mediaMapCache,i)}return(0,p.default)(e,[{key:"_getSegmentsToDownloadByTrack",value:function(e,t){var n=[],r=void 0;if(r="audio"===t?this._edges.audio:this._edges.video){var i=this._mediaMapCache.getSegmentListAfterEdge(e,r,this._sharedState.conf.MAX_BUFFER_DURATION),a=this._distributedSegmentList.getSegmentListAfter(r),o=this._mergeDedupe(i,a),s=this._sharedState.conf.ENABLE_P2P_SCHEDULER_OPTIM&&0===o.length?[]:this._p2pCache.listSegmentsToSkipForTrack(e);if("video"===t){var u=this._sharedState.conf.ENABLE_PREBUFFER_FEEDBACK||this._sharedState.conf.ENABLE_FIX_UNRELIABLE_SEGMENT_TIME?!i.length:i.length<=1;u!==this._reachedLiveEdge&&(this._reachedLiveEdge=u,this._sharedState.eventBus.emit(S.default.Scheduler.REACHED_LIVE_EDGE_STATE_CHANGED,u))}n=this._getDifference(o,s),this._sharedState.conf.ENABLE_PREBUFFER_FEEDBACK&&this._checkNextSegmentPrebuffered(t,o,n);var l=this._mediaMapCache.getSegmentTime(r);if(null===l)A.default.notifyError(new Error("Unexpected getSegmentTime error: track edge timestamp is not supposed to be unreliable"));else if(this._sharedState.moduleState.isLive()&&n.length>0){var c=o[0],d=this._mediaMapCache.getSegmentTime(c);if(null!==d){var f=l-d;this._sharedState.moduleState.isNearEdge=f<=this._sharedState.conf.LIVE.NEAR_EDGE_MARGIN}else this._sharedState.moduleState.isNearEdge=!0}}return n}},{key:"_checkNextSegmentPrebuffered",value:function(e,t,n){this._sharedState.moduleState.nextSegmentPrebuffered[e]=t.length>=2&&(!n.length||!t[0].isEqual(n[0])&&!t[1].isEqual(n[0]))}},{key:"isSegmentRequested",value:function(e){if(this._sharedState.conf.ENABLE_PUSH_SEGMENT_OPTIM){var t=!0,n=!1,r=void 0;try{for(var i,a=(0,d.default)(this._cachedSegmentToDownload);!(t=(i=a.next()).done);t=!0){var o=i.value;if(e.isEqual(o)){var s=this._p2pCache.getSegmentHandler(e);return s&&s.chunkManager.shouldDownloadSegment()}}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}return this._cachedSegmentToDownload.length<this._sharedState.conf.NB_SEGMENT_P2P_PREBUFFER&&this.isSegmentInAcceptableRange(e)}var u=this.getSegmentListToDownload(),l=!0,c=!1,f=void 0;try{for(var h,_=(0,d.default)(u);!(l=(h=_.next()).done);l=!0){var p=h.value;if(e.isEqual(p))return!0}}catch(e){c=!0,f=e}finally{try{!l&&_.return&&_.return()}finally{if(c)throw f}}return!1}},{key:"isSegmentInAcceptableRange",value:function(e){for(var t=!1,n=["audio","video"],r=0;r<n.length;r++){var i=n[r],a=this._edges[i];t=t||!!a&&e.isInTrack(a.trackView)&&e.getId()>a.getId()&&e.getId()-a.getId()<=this._sharedState.conf.SEGMENT_ID_ACCEPTABLE_RANGE}return t}},{key:"_getDifference",value:function(e,t){if(this._sharedState.conf.ENABLE_P2P_SCHEDULER_OPTIM){if(0===t.length||0===e.length)return e;var n=new l.default(t.map(function(e){return e.viewToString()}));return e.filter(function(e){return!n.has(e.viewToString())})}return e.filter(function(e){return void 0===t.find(function(t){return e.isEqual(t)})})}},{key:"_mergeDedupe",value:function(e,t){var n=new s.default,r=!0,i=!1,o=void 0;try{for(var u,l=(0,d.default)(e);!(r=(u=l.next()).done);r=!0){var c=u.value;n.set(c.viewToString(),c)}}catch(e){i=!0,o=e}finally{try{!r&&l.return&&l.return()}finally{if(i)throw o}}var f=!0,h=!1,_=void 0;try{for(var p,v=(0,d.default)(t);!(f=(p=v.next()).done);f=!0){var E=p.value;n.set(E.viewToString(),E)}}catch(e){h=!0,_=e}finally{try{!f&&v.return&&v.return()}finally{if(h)throw _}}return(0,a.default)(n.values())}},{key:"getCachedSegmentListToDownload",value:function(){return this._cachedSegmentToDownload}},{key:"getSegmentListToDownload",value:function(){throw new Error("Cannot call abstract method")}},{key:"updateTrackEdge",value:function(e){throw new Error("Cannot call abstract method")}},{key:"getEdgeSegment",value:function(){return this._edges.video}}]),e}();t.default=R,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={PeerStats:{SAMPLED_PUC:"sampledPUC"}},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(){(0,a.default)(this,e),this._providers={}}return(0,s.default)(e,[{key:"registerProvider",value:function(e,t){this._providers[e]=t}},{key:"getStat",value:function(e){var t=this._providers[e];if(t)return t()}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(51),a=r(i),o=n(0),s=r(o),u=n(17),l=n(61),c=r(l),d=n(46),f=function e(t,n,r){if((0,s.default)(this,e),(0,d.checkInterface)(c.default,t),!(0,u.isNumeric)(n))throw new Error("Invalid value for size");if(!r)throw new Error("No hash");this.segmentCoord=t,this.size=n,this.hash=r,(0,a.default)(this)};t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){for(var n=[],r=0;r<e.length;r++)(0,o.default)(e[r],t)||n.push(e[r]);return n}function i(e){e.length=0}Object.defineProperty(t,"__esModule",{value:!0});var a=n(247),o=function(e){return e&&e.__esModule?e:{default:e}}(a);t.default={without:r,clear:i},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.BitDataAmount=t.ByteDataAmount=t.DataAmount=t.numToUint8Array4=t.uint16ToUint8Array2=void 0;var i=n(7),a=r(i),o=n(10),s=r(o),u=n(9),l=r(u),c=n(0),d=r(c),f=n(1),h=r(f),_=function(e){var t=Math.floor(e/256),n=e%256;return new Uint8Array([n,t])},p=function(e){var t=_(Math.floor(e/65536)),n=_(e%65536);return new Uint8Array([n[0],n[1],t[0],t[1]])},v=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2;(0,d.default)(this,e),this._rawValue=t,this._unit=n,this._k=r,this._suffix=i,this._decimals=a}return(0,h.default)(e,[{key:"_format",value:function(){if(this._rawValue<1)return"0";var e=["","K","M","G","T","P","E","Z","Y"],t=Math.min(Math.floor(Math.log(this._rawValue)/Math.log(this._k)),e.length-1);return parseFloat((this._rawValue/Math.pow(this._k,t)).toFixed(this._decimals))+e[t]}},{key:"valueOf",value:function(){return this._rawValue}},{key:"toString",value:function(){return this._format()+this._unit+this._suffix}}]),e}(),E=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return(0,d.default)(this,t),(0,s.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,"B",1e3,n,r))}return(0,l.default)(t,e),t}(v),g=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return(0,d.default)(this,t),(0,s.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,"b",1e3,n,r))}return(0,l.default)(t,e),t}(v);t.uint16ToUint8Array2=_,t.numToUint8Array4=p,t.DataAmount=v,t.ByteDataAmount=E,t.BitDataAmount=g},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(t){(0,a.default)(this,e),this._internalQueue=t}return(0,s.default)(e,[{key:"_canDequeue",value:function(){return!0}},{key:"_dequeuedCallback",value:function(e){}},{key:"_emptyCallback",value:function(){}},{key:"_validateItem",value:function(e){return!0}},{key:"push",value:function(e){this._internalQueue.push(e),this.tryDequeue()}},{key:"_skipInvalidItems",value:function(){for(var e=this._internalQueue.shift();void 0!==e&&!this._validateItem(e);)e=this._internalQueue.shift();return e}},{key:"tryDequeue",value:function(){if(this._canDequeue()){var e=this._skipInvalidItems();e?this._dequeuedCallback(e):this._emptyCallback()}}},{key:"tryDequeueN",value:function(e){for(;this._canDequeue()&&e>0;){var t=this._skipInvalidItems();if(!t){this._emptyCallback();break}this._dequeuedCallback(t),e--}}},{key:"tryDequeueAll",value:function(){for(;this._canDequeue();){var e=this._skipInvalidItems();if(!e){this._emptyCallback();break}this._dequeuedCallback(e)}}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){if(0===e.length)return null;e.sort(function(e,t){return e-t});var t=Math.floor(e.length/2);return e.length%2?e[t]:(e[t-1]+e[t])/2}function i(e){if(0===e.length)return null;for(var t=0,n=0;n<e.length;n++)t+=e[n];return t/e.length}function a(e){var t=i(e);if(!t)return null;for(var n=0,r=0;r<e.length;r++)n+=Math.abs(e[r]-t);return n/e.length}Object.defineProperty(t,"__esModule",{value:!0}),t.default={median:r,mean:i,meanAbsoluteDeviation:a},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(t){(0,a.default)(this,e),this._maxSize=t,this._internalQueue=[]}return(0,s.default)(e,[{key:"addSample",value:function(e){this._internalQueue.length>=this._maxSize&&this._internalQueue.shift(),this._internalQueue.push(e)}},{key:"fetchSample",value:function(){if(this._internalQueue.length>0){var e=Math.floor(Math.random()*this._internalQueue.length);return this._internalQueue.splice(e,1)[0]}}},{key:"mean",get:function(){return this.length>0?this._internalQueue.reduce(function(e,t){return e+t})/this.length:0}},{key:"length",get:function(){return this._internalQueue.length}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),a=r(i),o=n(37),s=r(o),u=n(36),l=r(u),c=window.RTCPeerConnection||window.webkitRTCPeerConnection,d=window.RTCIceCandidate,f=window.RTCSessionDescription,h=function(e){return e=e.replace(/b=AS([^\r\n]+\r\n)/g,""),e=e.replace(/a=mid:audio\r\n/g,"a=mid:audio\r\nb=AS:50\r\n"),e=e.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:256\r\n"),e=e.replace(/a=mid:data\r\n/g,"a=mid:data\r\nb=AS:1638400\r\n")},_=function(e){return new c(p(e),{optional:[{DtlsSrtpKeyAgreement:!0}]})},p=function(e){var t=e.ENABLE_STUN,n=e.ENABLE_TURN;if(!t&&!n)return{};var r=t?[{urls:e.STUNSERVERS.map(function(e){return"stun:"+e})}]:[];return{iceServers:n?e.TURNSERVERS.concat(r):r}},v=function(e,t){"Firefox"===l.default.getUAObject().browser.name?e.getStats(null,function(e){t((0,s.default)(e.values()))},function(){}):e.getStats(function(e){var n=[];e.result().forEach(function(e){var t={};e.names().forEach(function(n){t[n]=e.stat(n)}),t.id=e.id,t.type=e.type,t.timestamp=e.timestamp,n.push(t)}),t(n)})},E=function(e,t){v(e,function(e){var n=!0,r=!1,i=void 0;try{for(var o,s=(0,a.default)(e);!(n=(o=s.next()).done);n=!0){var u=o.value;if(u.mozRtt)return void t(u.mozRtt);if(u.googRtt)return void t(parseFloat(u.googRtt))}}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}})};t.default={transformOutgoingSdp:h,createPeerConnection:_,getPeerConnectionRTT:E,IceCandidate:d,SessionDescription:f,getStats:v},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.TIMER_TYPE=t.AbstractTimer=void 0;var i=n(0),a=r(i),o=n(1),s=r(o),u=n(126),l=r(u),c={TIMEOUT:0,INTERVAL:1},d=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c.TIMEOUT;(0,a.default)(this,e),this._id="timer-"+l.default.v4(),this._name=this._id,this._callback=t,this._time=n,this._type=r,this._isRepeatable=r===c.INTERVAL}return(0,s.default)(e,[{key:"clear",value:function(){throw new Error("Cannot call abstract method")}},{key:"id",get:function(){return this._id}},{key:"name",set:function(e){this._name=e},get:function(){return this._name}}]),e}();t.AbstractTimer=d,t.TIMER_TYPE=c},function(e,t,n){e.exports={default:n(260),__esModule:!0}},function(e,t,n){e.exports={default:n(268),__esModule:!0}},function(e,t,n){e.exports={default:n(273),__esModule:!0}},function(e,t,n){e.exports={default:n(276),__esModule:!0}},function(e,t,n){e.exports={default:n(277),__esModule:!0}},function(e,t,n){"use strict";var r=n(15).f,i=n(57),a=n(76),o=n(22),s=n(69),u=n(54),l=n(55),c=n(73),d=n(116),f=n(123),h=n(14),_=n(42).fastKey,p=h?"_s":"size",v=function(e,t){var n,r=_(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,c){var d=e(function(e,r){s(e,d,t,"_i"),e._i=i(null),e._f=void 0,e._l=void 0,e[p]=0,void 0!=r&&l(r,n,e[c],e)});return a(d.prototype,{clear:function(){for(var e=this,t=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete t[n.i];e._f=e._l=void 0,e[p]=0},delete:function(e){var t=this,n=v(t,e);if(n){var r=n.n,i=n.p;delete t._i[n.i],n.r=!0,i&&(i.n=r),r&&(r.p=i),t._f==n&&(t._f=r),t._l==n&&(t._l=i),t[p]--}return!!n},forEach:function(e){s(this,d,"forEach");for(var t,n=o(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.n:this._f;)for(n(t.v,t.k,this);t&&t.r;)t=t.p},has:function(e){return!!v(this,e)}}),h&&r(d.prototype,"size",{get:function(){return u(this[p])}}),d},def:function(e,t,n){var r,i,a=v(e,t);return a?a.v=n:(e._l=a={i:i=_(t,!0),k:t,v:n,p:r=e._l,n:void 0,r:!1},e._f||(e._f=a),r&&(r.n=a),e[p]++,"F"!==i&&(e._i[i]=a)),e},getEntry:v,setStrong:function(e,t,n){c(e,t,function(e,t){this._t=e,this._k=t,this._l=void 0},function(){for(var e=this,t=e._k,n=e._l;n&&n.r;)n=n.p;return e._t&&(e._l=n=n?n.n:e._t._f)?"keys"==t?d(0,n.k):"values"==t?d(0,n.v):d(0,[n.k,n.v]):(e._t=void 0,d(1))},n?"entries":"values",!n,!0),f(t)}}},function(e,t,n){var r=n(53),i=n(281);e.exports=function(e){return function(){if(r(this)!=e)throw TypeError(e+"#toJSON isn't generic");return i(this)}}},function(e,t,n){"use strict";var r=n(12),i=n(6),a=n(42),o=n(25),s=n(23),u=n(76),l=n(55),c=n(69),d=n(13),f=n(45),h=n(15).f,_=n(283)(0),p=n(14);e.exports=function(e,t,n,v,E,g){var m=r[e],y=m,S=E?"set":"add",T=y&&y.prototype,A={};return p&&"function"==typeof y&&(g||T.forEach&&!o(function(){(new y).entries().next()}))?(y=t(function(t,n){c(t,y,e,"_c"),t._c=new m,void 0!=n&&l(n,E,t[S],t)}),_("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in T&&(!g||"clear"!=e)&&s(y.prototype,e,function(n,r){if(c(this,y,e),!t&&g&&!d(n))return"get"==e&&void 0;var i=this._c[e](0===n?0:n,r);return t?this:i})}),"size"in T&&h(y.prototype,"size",{get:function(){return this._c.size}})):(y=v.getConstructor(t,e,E,S),u(y.prototype,n),a.NEED=!0),f(y,e),A[e]=y,i(i.G+i.W+i.F,A),g||v.setStrong(y,e,E),y}},function(e,t,n){e.exports=n(12).document&&document.documentElement},function(e,t,n){e.exports=!n(14)&&!n(25)(function(){return 7!=Object.defineProperty(n(70)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(32),i=n(11)("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||a[i]===e)}},function(e,t,n){var r=n(41);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var r=n(19);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){var a=e.return;throw void 0!==a&&r(a.call(e)),t}}},function(e,t,n){var r=n(11)("iterator"),i=!1;try{var a=[7][r]();a.return=function(){i=!0},Array.from(a,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var a=[7],o=a[r]();o.next=function(){return{done:n=!0}},a[r]=function(){return o},e(a)}catch(e){}return n}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){var r=n(15),i=n(19),a=n(27);e.exports=n(14)?Object.defineProperties:function(e,t){i(e);for(var n,o=a(t),s=o.length,u=0;s>u;)r.f(e,n=o[u++],t[n]);return e}},function(e,t,n){var r=n(20),i=n(119).f,a={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(e){try{return i(e)}catch(e){return o.slice()}};e.exports.f=function(e){return o&&"[object Window]"==a.call(e)?s(e):i(r(e))}},function(e,t,n){var r=n(121),i=n(71).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){var r=n(26),i=n(33),a=n(77)("IE_PROTO"),o=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,a)?e[a]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?o:null}},function(e,t,n){var r=n(26),i=n(20),a=n(282)(!1),o=n(77)("IE_PROTO");e.exports=function(e,t){var n,s=i(e),u=0,l=[];for(n in s)n!=o&&r(s,n)&&l.push(n);for(;t.length>u;)r(s,n=t[u++])&&(~a(l,n)||l.push(n));return l}},function(e,t,n){e.exports=n(23)},function(e,t,n){"use strict";var r=n(12),i=n(3),a=n(15),o=n(14),s=n(11)("species");e.exports=function(e){var t="function"==typeof i[e]?i[e]:r[e];o&&t&&!t[s]&&a.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){var r,i,a,o=n(22),s=n(288),u=n(110),l=n(70),c=n(12),d=c.process,f=c.setImmediate,h=c.clearImmediate,_=c.MessageChannel,p=0,v={},E=function(){var e=+this;if(v.hasOwnProperty(e)){var t=v[e];delete v[e],t()}},g=function(e){E.call(e.data)};f&&h||(f=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return v[++p]=function(){s("function"==typeof e?e:Function(e),t)},r(p),p},h=function(e){delete v[e]},"process"==n(41)(d)?r=function(e){d.nextTick(o(E,e,1))}:_?(i=new _,a=i.port2,i.port1.onmessage=g,r=o(a.postMessage,a,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(r=function(e){c.postMessage(e+"","*")},c.addEventListener("message",g,!1)):r="onreadystatechange"in l("script")?function(e){u.appendChild(l("script")).onreadystatechange=function(){u.removeChild(this),E.call(e)}}:function(e){setTimeout(o(E,e,1),0)}),e.exports={set:f,clear:h}},function(e,t,n){!function(t,n){e.exports=n()}(0,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=29)}([function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,n){"use strict";t.__esModule=!0;var r=n(30),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,i.default)(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){var n=e.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)},function(e,t,n){var r=n(24)("wks"),i=n(25),a=n(2).Symbol,o="function"==typeof a;(e.exports=function(e){return r[e]||(r[e]=o&&a[e]||(o?a:i)("Symbol."+e))}).store=r},function(e,t,n){var r=n(7),i=n(20);e.exports=n(6)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){e.exports=!n(13)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(8),i=n(35),a=n(36),o=Object.defineProperty;t.f=n(6)?Object.defineProperty:function(e,t,n){if(r(e),t=a(t,!0),r(n),i)try{return o(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(12);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t){e.exports={}},function(e,t,n){var r=n(2),i=n(3),a=n(33),o=n(5),s=function(e,t,n){var u,l,c,d=e&s.F,f=e&s.G,h=e&s.S,_=e&s.P,p=e&s.B,v=e&s.W,E=f?i:i[t]||(i[t]={}),g=E.prototype,m=f?r:h?r[t]:(r[t]||{}).prototype;f&&(n=t);for(u in n)(l=!d&&m&&void 0!==m[u])&&u in E||(c=l?m[u]:n[u],E[u]=f&&"function"!=typeof m[u]?n[u]:p&&l?a(c,r):v&&m[u]==c?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(c):_&&"function"==typeof c?a(Function.call,c):c,_&&((E.virtual||(E.virtual={}))[u]=c,e&s.R&&g&&!g[u]&&o(g,u,c)))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,e.exports=s},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={IDLE:"IDLE",PLAYING:"PLAYING",SEEKING:"SEEKING",BUFFERING:"BUFFERING",BUFFERING_WITH_BUFFER:"BUFFERING_WITH_BUFFER",PAUSED:"PAUSED",ENDED:"ENDED"};t.default=r,e.exports=t.default},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var r=n(44),i=n(15);e.exports=function(e){return r(i(e))}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(24)("keys"),i=n(25);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t,n){var r=n(12),i=n(2).document,a=r(i)&&r(i.createElement);e.exports=function(e){return a?i.createElement(e):{}}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var r=n(15);e.exports=function(e){return Object(r(e))}},function(e,t,n){var r=n(43),i=n(26);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var r=n(2),i=r["__core-js_shared__"]||(r["__core-js_shared__"]={});e.exports=function(e){return i[e]||(i[e]={})}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){"use strict";var r=n(55),i=n(11),a=n(56),o=n(5),s=n(9),u=n(10),l=n(57),c=n(28),d=n(61),f=n(4)("iterator"),h=!([].keys&&"next"in[].keys()),_=function(){return this};e.exports=function(e,t,n,p,v,E,g){l(n,t,p);var m,y,S,T=function(e){if(!h&&e in C)return C[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},A=t+" Iterator",R="values"==v,D=!1,C=e.prototype,w=C[f]||C["@@iterator"]||v&&C[v],b=w||T(v),O=v?R?T("entries"):b:void 0,P="Array"==t?C.entries||w:w;if(P&&(S=d(P.call(new e)))!==Object.prototype&&(c(S,A,!0),r||s(S,f)||o(S,f,_)),R&&w&&"values"!==w.name&&(D=!0,b=function(){return w.call(this)}),r&&!g||!h&&!D&&C[f]||o(C,f,b),u[t]=b,u[A]=_,v)if(m={values:R?b:T("values"),keys:E?b:T("keys"),entries:O},g)for(y in m)y in C||a(C,y,m[y]);else i(i.P+i.F*(h||D),t,m);return m}},function(e,t,n){var r=n(7).f,i=n(9),a=n(4)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,a)&&r(e,a,{configurable:!0,value:t})}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(37),l=r(u),c=n(38),d=r(c),f=n(39),h=r(f),_=n(67),p=r(_),v=n(68),E=r(v),g={ATTACHED:"ATTACHED",DETACHED:"DETACHED",DISPOSED:"DISPOSED"},m=function(){function e(t,n){(0,a.default)(this,e),this._state=g.ATTACHED,this._stateMachine=new l.default,this._playbackWatcher=new d.default(t,this._stateMachine,n||p.default),this._stateTimeCalculator=new h.default(this._stateMachine),this._qosStats=new E.default(t,this._stateTimeCalculator)}return(0,s.default)(e,[{key:"getQoSAnalytics",value:function(){return this._qosStats.getAnalytics()}},{key:"attach",value:function(){this._state===g.DETACHED&&(this._state=g.ATTACHED,this._playbackWatcher.resume(),this._stateTimeCalculator.resume())}},{key:"detach",value:function(){this._state===g.ATTACHED&&(this._state=g.DETACHED,this._playbackWatcher.pause(),this._stateTimeCalculator.pause())}},{key:"dispose",value:function(){this._state=g.DISPOSED,this._playbackWatcher.dispose(),this._stateTimeCalculator.dispose()}}]),e}();t.default=m,e.exports=t.default},function(e,t,n){e.exports={default:n(31),__esModule:!0}},function(e,t,n){n(32);var r=n(3).Object;e.exports=function(e,t,n){return r.defineProperty(e,t,n)}},function(e,t,n){var r=n(11);r(r.S+r.F*!n(6),"Object",{defineProperty:n(7).f})},function(e,t,n){var r=n(34);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");
            return e}},function(e,t,n){e.exports=!n(6)&&!n(13)(function(){return 7!=Object.defineProperty(n(19)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(12);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(14),l=r(u),c=function(){function e(){(0,a.default)(this,e),this._stateChangedCallbacks=[],this.gotoIdle()}return(0,s.default)(e,[{key:"_setState",value:function(e){var t=this;this._state!==e&&(this._prevState=this._state,this._state=e,this._stateChangedCallbacks.forEach(function(e){e(t._state,t._prevState)}))}},{key:"gotoIdle",value:function(){this._setState(l.default.IDLE)}},{key:"gotoPlaying",value:function(){this._setState(l.default.PLAYING)}},{key:"gotoSeeking",value:function(){this._setState(l.default.SEEKING)}},{key:"gotoBuffering",value:function(){this._setState(l.default.BUFFERING)}},{key:"gotoBufferingWithBuffer",value:function(){this._setState(l.default.BUFFERING_WITH_BUFFER)}},{key:"gotoPaused",value:function(){this._setState(l.default.PAUSED)}},{key:"gotoEnded",value:function(){this._setState(l.default.ENDED)}},{key:"getState",value:function(){return this._state}},{key:"addObserver",value:function(e){this._stateChangedCallbacks.indexOf(e)<0&&this._stateChangedCallbacks.push(e)}},{key:"removeObserver",value:function(e){var t=this._stateChangedCallbacks.indexOf(e);t>-1&&this._stateChangedCallbacks.splice(t,1)}},{key:"isIdle",value:function(){return this._state===l.default.IDLE}},{key:"isPlaying",value:function(){return this._state===l.default.PLAYING}},{key:"isSeeking",value:function(){return this._state===l.default.SEEKING}},{key:"isBuffering",value:function(){return this._state===l.default.BUFFERING}},{key:"isBufferingWithBuffer",value:function(){return this._state===l.default.BUFFERING_WITH_BUFFER}},{key:"isPaused",value:function(){return this._state===l.default.PAUSED}},{key:"isEnded",value:function(){return this._state===l.default.ENDED}}]),e}();t.default=c,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(t,n,r){(0,a.default)(this,e),this._createInterval=r,this._video=t,this._stateMachine=n,this._previousPlaybackTime=0,this.resume()}return(0,s.default)(e,[{key:"dispose",value:function(){this.pause()}},{key:"pause",value:function(){this._tickInterval.clear()}},{key:"resume",value:function(){this._tickInterval=this._createInterval(this._tickHandler.bind(this),100)}},{key:"_getBufferLength",value:function(){for(var e=this._video.currentTime,t=this._video.buffered,n=0;n<t.length;n++)if(t.start(n)<=e&&e<=t.end(n))return t.end(n)-e;return 0}},{key:"_tickHandler",value:function(){var e=this._video.duration-this._video.currentTime,t=Math.abs(this._video.currentTime-this._previousPlaybackTime);if(isNaN(t))this._stateMachine.gotoIdle();else if(this._video.seeking)this._stateMachine.gotoSeeking();else if(this._video.paused)this._stateMachine.isIdle()||(!isNaN(e)&&e<.3?this._stateMachine.gotoEnded():this._stateMachine.gotoPaused());else if(t>0)this._stateMachine.gotoPlaying();else if(!this._stateMachine.isIdle()&&!this._stateMachine.isSeeking()){var n=this._getBufferLength();n<1?this._stateMachine.gotoBuffering():this._stateMachine.gotoBufferingWithBuffer()}this._previousPlaybackTime=this._video.currentTime}}],[{key:"BUFFERING_WITH_BUFFER_THRESHOLD",get:function(){return 1}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(40),a=r(i),o=n(49),s=r(o),u=n(0),l=r(u),c=n(1),d=r(c),f=n(14),h=r(f),_=function(){function e(t){(0,l.default)(this,e),this._stateMachine=t,this._stats={};var n=!0,r=!1,i=void 0;try{for(var o,u=(0,s.default)((0,a.default)(h.default));!(n=(o=u.next()).done);n=!0){var c=o.value;this._stats[c]={count:0,timeSpent:0}}}catch(e){r=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(r)throw i}}this.resume(),this._onStateChangedCallback=this._onStateChanged.bind(this),this._stateMachine.addObserver(this._onStateChangedCallback)}return(0,d.default)(e,[{key:"getStats",value:function(){return this._isAttached&&this._updateStateTimeSpent(this._stateMachine.getState()),this._stats}},{key:"pause",value:function(){this._isAttached=!1,this._terminateState(this._stateMachine.getState())}},{key:"resume",value:function(){this._isAttached=!0,this._resumeState(this._stateMachine.getState())}},{key:"dispose",value:function(){this.pause(),this._stateMachine.removeObserver(this._onStateChangedCallback)}},{key:"_onStateChanged",value:function(e,t){this._terminateState(t),this._resumeState(e)}},{key:"_terminateState",value:function(e){this._updateStateTimeSpent(e),this._stats[e].startTimeStamp=null}},{key:"_updateStateTimeSpent",value:function(e){var t=this._stats[e],n=Date.now();t.timeSpent+=(n-t.startTimeStamp)/1e3,t.startTimeStamp=n}},{key:"_resumeState",value:function(e){var t=this._stats[e];t.count++,t.startTimeStamp=Date.now()}}]),e}();t.default=_,e.exports=t.default},function(e,t,n){e.exports={default:n(41),__esModule:!0}},function(e,t,n){n(42),e.exports=n(3).Object.keys},function(e,t,n){var r=n(21),i=n(22);n(48)("keys",function(){return function(e){return i(r(e))}})},function(e,t,n){var r=n(9),i=n(16),a=n(45)(!1),o=n(18)("IE_PROTO");e.exports=function(e,t){var n,s=i(e),u=0,l=[];for(n in s)n!=o&&r(s,n)&&l.push(n);for(;t.length>u;)r(s,n=t[u++])&&(~a(l,n)||l.push(n));return l}},function(e,t,n){var r=n(23);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){var r=n(16),i=n(46),a=n(47);e.exports=function(e){return function(t,n,o){var s,u=r(t),l=i(u.length),c=a(o,l);if(e&&n!=n){for(;l>c;)if((s=u[c++])!=s)return!0}else for(;l>c;c++)if((e||c in u)&&u[c]===n)return e||c||0;return!e&&-1}}},function(e,t,n){var r=n(17),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t,n){var r=n(17),i=Math.max,a=Math.min;e.exports=function(e,t){return e=r(e),e<0?i(e+t,0):a(e,t)}},function(e,t,n){var r=n(11),i=n(3),a=n(13);e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],o={};o[e]=t(n),r(r.S+r.F*a(function(){n(1)}),"Object",o)}},function(e,t,n){e.exports={default:n(50),__esModule:!0}},function(e,t,n){n(51),n(62),e.exports=n(64)},function(e,t,n){n(52);for(var r=n(2),i=n(5),a=n(10),o=n(4)("toStringTag"),s=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],u=0;u<5;u++){var l=s[u],c=r[l],d=c&&c.prototype;d&&!d[o]&&i(d,o,l),a[l]=a.Array}},function(e,t,n){"use strict";var r=n(53),i=n(54),a=n(10),o=n(16);e.exports=n(27)(Array,"Array",function(e,t){this._t=o(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):"keys"==t?i(0,n):"values"==t?i(0,e[n]):i(0,[n,e[n]])},"values"),a.Arguments=a.Array,r("keys"),r("values"),r("entries")},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t){e.exports=!0},function(e,t,n){e.exports=n(5)},function(e,t,n){"use strict";var r=n(58),i=n(20),a=n(28),o={};n(5)(o,n(4)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=r(o,{next:i(1,n)}),a(e,t+" Iterator")}},function(e,t,n){var r=n(8),i=n(59),a=n(26),o=n(18)("IE_PROTO"),s=function(){},u=function(){var e,t=n(19)("iframe"),r=a.length;for(t.style.display="none",n(60).appendChild(t),t.src="javascript:",e=t.contentWindow.document,e.open(),e.write("<script>document.F=Object<\/script>"),e.close(),u=e.F;r--;)delete u.prototype[a[r]];return u()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=r(e),n=new s,s.prototype=null,n[o]=e):n=u(),void 0===t?n:i(n,t)}},function(e,t,n){var r=n(7),i=n(8),a=n(22);e.exports=n(6)?Object.defineProperties:function(e,t){i(e);for(var n,o=a(t),s=o.length,u=0;s>u;)r.f(e,n=o[u++],t[n]);return e}},function(e,t,n){e.exports=n(2).document&&document.documentElement},function(e,t,n){var r=n(9),i=n(21),a=n(18)("IE_PROTO"),o=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,a)?e[a]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?o:null}},function(e,t,n){"use strict";var r=n(63)(!0);n(27)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){var r=n(17),i=n(15);e.exports=function(e){return function(t,n){var a,o,s=String(i(t)),u=r(n),l=s.length;return u<0||u>=l?e?"":void 0:(a=s.charCodeAt(u),a<55296||a>56319||u+1===l||(o=s.charCodeAt(u+1))<56320||o>57343?e?s.charAt(u):a:e?s.slice(u,u+2):o-56320+(a-55296<<10)+65536)}}},function(e,t,n){var r=n(8),i=n(65);e.exports=n(3).getIterator=function(e){var t=i(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return r(t.call(e))}},function(e,t,n){var r=n(66),i=n(4)("iterator"),a=n(10);e.exports=n(3).getIteratorMethod=function(e){if(void 0!=e)return e[i]||e["@@iterator"]||a[r(e)]}},function(e,t,n){var r=n(23),i=n(4)("toStringTag"),a="Arguments"==r(function(){return arguments}()),o=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,n,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=o(t=Object(e),i))?n:a?r(t):"Object"==(s=r(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o);t.default=function(e,t){return new u(e,t)};var u=function(){function e(t,n){(0,a.default)(this,e),this._callback=t,this._time=n,this._timer=this._createTimer()}return(0,s.default)(e,[{key:"_createTimer",value:function(){return setInterval(this._callback,this._time)}},{key:"clear",value:function(){clearInterval(this._timer)}}]),e}();e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(14),l=r(u),c=function(){function e(t,n){(0,a.default)(this,e),this._video=t,this._stateTimeCalculator=n}return(0,s.default)(e,[{key:"getAnalytics",value:function(){var e=this._stateTimeCalculator.getStats();return{droppedFrameCount:this._video.webkitDroppedFrameCount||this._video.droppedFrameCount||0,timeSpentPlaying:e[l.default.PLAYING].timeSpent,timeSpentPaused:e[l.default.PAUSED].timeSpent,timeSpentSeeking:e[l.default.SEEKING].timeSpent,timeSpentEnded:e[l.default.ENDED].timeSpent,rebufferingCount:e[l.default.BUFFERING].count,timeSpentRebuffering:e[l.default.BUFFERING].timeSpent,rebufferingCountWithBuffer:e[l.default.BUFFERING_WITH_BUFFER].count,timeSpentRebufferingWithBuffer:e[l.default.BUFFERING_WITH_BUFFER].timeSpent}}}]),e}();t.default=c,e.exports=t.default}])})},function(e,t,n){var r=n(336),i=n(337),a=i;a.v1=r,a.v4=i,e.exports=a},function(e,t){function n(e,t){var n=t||0,i=r;return i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]}for(var r=[],i=0;i<256;++i)r[i]=(i+256).toString(16).substr(1);e.exports=n},function(e,t,n){(function(t){var n,r=t.crypto||t.msCrypto;if(r&&r.getRandomValues){var i=new Uint8Array(16);n=function(){return r.getRandomValues(i),i}}if(!n){var a=new Array(16);n=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),a[t]=e>>>((3&t)<<3)&255;return a}}e.exports=n}).call(t,n(84))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(164),l=r(u),c=n(163),d=r(c),f=n(158),h=r(f),_=n(159),p=r(_),v=n(30),E=r(v),g=n(2),m=r(g),y=n(4),S=function(){function e(t,n){(0,a.default)(this,e),this._trafficIntervalCounter=0,this._conf=n.conf,this._timerStore=new E.default,this._configAnalytics=new h.default(n),this._trafficAnalytics=new l.default(n),this._statsAnalytics=new d.default(t,n),this._mediaEndedListener=new p.default(t,n),n.eventBus.once(m.default.Distributor.READY,this._init.bind(this))}return(0,s.default)(e,[{key:"_init",value:function(e){this._conf.CONTENT_ACTIVATED&&(this._sendConfigReport(),e?(this._scheduleTrafficReport(),this._scheduleStatReport(),this._scheduleControlReport()):this._conf.ALLOW_P2P=!1),this._onBU=this._onBeforeUnload.bind(this),window.addEventListener("beforeunload",this._onBU)}},{key:"_onBeforeUnload",value:function(){this._trafficAnalytics.sendUsage(!0)}},{key:"dispose",value:function(){this._timerStore.clearAll(),this._statsAnalytics.dispose(),this._mediaEndedListener.dispose(),window.removeEventListener("beforeunload",this._onBU)}},{key:"_sendConfigReport",value:function(){this._configAnalytics.sendConfig()}},{key:"_scheduleTrafficReport",value:function(){var e=this;if(this._trafficIntervalCounter<this._conf.ANALYTICS.TRAFFIC_INTERVAL_ARRAY.length-1){var t=(0,y.createTimeout)(function(){e._trafficAnalytics.sendUsage(),e._scheduleTrafficReport()},this._conf.ANALYTICS.TRAFFIC_INTERVAL_ARRAY[this._trafficIntervalCounter]);this._timerStore.register(t),this._trafficIntervalCounter++}else{var n=this._conf.ANALYTICS.TRAFFIC_INTERVAL_ARRAY[this._conf.ANALYTICS.TRAFFIC_INTERVAL_ARRAY.length-1],r=this._trafficAnalytics.sendUsage.bind(this._trafficAnalytics,!1),i=(0,y.createInterval)(r,n);this._timerStore.register(i)}}},{key:"_scheduleStatReport",value:function(){var e=(0,y.createInterval)(this._statsAnalytics.sendStats.bind(this._statsAnalytics),this._conf.ANALYTICS.STATS_INTERVAL);this._timerStore.register(e)}},{key:"_scheduleControlReport",value:function(){var e=(0,y.createInterval)(this._statsAnalytics.sendControl.bind(this._statsAnalytics),this._conf.ANALYTICS.CONTROL_INTERVAL);this._timerStore.register(e)}}]),e}();t.default=S,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(){(0,a.default)(this,e),this._mediaElement=null}return(0,s.default)(e,[{key:"mediaElement",get:function(){return this._mediaElement},set:function(e){this._mediaElement=e}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){var t=new o.default(e.conf.BITRATE_ESTIMATION_WINDOW);e.eventBus.on(u.default.SRModuleInterface.ABR_FEEDBACK,function(){t.push(e.transferStats.p2pConsumed+e.transferStats.cdnConsumed);var n=t.delta,r=t.timeDelta;n&&r&&(e.abrStats.estimatedBitrate=8*n/r)})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var a=n(65),o=r(a),s=n(2),u=r(s);e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(4),l=n(233),c=r(l),d=n(2),f=r(d),h=function(){function e(t,n){(0,a.default)(this,e),this._mediaElementPlaceholder=t,this._sharedState=n,this._bufferCheck(),this._bufferCheckInterval=(0,u.createInterval)(this._bufferCheck.bind(this),this._sharedState.conf.BUFFER_CHECK_INTERVAL)}return(0,s.default)(e,[{key:"_bufferCheck",value:function(){this._bufferedAmount=c.default.getBufferedAmount(this._mediaElementPlaceholder),this._sharedState.bufferStats.bufferedAmount=this._bufferedAmount,this._sharedState.eventBus.emit(f.default.BufferedAmountObserver.BUFFER_CHECK,this._bufferedAmount)}},{key:"dispose",value:function(){this._bufferCheckInterval.clear()}}]),e}();t.default=h,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(39),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),c=n(4),d=n(191),f=r(d),h=n(2),_=r(h),p=n(50),v=r(p),E=function(){function e(t,n,r){var i=this;(0,s.default)(this,e),this._wasLowBuffer=!1,this._pauseSegmentSchedulingTimestamp=a.default,this._p2pCache=t,this._scheduler=n,this._sharedState=r,this._sharedState.eventBus.once(_.default.Distributor.READY,function(){i._timer=(0,c.createInterval)(i._scheduleChunkDownloads.bind(i),i._sharedState.conf.CHUNK_BATCHING_INTERVAL)}),this._sharedState.conf.ENABLE_TRACK_EDGE_GC_BLOCK&&this._sharedState.eventBus.on(_.default.P2PCache.ATTEMPTED_GC_TRACK_EDGE_FROM_CACHE,function(){i._pauseSegmentScheduling(i._sharedState.conf.P2P_CACHE_GC_TRACK_EDGE_BLOCK_DURATION)})}return(0,l.default)(e,[{key:"dispose",value:function(){this._timer&&this._timer.clear()}},{key:"_pauseSegmentScheduling",value:function(e){var t=Date.now()+e;this._pauseSegmentSchedulingTimestamp=Math.max(this._pauseSegmentSchedulingTimestamp,t)}},{key:"_isSegmentSchedulingPaused",value:function(){return Date.now()<this._pauseSegmentSchedulingTimestamp}},{key:"_scheduleChunkRequestsForSegment",value:function(e,t,n,r){for(var i=this._sharedState.conf.ENABLE_FILTER_BANNED_SEEDERS?t.seeders.allNotBanned():t.seeders.all(),a=i.length,o=0;o<a;o++){for(var s=i[o],u=n.getOrCreate(s);u[r]>0&&t.hasChunksToDownload;){var l=t.chunkManager.getNextChunks(s,u[r],r);u[r]-=l.size,s.requestChunks(e,l.encoded,r,t.chunkManager)}if(!t.hasChunksToDownload)break}}},{key:"_scheduleChunkDownloads",value:function(){for(var e=new f.default(this._sharedState.conf.CHUNK_BATCHING_INTERVAL),t=this._scheduler.getSegmentListToDownload(),n=t.length,r=0;r<n;r++){var i=t[r],a=this._isSegmentSchedulingPaused()?this._p2pCache.getSegmentHandler(i):this._p2pCache.getOrCreateSegmentHandler(i);null!==a&&this._sharedState.isP2PDownloadOn&&a.hasChunksToDownload&&!this._sharedState.isP2PDownloadBlocked&&(this._scheduleChunkRequestsForSegment(i,a,e,v.default.SAFE),this._scheduleChunkRequestsForSegment(i,a,e,v.default.UNSAFE))}}}]),e}();t.default=E,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(67),a=r(i),o=n(8),s=r(o),u=n(16),l=r(u),c=n(0),d=r(c),f=n(1),h=r(f),_=n(64),p=n(5),v=r(p),E=function(){function e(t,n){(0,d.default)(this,e),this._segmentListMap=new l.default,this._conf=n.conf;for(var r=t.getTrackList(),i=0;i<r.length;i++)this._segmentListMap.set(r[i],[])}return(0,h.default)(e,[{key:"insert",value:function(e){var t=this._getMatchingTrack(e);if(t){var n=(0,_.unwrap)(this._segmentListMap.get(t));if(0===n.length)n.push(e);else if(n[0].getId()>e.getId())n.unshift(e);else for(var r=n.length;r>0;r--)if(e.getId()>n[r-1].getId()){n.splice(r,0,e);break}var i=n.length;if(i>this._conf.MAX_DISTRIBUTED_SEGMENT_LIST_LENGTH){var a=n.slice(i-this._conf.MAX_DISTRIBUTED_SEGMENT_LIST_LENGTH);this._segmentListMap.set(t,a)}}}},{key:"getSegmentListAfter",value:function(e){var t=this._getMatchingTrack(e);if(t){var n=(0,_.unwrap)(this._segmentListMap.get(t)),r=n.filter(function(t){return t.getId()>e.getId()});return this._segmentListMap.set(t,r),this._conf.ENABLE_PUSH_SEGMENT_OPTIM?r.slice(0,this._conf.NB_SEGMENT_P2P_PREBUFFER):r}return[]}},{key:"_getMatchingTrack",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=(0,s.default)(this._segmentListMap);!(t=(i=o.next()).done);t=!0){var u=(0,a.default)(i.value,1),l=u[0];if(e.isInTrack(l))return l}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}v.default.notifyError(new Error("Pushed segment belongs to no track"))}}]),e}();t.default=E,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){var t=e.conf.DISTRIBUTOR.URL,n=e.conf.ID_CLIENT,r=e.moduleState.content,i=t+"?customer="+n+"&content="+r+"&version=4.10.14",a={timeout:e.conf.DISTRIBUTOR.TIMEOUT_DELAY,retry:e.conf.DISTRIBUTOR.MAX_RETRY},s=new o.default(o.default.Methods.GET,i,a);e.controlStats.sentDistributorRootCount++,s.isStreamroot=!0,s.send().then(function(t){e.injectConfigFromDistributor(t),e.eventBus.emit(c.default.Distributor.READY,!0)}).catch(function(t){e.conf.DISTRIBUTOR.OVERRIDDEN||(e.setBackendFallbackUrls(),e.eventBus.emit(c.default.Distributor.READY,!1)),u.default.notifyError(new Error("Could not connect to distributor: "+t.message+". Status: "+t.status))})}Object.defineProperty(t,"__esModule",{value:!0});var a=n(48),o=r(a),s=n(5),u=r(s),l=n(2),c=r(l);t.default={connect:i},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(40),i=function(e){return e&&e.__esModule?e:{default:e}}(r),a=function(e){var t=[],n=[],r=e,a={},o=function(e,n){t.push({eventName:e,fn:n}),r.addEventListener(e,n)},s=function(e,t){n.push({eventName:e,fn:t}),window.addEventListener(e,t)},u=function(){for(var e=0;e<t.length;e++){var n=t[e].eventName,i=t[e].fn;r.removeEventListener(n,i)}t=[]},l=function(){for(var e=0;e<n.length;e++){var t=n[e].eventName,r=n[e].fn;window.removeEventListener(t,r)}n=[]},c=function(){u(),l()},d=function(e){function t(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];a[e].arguments=n}return a[e]={arguments:void 0,handler:t},t},f=function(e){r.addEventListener(e,d(e))},h=function(e,t){if(!a[e]||!a[e].arguments)throw new Error("You are trying to trigger an event that have not been cached before");r.removeEventListener(e,a[e].handler),a[e].arguments&&t.apply(void 0,(0,i.default)(a[e].arguments))};this.addMediaEventListener=o,this.addWindowEventListener=s,this.removeAllExternalEventListener=c,this.cacheMediaEvent=f,this.triggerCachedEvent=h};t.default=a,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(102),a=r(i),o=n(67),s=r(o),u=n(40),l=r(u),c=n(8),d=r(c),f=n(16),h=r(f),_=n(0),p=r(_),v=n(1),E=r(v),g=n(221),m=r(g),y=n(89),S=r(y),T=n(2),A=r(T),R=n(5),D=r(R),C=function(){function e(t,n,r){var i=this;(0,p.default)(this,e),this._peerPool=t,this._segmentInfoMap=n,this._sharedState=r,this._segmentHandlers=new h.default,this._sharedState.eventBus.on(A.default.P2PCache.REMOVE_SEGMENT_FROM_CACHE,function(e){i.removeSegmentHandler(e)})}return(0,E.default)(e,[{key:"getSegmentHandler",value:function(e){var t=this._segmentHandlers.get(e.viewToString());return t||null}},{key:"removePeer",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=(0,d.default)(this._segmentHandlers.values());!(t=(i=a.next()).done);t=!0)i.value.seeders.remove(e)}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}}},{key:"getOrCreateSegmentHandler",value:function(e){var t=this.getSegmentHandler(e);return null===t&&(t=new m.default(e,this,this._peerPool,this._segmentInfoMap,this._sharedState),this._segmentHandlers.set(t.segmentCoord.viewToString(),t),this._peerPool.requestHasSegment(e),this._manageP2PCache()),t}},{key:"removeSegmentHandler",value:function(e){var t=e.viewToString(),n=this._segmentHandlers.get(t);n&&(n.dispose(),this._segmentHandlers.delete(t))}},{key:"fillSegment",value:function(e,t){var n=this.getOrCreateSegmentHandler(e),r=n.chunkManager,i=new S.default(t,e,this._sharedState.eventBus);i.setComplete(),r.storeSegment(i),n.seeders.clear(),(this._sharedState.moduleState.isLive()&&this._sharedState.conf.ALLOW_LIVE_PUSH_SEGMENT||!this._sharedState.moduleState.isLive()&&this._sharedState.conf.ALLOW_VOD_PUSH_SEGMENT)&&this._peerPool.broadcastSegmentInfo(e)}},{key:"getPartialSegment",value:function(e){var t=this.getSegmentHandler(e),n=t?t.chunkManager:null;return n?n.getPartialSegment():null}},{key:"listSegmentsToSkipForTrack",value:function(e){return[].concat((0,l.default)(this._segmentHandlers)).filter(function(t){var n=(0,s.default)(t,2),r=(n[0],n[1]);return r.segmentCoord.isInTrack(e)&&!r.chunkManager.shouldDownloadSegment()}).map(function(e){var t=(0,s.default)(e,2);return t[0],t[1].segmentCoord})}},{key:"listSegmentsDownloadStatus",value:function(){return[].concat((0,l.default)(this._segmentHandlers)).map(function(e){var t=(0,s.default)(e,2),n=(t[0],t[1]);return{segmentcoord:n.segmentCoord,downloadStatusList:n.chunkManager.downloadStatus,seederCount:n.seeders.length}})}},{key:"listDownloadedSegmentsForTrack",value:function(e){return[].concat((0,l.default)(this._segmentHandlers)).filter(function(t){var n=(0,s.default)(t,2),r=(n[0],n[1]);return r.segmentCoord.isInTrack(e)&&r.chunkManager.isSegmentDownloaded()}).map(function(e){var t=(0,s.default)(e,2);return t[0],t[1].segmentCoord})}},{key:"getSegmentsStats",value:function(){if(!this._segmentHandlers.size)return{};var e=void 0,t=0,n=a.default,r=!0,i=!1,o=void 0;try{for(var s,u=(0,d.default)(this._segmentHandlers.values());!(r=(s=u.next()).done);r=!0)e=s.value.segmentCoord.getId(),n=Math.min(n,e),t=Math.max(t,e)}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return{minSegmentId:n,maxSegmentId:t}}},{key:"dispose",value:function(){this._segmentHandlers=new h.default}},{key:"_manageP2PCache",value:function(){var e=0,t=this._sharedState.moduleState.isLive()?this._sharedState.conf.LIVE.P2P_CACHE_MAX_SIZE:this._sharedState.conf.P2P_CACHE_MAX_SIZE,n=void 0,r=0,i=!0,a=!1,o=void 0;try{for(var s,u=(0,d.default)(this._segmentHandlers.values());!(i=(s=u.next()).done);i=!0){var l=s.value;if(l.chunkManager.size&&(e+=l.chunkManager.size),e>t){n=this._segmentHandlers.size-r;break}r++}}catch(e){a=!0,o=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw o}}if(n){var c=!0,f=!1,h=void 0;try{for(var _,p=(0,d.default)(this._segmentHandlers.values());!(c=(_=p.next()).done);c=!0){var v=_.value,E=v.segmentCoord;if(0===n)break;var g=this._sharedState.moduleState.videoTrackEdge&&E.viewToString()===this._sharedState.moduleState.videoTrackEdge.viewToString(),m=this._sharedState.moduleState.audioTrackEdge&&E.viewToString()===this._sharedState.moduleState.audioTrackEdge.viewToString();if(this._sharedState.conf.ENABLE_TRACK_EDGE_GC_BLOCK&&(g||m)){D.default.notify("Attempted to remove track edge from P2PCache."),this._sharedState.eventBus.emit(A.default.P2PCache.ATTEMPTED_GC_TRACK_EDGE_FROM_CACHE);break}this.removeSegmentHandler(E),this._segmentInfoMap.removeSegmentInfo(E),n--}}catch(e){f=!0,h=e}finally{try{!c&&p.return&&p.return()}finally{if(f)throw h}}}}}]),e}();t.default=C,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(){(0,a.default)(this,e)}return(0,s.default)(e,[{key:"init",value:function(e,t){this._p2pCache=e,this._scheduler=t}},{key:"getStats",value:function(){var e=this._scheduler.getEdgeSegment();if(e){var t=e.getId(),n=this._p2pCache.getSegmentsStats(),r=n.minSegmentId,i=n.maxSegmentId;return{min:r||t,max:i||t,current:t}}return null}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(2),l=r(u),c=function(){function e(t,n,r,i,o){(0,a.default)(this,e),this._scheduler=t,this._p2pCache=n,this._segmentInfoMap=r,this._distributedSegmentList=i,this._sharedState=o}return(0,s.default)(e,[{key:"_onHasSegment",value:function(e,t,n){var r=n.pushed;if(this._segmentInfoMap.addSegmentInfo(t),r&&this._sharedState.moduleState.isLive()&&(this._sharedState.conf.ENABLE_PUSH_SEGMENT_OPTIM&&!this._scheduler.isSegmentInAcceptableRange(t.segmentCoord)||this._distributedSegmentList.insert(t.segmentCoord)),this._scheduler.isSegmentRequested(t.segmentCoord)){var i=this._p2pCache.getOrCreateSegmentHandler(t.segmentCoord);i.chunkManager.setSegmentSize(t.size),e.isBannedSeeder()&&!this._sharedState.conf.ENABLE_FILTER_BANNED_SEEDERS||i.seeders.add(e)}}},{key:"_onPeerOpen",value:function(){var e=void 0;e=this._sharedState.conf.ENABLE_P2P_SCHEDULER_OPTIM?this._scheduler.getCachedSegmentListToDownload():this._scheduler.getSegmentListToDownload(),this._sharedState.eventBus.emit("segmentInfo",e,this._segmentInfoMap)}},{key:"_onPeerDestroyed",value:function(e){var t=e.remotePeer;this._p2pCache.removePeer(t)}}],[{key:"listenEvents",value:function(t,n,r,i,a){var o=new e(t,n,r,i,a);a.eventBus.on(l.default.PeerPool.PEER_OPEN,o._onPeerOpen.bind(o)),a.eventBus.on("hasSegment",o._onHasSegment.bind(o)),a.eventBus.on(l.default.PeerPool.PEER_DESTROYED,o._onPeerDestroyed.bind(o))}}]),e}();t.default=c,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(30),l=r(u),c=n(5),d=r(c),f=n(4),h=n(17),_=n(24),p=n(174),v=r(p),E=n(35),g=r(E),m=function(){function e(t){var n=this;(0,a.default)(this,e);var r=t.conf,i=t.transferStats,o=t.abrStats;this._conf=r,this._transferStats=i,this._abrStats=o,this._p2pMediaDownloadedDelta=new h.Delta,this._p2pTimeElapsedDelta=new h.Delta(Date.now());var s=r.P2P_SPEED_ESTIMATION_BUCKET_COUNT*r.P2P_SPEED_ESTIMATION_BUCKET_DURATION;this._p2pMediaDownloadedSMWA=new v.default(s),this._p2pMediaDownloadedEMWA=new g.default(0,r.P2P_SPEED_EMA_WEIGHT),this._p2pMediaDownloadedLongSMA=new v.default(r.P2P_USEFUL_SMA_WINDOW),this._p2pMediaDownloadedLongDelta=new h.Delta,this._p2pUsefulLongSMA=new v.default(r.P2P_USEFUL_SMA_WINDOW),this._p2pUsefulLongDelta=new h.Delta,this._timerStore=new l.default,this._ewmaZeroWeight=1-Math.exp(Math.log(.5)*r.MEAN_SPEED_CALCULATION_INTERVAL/r.P2P_SPEED_EMA_ZERO_HALF_LIFE);var u=(0,f.createInterval)(function(){n._computeMeanInstantSpeed()},this._conf.MEAN_SPEED_CALCULATION_INTERVAL),c=(0,f.createInterval)(function(){n._computeDeltaP2PSpeed()},r.P2P_SPEED_ESTIMATION_BUCKET_DURATION),d=(0,f.createInterval)(function(){n._updateUsefulP2PRatio()},this._conf.P2P_USEFUL_CALCULATION_INTERVAL);this._timerStore.register(u),this._timerStore.register(c),this._timerStore.register(d)}return(0,s.default)(e,[{key:"getP2PSpeedEstimate",value:function(){var e=this._p2pMediaDownloadedEMWA.value;return e*(1-this._conf.P2P_USEFUL_RATIO_WEIGHT)+e*this._abrStats.p2pUsefulEstimate*this._conf.P2P_USEFUL_RATIO_WEIGHT}},{key:"_updateUsefulP2PRatio",value:function(){var e=this._p2pUsefulLongDelta.calcDelta(this._transferStats.p2pUseful),t=this._p2pMediaDownloadedLongDelta.calcDelta(this._transferStats.p2pMediaDownloaded);t>0&&(this._p2pMediaDownloadedLongSMA.addPoint(t),this._p2pUsefulLongSMA.addPoint(e));var n=this._p2pMediaDownloadedLongSMA.computeSum(),r=this._p2pUsefulLongSMA.computeSum(),i=8*n/this._conf.P2P_USEFUL_SMA_WINDOW<this._conf.P2P_DL_THRESHOLD_FOR_USEFUL_CORRECTION?1:Math.min(1,r/n);this._abrStats.p2pUsefulEstimate=(0,_.toDecimal)(i,3)}},{key:"_computeMeanInstantSpeed",value:function(){var e=this._p2pMediaDownloadedSMWA.compute();this._abrStats.p2pSpeedWindowsCount++,0===e&&this._abrStats.zeroP2pSpeedWindowsCount++,e<0?d.default.notifyError(new Error("Negative p2pMediaDownloaded delta.")):this._p2pMediaDownloadedEMWA.value<this._conf.P2P_SPEED_ZERO_THRESHOLD?this._p2pMediaDownloadedEMWA.update(e,1):e>0?this._p2pMediaDownloadedEMWA.update(e):0===e&&this._p2pMediaDownloadedEMWA.update(e,this._ewmaZeroWeight),this._abrStats.p2pSpeed=this.getP2PSpeedEstimate()}},{key:"_computeDeltaP2PSpeed",value:function(){var e=this._p2pMediaDownloadedDelta.calcDelta(this._transferStats.p2pMediaDownloaded),t=this._p2pTimeElapsedDelta.calcDelta(Date.now());e>0&&t>0?this._p2pMediaDownloadedSMWA.addPoint(8*e/t):e<0&&d.default.notifyError(new Error("Negative p2pMediaDownloaded delta."))}},{key:"dispose",value:function(){this._timerStore.clearAll()}}]),e}();t.default=m,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),c=n(10),d=r(c),f=n(9),h=r(f),_=n(63),p=r(_),v=function(e){
            function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,a.default)(t)).call(this));return n._segmentCoord=e,n}return(0,h.default)(t,e),(0,l.default)(t,[{key:"getUpdatedRange",value:function(e){return e}},{key:"getFullSegment",value:function(e,t){t(e,this._segmentCoord)}},{key:"isComplete",value:function(){return!1}},{key:"isLocked",value:function(){return!1}},{key:"p2pSpeed",get:function(){return 0}},{key:"p2pAmount",get:function(){return 0}}]),t}(p.default);t.default=v,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),c=n(10),d=r(c),f=n(9),h=r(f),_=n(63),p=r(_),v=n(94),E=r(v),g=function(e){function t(e,n,r,i){function o(e,t){function i(i,a){e.response=i;var o=new E.default(f,i.byteLength,a);r.addSegmentInfo(o),n.fillSegment(f,e.response),t(e,f)}l.callHashWorker(e.response,i)}(0,s.default)(this,t);var u=i.eventBus,l=i.workerHelper,c=(0,d.default)(this,(t.__proto__||(0,a.default)(t)).call(this)),f=e;return c.getFullSegment=function(e,t){u.emit("CDNSegmentDownloaded",f);var n=e.response;i.transferStats.cdnDownloaded+=n.byteLength,o(e,t)},c}return(0,h.default)(t,e),(0,l.default)(t,[{key:"isComplete",value:function(){return!1}},{key:"isLocked",value:function(){return!1}},{key:"getUpdatedRange",value:function(e){return e}},{key:"p2pSpeed",get:function(){return 0}},{key:"p2pAmount",get:function(){return 0}}]),t}(p.default);t.default=g,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),a=r(i),o=n(39),s=r(o),u=n(95),l=r(u),c=n(30),d=r(c),f=n(4),h=n(185),_=r(h),p=n(208),v=r(p),E=n(2),g=r(E),m=n(98),y=r(m),S=n(190),T=r(S),A=n(177),R=r(A),D=n(180),C=r(D),w=n(92),b=r(w),O={EXCLUSION_REMOVED:"removed",EXCLUSION_DISCONNECTED:"disconnected",EXCLUSION_OFFER_DECLINED:"offer_declined",EXCLUSION_CONNECTION_ATTEMPT_TIMED_OUT:"timed_out"},P=function(e,t,n,r,i){var o=i.conf,u=i.status,c=i.peerStats,h=void 0,p=null,E=!1,m=void 0,S=null,A=void 0,D=!1,w=[],P=0,L=s.default,I=new T.default(e,t,i),k=r,N=this,M=i.eventBus,U=i.statsProvider,x=new d.default,F=function(){E=!0,G()},B=function(){E=!1,G()},G=function(e){if(x.clear(p),p=null,!E){var t=Date.now()-L,n=e-t;n>0?(p=(0,f.createTimeout)(z,n),x.register(p)):z()}},H=function(e){if(e.isVideo){var t=!0,n=!1,r=void 0;try{for(var s,u=(0,a.default)(w);!(t=(s=u.next()).done);t=!0)if(s.value.isOnSameTrack()){i.abrStats.trackSwitchWithPeers++;break}}catch(e){n=!0,r=e}finally{try{!t&&u.return&&u.return()}finally{if(n)throw r}}p&&G(o.ASK_PEERS_AFTER_TRACK_SWITCH_INTERVAL)}},j=function(){de()&&N.makeRoom();var e=0,t=0,n=!0,r=!1,i=void 0;try{for(var o,s=(0,a.default)(w);!(n=(o=s.next()).done);n=!0){var u=o.value;u.locked()&&e++,u.isLooser()&&t++}}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}c.locked.updateMetric(e),c.loosers.updateMetric(t);var l=0,d=!0,f=!1,h=void 0;try{for(var _,p=(0,a.default)(w);!(d=(_=p.next()).done);d=!0)_.value.isOnSameTrack()&&l++}catch(e){f=!0,h=e}finally{try{!d&&p.return&&p.return()}finally{if(f)throw h}}M.emit(g.default.PeerPool.PEER_STATS_UPDATE,{peerCount:w.length,sameTrackPeerCount:l})},W=function(){for(var e=0,t=0,n=0;n<w.length;n++){var r=w[n];e+=r.getDlSpeed(),t+=r.getUpSpeed()}u.setDlSpeed(e),u.setUpSpeed(t),u.computeMaxAndAvgSpeed()},V=function(){null!==S&&S.dispose(),S=new v.default(u.getMyPeerId(),this,n,i),A=new R.default(S,i),m=new C.default(this,S,i),h=A.onPeersFromTracker.bind(A),D&&q()},K=function(){p&&(x.clear(p),p=null)},q=function(){if(u.getConnected()&&u.getConnectedToSignalingServer()){var e=Date.now()-L,t=Date.now()-i.moduleState.currentTracks.lastSwitchTimestamp,n=t<e?o.ASK_PEERS_AFTER_TRACK_SWITCH_INTERVAL:o.ASK_PEERS_INTERVAL;G(n),D=!0}},Y=function(e,t){w=l.default.without(w,e),M.emit(g.default.PeerPool.PEER_DESTROYED,{remotePeer:e,peerCount:w.length}),t?(m.addSecondOrderExclusion(e.getId(),o.PEER_REMOVED_EXCLUSION_RANK,o.PEER_REMOVED_EXCLUSION_DURATION,O.EXCLUSION_REMOVED),e.isOnSameTrack()?c.droppedSameTrack++:c.droppedOtherTrack++):m.addSecondOrderExclusion(e.getId(),o.PEER_DISCONNECTED_EXCLUSION_RANK,o.PEER_DISCONNECTED_EXCLUSION_DURATION,O.EXCLUSION_DISCONNECTED)},X=function(e){e.close(!0),w=l.default.without(w,e)},z=function e(){L=Date.now();var t=m.exclusionList;c.exclusionSize=m.secondOrderExclusions.size,I.askPeers(t,h),p=(0,f.createTimeout)(e,o.ASK_PEERS_INTERVAL),x.register(p)},Q=function(){return w.length},Z=function(e){for(var t=0;t<w.length;t++)w[t].requestHasSegment(e)},$=function(){for(;w.length>0;)w[w.length-1].close()},J=function(e,t,r){var a=ee(),o=new _.default(e,n,t,i,a);w.push(o),r?c.openedMatch++:c.openedOffer++,M.emit(g.default.PeerPool.PEER_OPEN,{remotePeer:o,peerCount:w.length}),oe()},ee=function(){for(var e=[],t=0,n=w.length;t<n;t++)e.push(w[t].getUploadCapacity());var r=y.default.median(e);return r?Math.max(r,o.MIN_PEER_UPLOAD_CAPACITY):o.DEFAULT_PEER_UPLOAD_CAPACITY},te=function(){for(var e=0,t=0,n=w.length;t<n;t++)e+=w[t].getUploadCapacity();c.peerPoolUploadCapacity.updateMetric(e)},ne=function(){return w.length>0?w[Math.floor(Math.random()*w.length)].getUploadCapacity():0},re=function(e){m.addSecondOrderExclusion(e,o.OFFER_DECLINED_EXCLUSION_RANK,o.OFFER_DECLINED_EXCLUSION_DURATION,O.EXCLUSION_OFFER_DECLINED),c.denied++},ie=function(e){m.addSecondOrderExclusion(e,o.PEER_CONNECTION_ATTEMPT_EXCLUSION_RANK,o.PEER_CONNECTION_ATTEMPT_TIMED_OUT_EXCLUSION_DURATION,O.EXCLUSION_CONNECTION_ATTEMPT_TIMED_OUT),ae()},ae=function(){++P>o.MAX_PEER_CONNECTION_FAILURES&&(se(),ue())},oe=function(){P=0},se=function(){M.emit(g.default.Tracker.PERM_TRACKER_DISCONNECTION_REQUEST)},ue=function(){M.emit(g.default.Signaling.PERM_SIGNALING_DISCONNECTION_REQUEST)},le=function(e){var t=k.getSegmentInfo(e),n=!0,r=!1,i=void 0;try{for(var o,s=(0,a.default)(w);!(n=(o=s.next()).done);n=!0)o.value.answerHasSegment(t,{pushed:!0})}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}},ce=function(){var e=[],t=[],n=1,r=1,i=!0,o=!1,s=void 0;try{for(var u,l=(0,a.default)(w);!(i=(u=l.next()).done);i=!0){var c=u.value;c.locked()||(c.isLooser()?e.push(c):t.push(c)),n=Math.max(n,c.getUpSpeedEMA()),r=Math.max(r,c.getUsefulDlSpeedEMA())}}catch(e){o=!0,s=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw s}}return{loosers:e,unlocked:t,maxUpSpeed:n,maxDownSpeed:r}},de=function(){return w.length-o.PEER_POOL_LIMIT>0},fe=function(e,t,n){var r=e.getUpSpeedEMA()/t+e.getUsefulDlSpeedEMA()/n;return r},he=function(){u.getEE().removeListener("tracker_ready",V),u.getEE().removeListener("tracker_disconnected",K),u.getEE().removeListener("signaling_ready",q),u.getEE().removeListener("signaling_disconnected",K),null!==S&&S.dispose(),A&&A.dispose(),x.clearAll(),$(),I.dispose()};N.getPeerArray=function(){return w},N.lockedCount=function(){var e=0,t=!0,n=!1,r=void 0;try{for(var i,o=(0,a.default)(w);!(t=(i=o.next()).done);t=!0)i.value.locked()&&e++}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}return e},N.openSlotsCount=function(){return Math.max(o.PEER_POOL_LIMIT-N.lockedCount(),0)},N.makeRoom=function(){var e=ce(),t=e.loosers,n=e.unlocked,r=e.maxUpSpeed,i=e.maxDownSpeed;for(t.sort(function(e,t){return t.getUpSpeedEMA()-e.getUpSpeedEMA()});t.length>0&&de();){var a=t.pop();X(a)}if(de())for(n.sort(function(e,t){return fe(t,r,i)-fe(e,r,i)});n.length>0&&de();){var o=n.pop();X(o)}},N.getPeerCount=Q,N.getPendingConnectionDebugInfos=function(){return S?S.getPendingConnectionDebugInfos():[]},N.requestHasSegment=Z,N.addPeerConnection=J,this.offerDeclined=re,this.connectionAttemptTimeout=ie,N.broadcastSegmentInfo=le,N.dispose=he,function(){var e=(0,f.createInterval)(W,o.SPEED_MONITOR_INTERVAL),t=(0,f.createInterval)(te,o.PEER_UPLOAD_CAPACITY_COMPUTATION_INTERVAL),n=(0,f.createInterval)(j,o.PEER_POOL_MAINTENANCE_INTERVAL);x.register(e),x.register(t),x.register(n),M.on(g.default.Peer.PEER_DISCONNECTED,Y),M.on(g.default.Metrics.TRACK_SWITCH,H,this),M.on(g.default.PeerPool.STOP_ASKING_PEERS,F),M.on(g.default.PeerPool.START_ASKING_PEERS,B),u.getEE().on("tracker_ready",V,N),u.getEE().on("tracker_disconnected",K,N),u.getEE().on("signaling_ready",q,N),u.getEE().on("signaling_disconnected",K,N),U.registerProvider(b.default.PeerStats.SAMPLED_PUC,ne)}()};t.default=P,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var i=n(18),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),c=n(5),d=r(c),f=n(48),h=r(f),_=n(2),p=r(_),v=n(4),E=n(176),g=r(E),m=function(){},y=function(){function e(t,n,r,i,a){var o=r.onProgress,u=void 0===o?m:o,l=r.onError,c=void 0===l?m:l,f=r.onSuccess,h=void 0===f?m:f,_=this;(0,s.default)(this,e),this._firstByteCdnTimestamp=null,this._request=n,this._initialHandlers={onProgress:u,onError:c,onSuccess:h},this._handlers={},this._srModule=t,this._transferStats=a.transferStats,this._controlStats=a.controlStats,this._mediaStats=a.mediaStats,this._abrStats=a.abrStats,this._conf=a.conf,this._eventBus=a.eventBus,this._stats={cdnDownloaded:0,cdnDuration:0,p2pDownloaded:0,p2pDuration:0},this._segmentCoord=i,this._handlers.onSuccess=function(e,t,n){if((0,g.default)(t,_._abrStats,_._conf),_._conf.ENABLE_LATENCY_FEEDBACK){var r=_._stats.latency||_._abrStats.latencyHistoricalValue;t.latency=Math.min(r,Math.ceil((t.cdnDuration+t.p2pDuration)*_._conf.LATENCY_CAPPING_RATIO))}_._transferStats.p2pConsumed+=t.p2pDownloaded,_._transferStats.cdnConsumed+=t.cdnDownloaded;var i=e.slice(0);try{_._initialHandlers.onSuccess(i,t,n)}catch(e){d.default.notifyError(e)}_._eventBus.emit(p.default.SRModuleInterface.ABR_FEEDBACK,t),_._eventBus.emit(p.default.SRModuleInterface.SEGMENT_TRANSFERED_TO_MEDIA_ENGINE)},this._handlers.onError=function(e,t){try{_._initialHandlers.onError(e,t)}catch(e){d.default.notifyError(e)}},this._handlers.onProgress=function(e,t){try{_._initialHandlers.onProgress(e,t)}catch(e){d.default.notifyError(e)}}}return(0,l.default)(e,[{key:"getSegment",value:function(){try{null===this._segmentCoord?this._getFullSegmentFromCDN():(this._partialSegment=this._srModule.getP2PData(this._segmentCoord),this._setP2PStats(),this._partialSegment.isComplete()?(this._conf.ENABLE_LATENCY_FEEDBACK&&(this._stats.latency=Math.min(this._abrStats.latencyHistoricalValue,Math.ceil(this._stats.p2pDuration*this._conf.LATENCY_CAPPING_RATIO))),this._handlers.onProgress(this._stats,this._request),this._getFullP2PSegment()):(this._eventBus.emit(p.default.SRModuleInterface.UNCOMPLETE_SEGMENT_REQUESTED),this._getRemainingRangeFromCDN())),this._controlStats.getSegmentSuccess++}catch(e){d.default.notifyError(e),this._getFullSegmentFromCDN(),this._controlStats.getSegmentFallback++}return{abort:this._abort.bind(this)}}},{key:"_abort",value:function(){this._httpRequest&&this._httpRequest.abort(),this._handlers.onSuccess=m,null!==this._segmentCoord&&this._mediaStats.abortFragmentCount++}},{key:"_getFullP2PSegment",value:function(){var e=this;this._waitSegmentUnlocked(function(t){t?e._fillSegment(null):(e._controlStats.segmentLockTimeout++,e._getFullSegmentFromCDN())})}},{key:"_getRemainingRangeFromCDN",value:function(){var e=this,t=this._getRangeFromRequest();this._fallbackRange=t,this._rangeToDownload=this._partialSegment.getUpdatedRange(t),this._downloadFromCDN(this._rangeToDownload,function(t,n){return t?void e._handlers.onError(t,e._request):void e._fillSegment(n)})}},{key:"_onCDNProgress",value:function(e){var t=Date.now();null===this._firstByteCdnTimestamp&&(this._firstByteCdnTimestamp=t,this._conf.ENABLE_LATENCY_FEEDBACK&&(this._stats.latency=this._firstByteCdnTimestamp-this._startDownloadCdn)),this._stats.cdnDuration=t-this._startDownloadCdn,this._stats.cdnDownloaded=e.loaded;var n={};if((0,a.default)(n,this._stats),this._conf.USE_CONTINOUS_PROGRESS_FEEDBACK)if(e.lengthComputable){var r=e.loaded/e.total;n.p2pDownloaded=Math.round(r*this._stats.p2pDownloaded),n.p2pDuration=Math.round(r*this._stats.p2pDuration)}else n.p2pDownloaded=0,n.p2pDuration=0;this._conf.PROGRESS_ADD_TOTAL&&(n.lengthComputable=e.lengthComputable,n.total=e.lengthComputable?e.total+this._stats.p2pDownloaded:0),this._handlers.onProgress(n,this._request)}},{key:"_downloadFromCDN",value:function(e,t){var n=this,r=h.default.Methods.GET,i={headers:this._getHttpRequestHeaders(e),responseType:h.default.ResponseTypes.ARRAY_BUFFER,withCredentials:!!this._request.withCredentials,events:{onprogress:this._onCDNProgress.bind(this)}};this._httpRequest=new h.default(r,this._request.url,i),this._httpRequest.send().then(function(e){var r=Date.now();n._stats.cdnDownloaded=e.byteLength||0,n._stats.cdnDuration=r-n._startDownloadCdn;var i=n._transferStats.p2pMediaDownloaded-n._p2pAmountOnStart;n._abrStats.concurrentP2pDownloaded+=i,n._abrStats.cdnEstimationCount++,0!==i&&n._abrStats.concurrentP2pDownloadCount++;var a=n._stats.cdnDownloaded+n._stats.p2pDownloaded;if(n._stats.cdnDownloaded/a>=n._conf.ABR_CDN_SPEED_UPDATE_RATIO_THRESHOLD&&n._stats.cdnDownloaded>=n._conf.ABR_CDN_DL_THRESHOLD||a<n._conf.ABR_CDN_DL_THRESHOLD){if(n._conf.CDN_SPEED_ESTIMATE_CONSIDER_P2P){var o=Math.min(n._stats.cdnDownloaded+i,n._stats.cdnDownloaded*n._conf.CDN_CONCURRENT_SCALING_CAP);n._abrStats.cdnSpeed=8*o/n._stats.cdnDuration}else n._abrStats.cdnSpeed=8*n._stats.cdnDownloaded/n._stats.cdnDuration;n._abrStats.cdnTimestamp=Date.now()}t(null,e)}).catch(function(e){t(e,null)}),this._startDownloadCdn=Date.now(),this._p2pAmountOnStart=this._transferStats.p2pMediaDownloaded}},{key:"_getHttpRequestHeaders",value:function(e){var t={},n=this._request.headers;if(n&&void 0!==n.length)throw new Error("Custom headers object should not have a `length` attribute (you might use the previous API format)");return n&&((0,a.default)(t,n),this._rangeToDownload&&delete t.Range),void 0===t.Range&&e&&(t.Range=this._rangeValue(e)),t}},{key:"_rangeValue",value:function(e){return"bytes="+e.start+"-"+(e.end||"")}},{key:"_fillSegment",value:function(e){var t=this,n=!1,r=function(e){return function(r,i){n||(n=!0,e.call(t,r,i))}};try{this._partialSegment.getFullSegment({response:e},r(this._onSuccessAsynchronous),r(this._getFullSegmentFromCDN)),this._controlStats.fillSegmentSuccess++}catch(e){return d.default.notifyError(e),this._getFullSegmentFromCDN(),void this._controlStats.fillSegmentFallback++}(0,v.createTimeout)(function(){n||(n=!0,t._getFullSegmentFromCDN(),t._controlStats.fillSegmentSuccess--,t._controlStats.fillSegmentTimeout++)},this._conf.TIMEOUT_GET_FULL_SEGMENT)}},{key:"_waitSegmentUnlocked",value:function(e){var t=this;if(!this._partialSegment.isLocked())return void e(!0);var n=0,r=(0,v.createInterval)(function(){return t._partialSegment=t._srModule.getP2PData(t._segmentCoord),t._partialSegment.isLocked()?void((n+=t._conf.LOCKED_RETRY_INTERVAL)>t._conf.LOCKED_RETRY_TIMEOUT&&(r.clear(),e(!1))):(r.clear(),void e(!0))},this._conf.LOCKED_RETRY_INTERVAL)}},{key:"_getRangeFromRequest",value:function(){var e=this._request.headers;if(e&&void 0!==e.Range){var t=e.Range.split("="),n=t[1].split("-");return{start:parseInt(n[0],10),end:parseInt(n[1],10)}}}},{key:"_getFullSegmentFromCDN",value:function(){var e=this;this._stats.p2pDownloaded=0,this._stats.p2pDuration=0,this._downloadFromCDN(this._fallbackRange,function(t,n){return t?void e._handlers.onError(t,e._request):void e._handlers.onSuccess(n,e._stats,e._request)})}},{key:"_setP2PStats",value:function(){this._stats.p2pDownloaded=this._partialSegment.p2pAmount,this._stats.p2pDuration=0===this._partialSegment.p2pSpeed?0:Math.round(this._partialSegment.p2pAmount/this._partialSegment.p2pSpeed*1e3)}},{key:"_onSuccessAsynchronous",value:function(e){var t=this;(0,v.createTimeout)(function(){t._handlers.onSuccess(e.response,t._stats,t._request)},0)}}]),e}();e.exports={getSegment:function(e,t,n,r,i){return new y(e,t,n,r,i).getSegment()}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(16),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),c=function(){function e(){(0,s.default)(this,e),this._map=new a.default}return(0,l.default)(e,[{key:"addSegmentInfo",value:function(e){var t=e.segmentCoord.viewToString();this._map.set(t,e)}},{key:"getSegmentInfo",value:function(e){var t=e.viewToString(),n=this._map.get(t);if(!n)throw new Error("segmentInfo not found in the map for the given SegmentCoord");return n}},{key:"removeSegmentInfo",value:function(e){var t=e.viewToString();this._map.delete(t)}}]),e}();t.default=c,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,n){function r(e,t){if(n.isP2PUploadOn&&!n.isP2PUploadBlocked){var r=a.getSegmentHandler(t),o=r?r.chunkManager:null;if(o&&o.getPercentageOfChunksDownloaded()>=n.conf.MIN_CHUNK_PERCENTAGE_DOWNLOADED_FOR_HAS_SEGMENT_ANSWER){var s=i.getSegmentInfo(t);e.answerHasSegment(s,{pushed:!1})}}}var i=e,a=t;n.eventBus.on("segmentRequested",r)};t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(39),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),c=n(126),d=r(c),f=n(21),h=r(f),_=n(189),p=r(_),v=n(219),E=r(v),g=n(216),m=r(g),y=n(215),S=r(y),T=n(214),A=r(T),R=n(218),D=r(R),C=n(217),w=r(C),b=n(213),O=r(b),P=n(93),L=r(P),I=n(86),k=r(I),N=n(183),M=r(N),U=n(226),x=r(U),F=n(49),B=r(F),G=n(202),H=r(G),j=n(2),W=r(j),V=n(235),K=n(231),q=n(239),Y={WS:"ws",WSS:"wss",HTTPS:"https",HTTP:"http"},X=function(){function e(t,n,r,i,o,u,l){(0,s.default)(this,e),this._p2pDownloadBlockExpirationTimestamp=a.default,this._p2pUploadBlockExpirationTimestamp=a.default;var c=B.default.deepCopy(k.default);this.p2pConfig=t,(0,V.overloadP2PConfig)(c,t,r),this.conf=c;var f=(0,K.formatContentId)({contentId:t.contentId,contentUrl:n});this.eventBus=new h.default,this.workerHelper=new x.default,this.moduleState=new M.default(this.eventBus,i,l),this.moduleState.content=f,this.isP2PDownloadOn=!0,this.isP2PUploadOn=!0,this.peerToken=d.default.v4(),this.status=new p.default,this.statsProvider=new L.default,this.peerStats=new D.default(this.statsProvider),this.transferStats=new E.default,this.efficiencyStats=new m.default,this.controlStats=new S.default,this.mediaStats=new w.default(i,o,u),this.abrStats=new O.default(this.eventBus),this.bufferStats=new A.default(this.eventBus),this._backendManager=new H.default(this.conf,this.eventBus)}return(0,l.default)(e,[{key:"blockP2PDownload",value:function(e){var t=Date.now()+e;return t>this._p2pDownloadBlockExpirationTimestamp&&(this._p2pDownloadBlockExpirationTimestamp=t,!0)}},{key:"unblockP2PDownload",value:function(){this._p2pDownloadBlockExpirationTimestamp=a.default}},{key:"blockP2PUpload",value:function(e){var t=Date.now()+e;return t>this._p2pUploadBlockExpirationTimestamp&&(this._p2pUploadBlockExpirationTimestamp=t,!0)}},{key:"unblockP2PUpload",value:function(){this._p2pUploadBlockExpirationTimestamp=a.default}},{key:"injectConfigFromDistributor",value:function(e){e.configuration&&((0,V.overloadConfigFromDistributor)(this.conf,e.configuration,e.isClustered),this.eventBus.emit(W.default.Config.CONFIG_UPDATED));var t=this.conf.BACKEND_USE_SSL?Y.HTTPS:Y.HTTP,n=this.conf.BACKEND_USE_SSL?Y.WSS:Y.WS;this.conf.TRACKER_URL=(0,q.formatUrl)(t+"://"+e.trackerDns),this.conf.ANALYTICS.KLARA_URL=(0,q.formatUrl)(t+"://"+e.klaraDns),this.conf.SIGNALING_URL=(0,q.formatUrl)(n+"://"+e.signalingDns),this.status.setBearerToken(e.token),this._decideIfQOSTester(),null!=e.contentActivated&&(this.conf.CONTENT_ACTIVATED=e.contentActivated)}},{key:"setBackendFallbackUrls",value:function(){var e=this.conf.FALLBACK_URLS;this.conf.ANALYTICS.KLARA_URL=(0,q.formatUrl)(e.KLARA_URL),this._decideIfQOSTester()}},{key:"_decideIfQOSTester",value:function(){var e=this.moduleState.isLive()?this.conf.LIVE.QOS_REF_PERCENTAGE:this.conf.QOS_REF_PERCENTAGE;e===parseFloat(e,3)&&100*Math.random()<e&&(this.conf.QOS_P2P_DISABLED=!0)}},{key:"dispose",value:function(){this.workerHelper.dispose(),this._backendManager.dispose()}},{key:"isP2PDownloadBlocked",get:function(){return Date.now()<this._p2pDownloadBlockExpirationTimestamp}},{key:"isP2PUploadBlocked",get:function(){return Date.now()<this._p2pUploadBlockExpirationTimestamp}}]),e}();t.default=X,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n,r){var i=t.transferStats,a=i.cdnDownloaded,o=i.p2pUseful,s=i.p2pUploaded,u=e?e.getPeerArray().length:0,l={cdn:a,p2p:o,peers:u,upload:s,confLabel:""};if(t.conf.ANALYTICS.EXPOSE_CONF_LABEL){var c=t.conf.QOS_P2P_DISABLED?"off":"on";l.confLabel=t.conf.CONF_LABEL+"|"+c}return l}Object.defineProperty(t,"__esModule",{value:!0});var a=n(252),o=(r(a),n(125));r(o),n(4),t.default={get:i},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(210),l=r(u),c=n(46),d=n(181),f=r(d),h=function(){function e(t,n){(0,a.default)(this,e),this._externalEventManager=t,this._externalEventManager.cacheMediaEvent(f.default.TRACK_CHANGE_EVENT),this._sharedState=n}return(0,s.default)(e,[{key:"listenEvents",value:function(e){var t=this._updateCurrentTracks.bind(this),n=this._onFragLoadAborted.bind(this);this._externalEventManager.addMediaEventListener(f.default.TRACK_CHANGE_EVENT,t),this._externalEventManager.addMediaEventListener(f.default.EMERGENCY_FRAG_LOAD_ABORT,n);try{this._externalEventManager.triggerCachedEvent(f.default.TRACK_CHANGE_EVENT,t)}catch(t){if(!e)throw t}}},{key:"_onFragLoadAborted",value:function(){this._sharedState.mediaStats.emergencyTrackSwitchCount++}},{key:"_updateCurrentTracks",value:function(e){var t=e.audio,n=e.video;t&&(0,c.checkInterface)(l.default,t),n&&(0,c.checkInterface)(l.default,n),this._sharedState.moduleState.currentTracks.update({audio:t,video:n})}},{key:"updateWithSegmentView",value:function(e){var t={};t[e.trackView.type]=e.trackView,this._updateCurrentTracks(t)}}]),e}();t.default=h,e.exports=t.default},function(e,t,n){"use strict";function r(e){var t=!1;e.eventBus.on(a.default.BufferedAmountObserver.BUFFER_CHECK,function(n){n<=e.conf.BUFFER_ZERO_THRESHOLD?t=!1:!t&&n>e.conf.VOD_CRITICAL_BUFFER_THRESHOLD&&(t=!0),t&&n<e.conf.VOD_CRITICAL_BUFFER_THRESHOLD?e.blockP2PDownload(e.conf.VOD_CRITICAL_BUFFER_P2P_STOP_DURATION):n>e.conf.VOD_SAFE_BUFFER_THRESHOLD&&e.unblockP2PDownload()})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(2),a=function(e){return e&&e.__esModule?e:{default:e}}(i);e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(47),l=n(2),c=r(l),d=n(198),f=r(d),h=n(195),_=r(h),p=n(197),v=r(p),E=n(196),g=r(E),m=n(4),y=n(24),S=function(){function e(t,n,r){(0,a.default)(this,e),this._peerCount=0,this._bufferTarget=0,this._bufferedAmount=0,this._randomBufferLevel=null,this._reachedLiveEdge=!1,this._enableDynamicLowerTarget=!1,this._bufferTargetState=v.default.INIT,this._bufferStatus=g.default.ZERO,this._lastLowToModerateBufferTimestamp=null,this._droppedUnderLow=!1,this._reboundCount=0,this._netLowTargetChange=0,this._targetGapSamplerTimeout=null,this._sharedState=r,this._playerInterface=t,this._mediaElementPlaceholder=n,this._bufferStateMachine=new _.default(r.eventBus),this._sharedState.eventBus.on(c.default.Scheduler.REACHED_LIVE_EDGE_STATE_CHANGED,this._onLiveEdgeChanged.bind(this)),this._sharedState.eventBus.on(c.default.SRModuleInterface.UNCOMPLETE_SEGMENT_REQUESTED,this._onUncompleteSegmentRequested.bind(this)),this._sharedState.eventBus.on(c.default.PeerPool.PEER_OPEN,this._onPeerCountChanged.bind(this)),this._sharedState.eventBus.on(c.default.PeerPool.PEER_DESTROYED,this._onPeerCountChanged.bind(this)),this._sharedState.eventBus.on(c.default.BufferedAmountObserver.BUFFER_CHECK,this._bufferCheck.bind(this)),this._sharedState.eventBus.on(c.default.Distributor.READY,this._resetDynamicBufferLevels.bind(this)),this._currentLowerBufferTarget=this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET,this._uploadCapacityCalculator=new f.default(this._sharedState),this._sampleTargetGap(0)}return(0,s.default)(e,[{key:"_sampleTargetGap",value:function(e){this._sharedState.bufferStats.sampledHighLowBufferTargetGap=this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET-this._currentLowerBufferTarget;var t=Math.random()*this._sharedState.conf.ANALYTICS.STATS_INTERVAL;this._targetGapSamplerTimeout=(0,m.createTimeout)(this._sampleTargetGap.bind(this,this._sharedState.conf.ANALYTICS.STATS_INTERVAL-t),e+t)}},{key:"_onUncompleteSegmentRequested",value:function(){this._isLowBufferTarget()&&(this._sharedState.eventBus.emit(c.default.BufferManager.LOW_BUFFER,this._bufferedAmount),this._setHighTarget())}},{key:"_onLiveEdgeChanged",value:function(e){this._reachedLiveEdge=e&&(this._sharedState.moduleState.streamType!==u.StreamTypes.SMOOTH||this._bufferedAmount>this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET-3)}},{key:"_onPeerCountChanged",value:function(e){var t=e.peerCount;this._peerCount=t}},{key:"_bufferCheck",value:function(e){this._bufferedAmount=e,0===this._peerCount?(this._bufferStateMachine.gotoNoPeer(),this._setHighTarget()):this._uploadCapacityCalculator.uploadCapacityEMWA>=this._sharedState.conf.LIVE.UPLOAD_THRESHOLD_MAX_BUFFER_TARGET_LOCKING?(this._bufferStateMachine.gotoTopSeeder(),this._setHighTarget()):null!==this._mediaElementPlaceholder.mediaElement?(this._bufferStateMachine.gotoDynamic(),this._dynamicBufferCheck()):(this._bufferStateMachine.gotoRandom(),this._setRandomTarget());var t=void 0;t=this._reachedLiveEdge||this._bufferedAmount>this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET?g.default.HIGH:this._bufferedAmount>this._currentLowerBufferTarget?g.default.MODERATE:this._bufferedAmount>this._sharedState.conf.LIVE.CRITICAL_LOWER_TARGET_RATIO*this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET?g.default.LOW:this._bufferedAmount>this._sharedState.conf.BUFFER_ZERO_THRESHOLD?g.default.CRITICALLY_LOW:g.default.ZERO,this._bufferedAmount<this._currentLowerBufferTarget&&this._reachedLiveEdge?this._sharedState.bufferStats.timeLowerTargetAboveLiveEdgeStaircase.updateMetric(1):this._sharedState.bufferStats.timeLowerTargetAboveLiveEdgeStaircase.updateMetric(0),this._bufferStatus!==t&&(this._bufferStatusChanged(this._bufferStatus,t),this._bufferStatus=t)}},{key:"_bufferStatusChanged",value:function(e,t){if(this._sharedState.conf.LIVE.ENABLE_DYNAMIC_LOWER_TARGET){if(t===g.default.CRITICALLY_LOW&&this._enableDynamicLowerTarget&&this._adjustLowerTarget((this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET-this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET)*this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET_INCREASE_STEP),e!==g.default.CRITICALLY_LOW&&e!==g.default.LOW||t!==g.default.MODERATE&&t!==g.default.HIGH||(this._lastLowToModerateBufferTimestamp=Date.now()),e!==g.default.MODERATE&&e!==g.default.HIGH||t!==g.default.CRITICALLY_LOW&&t!==g.default.LOW||(this._droppedUnderLow=!0),t===g.default.ZERO&&this._resetDynamicBufferLevels(),t===g.default.HIGH){if(this._enableDynamicLowerTarget=!0,null!=this._lastLowToModerateBufferTimestamp){var n=(Date.now()-this._lastLowToModerateBufferTimestamp)/1e3;this._lastLowToModerateBufferTimestamp=null;var r=(this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET-this._currentLowerBufferTarget)*this._sharedState.conf.LIVE.FAST_BUFFER_FILL_FRACTION;(n<=r||0===r)&&this._adjustLowerTarget(-(this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET-this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET)*this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET_DECREASE_STEP)}this._droppedUnderLow&&this._reboundCount++}this._reboundCount>0&&(this._sharedState.bufferStats.lowerBufferTargetNetChangePerRebound=this._netLowTargetChange/this._reboundCount)}}},{key:"_resetDynamicBufferLevels",value:function(){this._enableDynamicLowerTarget&&this._sharedState.bufferStats.lowerTargetResetCount++;var e=this._isLowBufferTarget();this._enableDynamicLowerTarget=!1,this._currentLowerBufferTarget=this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET,this._droppedUnderLow=!1,e&&this._setLowTarget()}},{key:"_adjustLowerTarget",value:function(e){var t=this._currentLowerBufferTarget,n=this._isLowBufferTarget();this._currentLowerBufferTarget=(0,y.clamp)(this._currentLowerBufferTarget+e,this._sharedState.conf.LIVE.CRITICAL_LOWER_TARGET_RATIO*this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET,this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET),this._netLowTargetChange+=Math.abs(t-this._currentLowerBufferTarget),n&&this._setLowTarget()}},{key:"_dynamicBufferCheck",value:function(){this._isHighBufferTarget()?(this._bufferedAmount>=this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET||this._reachedLiveEdge)&&(this._sharedState.eventBus.emit(c.default.BufferManager.HIGH_BUFFER,this._bufferedAmount),this._setLowTarget()):this._isLowBufferTarget()||this._setHighTarget()}},{key:"_bufferTargetStateChanged",value:function(e){e!==this._bufferTargetState&&(this._bufferTargetState===v.default.LOW&&e===v.default.HIGH?this._sharedState.blockP2PDownload(this._sharedState.conf.LIVE.LOW_TARGET_P2P_DL_BLOCK_DURATION):this._bufferTargetState===v.default.HIGH&&e===v.default.LOW&&this._sharedState.unblockP2PDownload(),this._bufferTargetState=e)}},{key:"_setRandomTarget",value:function(){this._bufferTargetStateChanged(v.default.RANDOM),this._bufferTarget=this._getRandomBufferLevel(),this._playerInterface.setBufferMarginLive(this._bufferTarget)}},{key:"_setHighTarget",value:function(){this._bufferTargetStateChanged(v.default.HIGH),this._bufferTarget=this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET,this._playerInterface.setBufferMarginLive(this._bufferTarget)}},{key:"_setLowTarget",value:function(){this._bufferTargetStateChanged(v.default.LOW),this._bufferTarget=this._currentLowerBufferTarget,this._playerInterface.setBufferMarginLive(this._bufferTarget)}},{key:"_isLowBufferTarget",value:function(){return this._bufferTarget===this._currentLowerBufferTarget}},{key:"_isHighBufferTarget",value:function(){return this._bufferTarget===this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET}},{key:"_getRandomBufferLevel",value:function(){return this._randomBufferLevel=this._randomBufferLevel||Math.floor(Math.random()*(this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET-this._currentLowerBufferTarget+1))+this._currentLowerBufferTarget,this._randomBufferLevel}},{key:"dispose",value:function(){this._uploadCapacityCalculator.dispose(),this._targetGapSamplerTimeout&&this._targetGapSamplerTimeout.clear()}},{key:"bufferTarget",get:function(){return this._bufferTarget}},{key:"bufferedAmount",get:function(){return this._bufferedAmount}},{key:"mediaElementPlaceholder",set:function(e){this._mediaElementPlaceholder=e}},{key:"reachedLiveEdge",get:function(){return this._reachedLiveEdge}}]),e}();t.default=S,e.exports=t.default},function(e,t,n){"use strict";(function(n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,r){var i=r.status,a=function(){for(var n={download:{p2pUseful:r.transferStats.p2pUseful,p2pUploaded:r.transferStats.p2pUploaded,cdnDownloaded:r.transferStats.cdnDownloaded,dlSpeed:i.getDlSpeed(),upSpeed:i.getUpSpeed(),p2pDownloaded:r.transferStats.p2pUseful,p2pDownloadedNewAnalytics:r.transferStats.p2pUseful},peers:{count:0},buffer:{bufferTarget:t?t.bufferTarget:0,bufferedAmount:r.bufferStats.bufferedAmount,reachedLiveEdge:t?t._reachedLiveEdge:void 0},tracker:{connected:i.getConnected()},trackerConnected:i.getConnected(),sigConnected:i.getConnectedToSignalingServer(),isLive:r.moduleState.isLive()},a=[],o=0;o<e.getPeerArray().length;o++){var s=e.getPeerArray()[o];s.getId()&&n.peers.count++,a.push(s.getDebugInfos())}return n.peerList=a,n};!function(){n.SR_DISPLAY_INTERFACE={getStats:a}}(),this.dispose=function(){delete window.SR_DISPLAY_INTERFACE}};t.default=r,e.exports=t.default}).call(t,n(84))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e
        }}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(){(0,a.default)(this,e)}return(0,s.default)(e,[{key:"getSegmentTime",value:function(e){}},{key:"getSegmentList",value:function(e,t,n){}},{key:"getTrackList",value:function(){}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n,r){return r.moduleState.streamType===l.StreamTypes.HLS?new o.default(e,t,n,r):new u.default(e,t,n,r)}Object.defineProperty(t,"__esModule",{value:!0}),t.createScheduler=i;var a=n(212),o=r(a),s=n(211),u=r(s),l=n(47)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=function(e){return e&&e.__esModule?e:{default:e}}(r),a=function(e,t){function n(e,t){var n=r.getSegmentHandler(t.segmentCoord),i=n?n.chunkManager:null;i&&i.getChunk(t.chunkIndex,function(n){n?e.onChunkFound(t,n):e.onChunkMissed()})}var r=e;t.eventBus.on(i.default.UploadQueue.CHUNK_REQUESTED,n)};t.default=a,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){window.Streamroot=window.Streamroot||{},window.Streamroot.Downloader=window.Streamroot.Downloader||e,window.Streamroot.peerAgents=window.Streamroot.peerAgents||{},window.Streamroot.uaHelper=c.default,Object.defineProperty(window.Streamroot,"p2pAvailable",{get:function(){var e=(0,u.default)(window.Streamroot.peerAgents);return e.length?window.Streamroot.peerAgents[e[0]].isP2PEnabled:(0,d.isP2PAvailable)()}})}function a(e,t){window.Streamroot.peerAgents&&(window.Streamroot.peerAgents[e]=t.PublicAPI)}function o(e){window.Streamroot.peerAgents[e]&&delete window.Streamroot.peerAgents[e]}Object.defineProperty(t,"__esModule",{value:!0});var s=n(52),u=r(s),l=n(36),c=r(l),d=n(85);t.default={setup:i,addToPeerAgentList:a,removeFromPeerAgentList:o},e.exports=t.default},function(e,t,n){"use strict";function r(e){var t=e.version,n={version:t,get isP2PEnabled(){return e.isP2PEnabled},get stats(){return e.stats},get p2pDownloadOn(){return e.p2pDownloadOn},set p2pDownloadOn(t){e.p2pDownloadOn=t},get p2pUploadOn(){return e.p2pUploadOn},set p2pUploadOn(t){e.p2pUploadOn=t}};return n}Object.defineProperty(t,"__esModule",{value:!0}),t.default={get:r},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(62),l=r(u),c=function(){function e(t){(0,a.default)(this,e),this._sharedState=t,this._analyticsClient=new l.default(t,"p2pconfig")}return(0,s.default)(e,[{key:"sendConfig",value:function(){var e={};e.activateP2P=this._sharedState.conf.ALLOW_P2P,e.debug=this._sharedState.p2pConfig.debug||!1,e.deviceInfo=this._sharedState.conf.DEVICE_INFO,e.trackerUrl=this._sharedState.conf.TRACKER_URL,e.backendUrl=this._sharedState.conf.DISTRIBUTOR.URL,e.signalingUrl=this._sharedState.conf.SIGNALING_URL,e.analyticsUrl=this._sharedState.conf.ANALYTICS.KLARA_URL,e.vodCacheSize=this._sharedState.conf.P2P_CACHE_MAX_SIZE/1048576,e.liveCacheSize=this._sharedState.conf.LIVE.P2P_CACHE_MAX_SIZE/1048576,e.rangeRequestEnabled=this._sharedState.conf.RANGE_REQUEST_ALLOWED,e.mobileBrowserEnabled=this._sharedState.conf.ENABLE_MOBILE_BROWSER,e.enableStunServers=this._sharedState.conf.ENABLE_STUN;var t={live:this._sharedState.moduleState.isLive(),p2pConfig:e};this._analyticsClient.send(t)}}]),e}();t.default=c,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(2),l=r(u),c=n(4),d=100,f=function(){function e(t,n){(0,a.default)(this,e),this._tickInterval=null,this._sharedState=n,null===t.mediaElement||this._sharedState.moduleState.isLive()||(this._mediaElement=t.mediaElement,this._tickInterval=(0,c.createInterval)(this._tick.bind(this),d))}return(0,s.default)(e,[{key:"_tick",value:function(){if(null!==this._mediaElement){var e=this._mediaElement.duration,t=this._mediaElement.currentTime;e&&e-t<.3&&(null!==this._tickInterval&&(this._tickInterval.clear(),this._tickInterval=null),this._sharedState.eventBus.emit(l.default.Media.ENDED))}}},{key:"dispose",value:function(){null!==this._tickInterval&&this._tickInterval.clear()}}]),e}();t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(48),l=r(u),c=n(5),d=r(c),f=function(){function e(){(0,a.default)(this,e)}return(0,s.default)(e,null,[{key:"send",value:function(e,t,n){var r=n.conf,i=n.status,a={timeout:r.ANALYTICS.TIMEOUT_DELAY,retry:r.ANALYTICS.RETRY_NUMBER,retryDelay:r.ANALYTICS.RETRY_DELAY,headers:{Authorization:i.getBearerToken(),"Content-Type":"application/json;charset=UTF-8"}},o=new l.default(l.default.Methods.POST,e,a);o.isStreamroot=!0,o.send(t).catch(function(e){d.default.notifyError(new Error("Could not send analytics payload: "+e.message+". Status: "+e.status))})}}]),e}();t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(t){(0,a.default)(this,e),this._sharedState=t,this._init()}return(0,s.default)(e,[{key:"_init",value:function(){var e=this;this.reset(),this._sharedState.eventBus.on("p2pUploadToggle",function(t){t||(e._p2pUploadAlwaysOn=!1)}),this._sharedState.eventBus.on("p2pDownloadToggle",function(t){t||(e._p2pDownloadAlwaysOn=!1)})}},{key:"reset",value:function(){this._p2pDownloadAlwaysOn=this._sharedState.isP2PDownloadOn,this._p2pUploadAlwaysOn=this._sharedState.isP2PUploadOn}},{key:"p2pDownloadAlwaysOn",get:function(){return this._p2pDownloadAlwaysOn}},{key:"p2pUploadAlwaysOn",get:function(){return this._p2pUploadAlwaysOn}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(66),l=r(u),c=n(24),d=n(2),f=r(d),h=function(){function e(t){(0,a.default)(this,e),this._peerCountStaircaseFunctionIntegral=new l.default,this._sameTrackPeerCountStaircaseFunctionIntegral=new l.default,this._abovePeerPoolLimitPeerCount=new l.default,this._abovePeerPoolLimitTime=new l.default,this._sharedState=t,t.eventBus.on(f.default.PeerPool.PEER_STATS_UPDATE,this._processPeerPoolStats,this),t.eventBus.on(f.default.PeerPool.PEER_OPEN,this._trackPeerCount,this),t.eventBus.on(f.default.PeerPool.PEER_DESTROYED,this._trackPeerCount,this)}return(0,s.default)(e,[{key:"_trackPeerCount",value:function(e){var t=e.peerCount,n=Math.max(0,t-this._sharedState.conf.PEER_POOL_LIMIT);this._abovePeerPoolLimitPeerCount.updateMetric(n),this._abovePeerPoolLimitTime.updateMetric(n>0?1:0)}},{key:"_processPeerPoolStats",value:function(e){var t=e.peerCount,n=e.sameTrackPeerCount;this._peerCountStaircaseFunctionIntegral.updateMetric(t),this._sameTrackPeerCountStaircaseFunctionIntegral.updateMetric(n)}},{key:"getAveragePeerCount",value:function(){return(0,c.toDecimal)(this._peerCountStaircaseFunctionIntegral.getAverage(),2)}},{key:"getSameTrackPeerCount",value:function(){return(0,c.toDecimal)(this._sameTrackPeerCountStaircaseFunctionIntegral.getAverage(),2)}},{key:"getUncorrectedAverageAboveLimitPeerCount",value:function(){return this._abovePeerPoolLimitPeerCount.getAverage()}},{key:"getAbovePeerPoolLimitTime",value:function(){return this._abovePeerPoolLimitTime.getIntegral().value}}]),e}();t.default=h,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(18),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),c=n(62),d=r(c),f=n(162),h=r(f),_=n(161),p=r(_),v=n(17),E=n(24),g=n(166),m=r(g),y=function(){function e(t,n){(0,s.default)(this,e);var r=n.conf,i=n.moduleState,a=n.status,o=n.transferStats,u=n.efficiencyStats,l=n.controlStats,c=n.bufferStats,f=n.abrStats;this._conf=r,this._status=a,this._transferStats=o,this._efficiencyStats=u,this._controlStats=l,this._abrStats=f,this._moduleState=i,this._bufferStats=c,this._analyticsClient=new d.default(n,"stats"),this._peerStats=n.peerStats,this._mediaStats=n.mediaStats,this._sessionStartTime=Date.now(),this._p2pUseful=new v.Delta,this._cdnDownloaded=new v.Delta,this._p2pConsumed=new v.Delta,this._cdnConsumed=new v.Delta,this._p2pMediaDownloaded=new v.Delta,this._p2pMessagesDownloaded=new v.Delta,this._p2pHeadersDownloaded=new v.Delta,this._p2pMessagesCount=new v.Delta,this._p2pUploaded=new v.Delta,this._PP=new v.Delta,this._PC=new v.Delta,this._CP=new v.Delta,this._CC=new v.Delta,this._HP=new v.Delta,this._HD=new v.Delta,this._M=new v.Delta,this._total=new v.Delta,this._concurrentP2pDownloaded=new v.Delta,this._concurrentP2pDownloadCount=new v.Delta,this._cdnEstimationCount=new v.Delta,this._p2pSpeedWindowsCount=new v.Delta,this._zeroP2pSpeedWindowsCount=new v.Delta,this._peerPoolObserver=new h.default(n),this._optionsObserver=new p.default(n),this._receivedChunkRequest=new v.Delta,this._missedDequeuedChunkRequest=new v.Delta,this._dequeuedReceivedChunkRequest=new v.Delta,this._sentSafeChunkRequest=new v.Delta,this._sentUnsafeChunkRequest=new v.Delta,this._timeoutSentSafeChunkRequest=new v.Delta,this._timeoutSentUnsafeChunkRequest=new v.Delta,this._gracedChunk=new v.Delta,this._expiredGraceChunk=new v.Delta,this._openedMatch=new v.Delta,this._openedOffer=new v.Delta,this._match=new v.Delta,this._excessMatch=new v.Delta,this._unansweredOffer=new v.Delta,this._offer=new v.Delta,this._active=new v.Delta,this._transfer=new v.Delta,this._denied=new v.Delta,this._droppedSameTrack=new v.Delta,this._droppedOtherTrack=new v.Delta,this._offerTimeout=new v.Delta,this._answerTimeout=new v.Delta,this._timeoutNewConnection=new v.Delta,this._timeoutCheckingConnection=new v.Delta,this._timeoutFailedConnection=new v.Delta,this._timeoutNewIce=new v.Delta,this._timeoutGatheringIce=new v.Delta,this._timeoutCompleteIce=new v.Delta,this._disconnected=new v.Delta,this._lateMessage=new v.Delta,this._timeoutLocalSdp=new v.Delta,this._timeoutRemoteSdp=new v.Delta,this._timeoutLocalSdpWithStun=new v.Delta,this._timeoutRemoteSdpWithStun=new v.Delta,this._timeoutWithLocalStunIce=new v.Delta,this._timeoutWithRemoteStunIce=new v.Delta,this._missedIceCandidate=new v.Delta,this._gatheredIceCandidate=new v.Delta,this._iceCandidatesBucket=new v.Delta,this._earlyIceGatheringFinished=new v.Delta,this._p2pSgtCheckSuccess=new v.Delta,this._p2pSgtCheckFail=new v.Delta,this._hybridSgtCheckSuccess=new v.Delta,this._hybridSgtCheckFail=new v.Delta,this._checkHeartbeatFailed=new v.Delta,this._getSegmentSuccess=new v.Delta,this._getSegmentFallback=new v.Delta,this._segmentLockTimeout=new v.Delta,this._fillSegmentSuccess=new v.Delta,this._fillSegmentFallback=new v.Delta,this._fillSegmentTimeout=new v.Delta,this._counterControl=0,this._sentOfferSdpVolume=new v.Delta,this._sentAnswerSdpVolume=new v.Delta,this._sentIceCandidatesVolune=new v.Delta,this._signalingMessageCount=new v.Delta,this._sentDistributorRootCount=new v.Delta,this._sentTrackerInitCount=new v.Delta,this._sentTrackerPeersCount=new v.Delta,this._sentTrackerTracksCount=new v.Delta,this._timeSpentOnEdge=new v.Delta,this._timeSpentStatic=new v.Delta,this._timeSpentLow=new v.Delta,this._timeSpentHigh=new v.Delta,this._bufferedAmount=new v.Delta,this._bufferRefill=new v.Delta,this._lowerTargetResetCount=new v.Delta,this._abortFragmentCount=new v.Delta,this._emergencyTrackSwitchCount=new v.Delta,this._qosAnalyticsHandler=new m.default(t,n),this._feebackCount=new v.Delta,this._zeroDurationFeedbackCount=new v.Delta,this._lastPayloadTimestamps={},this._trackSwitchWithPeers=new v.Delta,this._sharedState=n}return(0,l.default)(e,[{key:"_getSessionDuration",value:function(){return Date.now()-this._sessionStartTime}},{key:"_getTimespanSinceLastPayload",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";return isNaN(this._lastPayloadTimestamps[e])?this._getSessionDuration():Date.now()-this._lastPayloadTimestamps[e]}},{key:"_updateLastPayloadTimestamp",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main";this._lastPayloadTimestamps[e]=Date.now()}},{key:"_getPeerStats",value:function(){var e=this._peerPoolObserver.getUncorrectedAverageAboveLimitPeerCount(),t=this._peerPoolObserver.getAbovePeerPoolLimitTime(),n=this._peerStats.dataChannelBufferEmptyingStats.fetchSample();return e=t>0?e*this._getTimespanSinceLastPayload()/t:0,{count:this._peerPoolObserver.getAveragePeerCount(),sameTrackCount:this._peerPoolObserver.getSameTrackPeerCount(),match:this._match.calcDelta(this._peerStats.match),excessMatch:this._excessMatch.calcDelta(this._peerStats.excessMatch),openedMatch:this._openedMatch.calcDelta(this._peerStats.openedMatch),openedOffer:this._openedOffer.calcDelta(this._peerStats.openedOffer),unansweredOffer:this._unansweredOffer.calcDelta(this._peerStats.unansweredOffer),offer:this._offer.calcDelta(this._peerStats.offer),locked:this._peerStats.locked.getAverage(),loosers:this._peerStats.loosers.getAverage(),active:this._active.calcDelta(this._peerStats.active),transfer:this._transfer.calcDelta(this._peerStats.transfer),denied:this._denied.calcDelta(this._peerStats.denied),droppedSameTrack:this._droppedSameTrack.calcDelta(this._peerStats.droppedSameTrack),droppedOtherTrack:this._droppedOtherTrack.calcDelta(this._peerStats.droppedOtherTrack),offerTimeout:this._offerTimeout.calcDelta(this._peerStats.offerTimeout),answerTimeout:this._answerTimeout.calcDelta(this._peerStats.answerTimeout),timeoutNewConnection:this._timeoutNewConnection.calcDelta(this._peerStats.timeoutNewConnection),timeoutCheckingConnection:this._timeoutCheckingConnection.calcDelta(this._peerStats.timeoutCheckingConnection),timeoutFailedConnection:this._timeoutFailedConnection.calcDelta(this._peerStats.timeoutFailedConnection),timeoutNewIce:this._timeoutNewIce.calcDelta(this._peerStats.timeoutNewIce),timeoutGatheringIce:this._timeoutGatheringIce.calcDelta(this._peerStats.timeoutGatheringIce),timeoutCompleteIce:this._timeoutCompleteIce.calcDelta(this._peerStats.timeoutCompleteIce),disconnected:this._disconnected.calcDelta(this._peerStats.disconnected),lateMessage:this._lateMessage.calcDelta(this._peerStats.lateMessage),sampledPUC:this._peerStats.sampledPUC,peerPoolUploadCapacity:this._peerStats.peerPoolUploadCapacity.getAverage(),exclusionSize:this._peerStats.exclusionSize,successPeerConnectionAttemptDuration:this._peerStats.successPeerConnectionAttemptDuration.fetchSample()||0,failedPeerConnectionAttemptDuration:this._peerStats.failedPeerConnectionAttemptDuration.fetchSample()||0,dataChannelBufferEmptyingTime:n?n.time:0,dataChannelBufferEmptyingAmount:n?n.amount:0,timeSpentAbovePeerLimit:t,averageOverLimitPeerCount:e,timeoutLocalSdp:this._timeoutLocalSdp.calcDelta(this._peerStats.timeoutLocalSdp),timeoutRemoteSdp:this._timeoutRemoteSdp.calcDelta(this._peerStats.timeoutRemoteSdp),timeoutLocalSdpWithStun:this._timeoutLocalSdpWithStun.calcDelta(this._peerStats.timeoutLocalSdpWithStun),timeoutRemoteSdpWithStun:this._timeoutRemoteSdpWithStun.calcDelta(this._peerStats.timeoutRemoteSdpWithStun),timeoutWithLocalStunIce:this._timeoutWithLocalStunIce.calcDelta(this._peerStats.timeoutWithLocalStunIce),timeoutWithRemoteStunIce:this._timeoutWithRemoteStunIce.calcDelta(this._peerStats.timeoutWithRemoteStunIce)}}},{key:"_getBufferStats",value:function(){if(this._bufferStats){var e=(0,E.toDecimal)(this._bufferStats.getTimeSpentOnEdgeRatio(),2),t=(0,E.toDecimal)(this._bufferStats.getTimeSpentWithoutPeerRatio(),2),n=(0,E.toDecimal)(this._bufferStats.getTimeSpentTopSeederRatio(),2),r=this._bufferStats.getTimeSpentDynamicIntegral(),i=r.intervalLength?(0,E.toDecimal)(r.value/r.intervalLength,2):(0,E.toDecimal)(r.value,2),a=(0,E.toDecimal)(1e3*this._bufferRefill.calcDelta(this._bufferStats.bufferRefill)/(r.value+this._bufferStats.bufferedAmount),2),o=this._bufferStats.alwaysDynamicBuffer,s=(0,E.toDecimal)(this._bufferStats.lowerBufferTargetNetChangePerRebound,2),u=this._bufferStats.sampledHighLowBufferTargetGap,l=(0,E.toDecimal)(this._bufferStats.timeLowerTargetAboveLiveEdgeStaircase.getAverage(),2);return{bufferState:this._bufferStats.bufferState,alwaysDynamicBuffer:o,timeSpentOnEdgeRatio:e,timeSpentWithoutPeerRatio:t,timeSpentDynamicRatio:i,timeSpentTopSeederRatio:n,bufferRefillRatio:a,lowerBufferTargetNetChangePerRebound:s,timeLowerTargetAboveLiveEdgeRatio:l,sampledHighLowBufferTargetGap:u,lowerTargetResetCount:this._lowerTargetResetCount.calcDelta(this._bufferStats.lowerTargetResetCount)}}}},{key:"_getAbrStats",value:function(){var e=this._abrStats.p2pUsefulEstimate,t=this._concurrentP2pDownloaded.calcDelta(this._abrStats.concurrentP2pDownloaded),n=this._concurrentP2pDownloadCount.calcDelta(this._abrStats.concurrentP2pDownloadCount),r=this._cdnEstimationCount.calcDelta(this._abrStats.cdnEstimationCount),i=this._p2pSpeedWindowsCount.calcDelta(this._abrStats.p2pSpeedWindowsCount),a=this._zeroP2pSpeedWindowsCount.calcDelta(this._abrStats.zeroP2pSpeedWindowsCount),o=this._abrStats.bandwidthEstimateCV,s=this._feebackCount.calcDelta(this._abrStats.feebackCount),u=this._zeroDurationFeedbackCount.calcDelta(this._abrStats.zeroDurationFeedbackCount),l=this._trackSwitchWithPeers.calcDelta(this._abrStats.trackSwitchWithPeers);return this._abrStats.flushBandwidthEstimates(),{p2pUsefulEstimate:e,concurrentP2pDownloaded:t,concurrentP2pDownloadCount:n,cdnEstimationCount:r,p2pSpeedWindowsCount:i,zeroP2pSpeedWindowsCount:a,bandwidthEstimateCV:o,feebackCount:s,zeroDurationFeedbackCount:u,trackSwitchWithPeers:l}}},{key:"_calculateStatsPayload",value:function(){var e=this._status.getConnectedToSignalingServer(),t=this._status.getConnected(),n=this._status.getTrackerVersion(),r=this._status.getTrackerId(),i={PP:this._transferStats.multipleDlPP,PC:this._transferStats.multipleDlPC,CP:this._transferStats.multipleDlCP,CC:this._transferStats.multipleDlCC,HP:this._transferStats.multipleDlHP,HD:this._transferStats.multipleDlHD,M:this._transferStats.multipleDlM},o=i.PP+i.PC+i.CP+i.CC+i.HP+i.HD+i.M,s=this._cdnDownloaded.calcDelta(this._transferStats.cdnDownloaded),u=s,l=this._p2pUseful.calcDelta(this._transferStats.p2pUseful),c=this._p2pConsumed.calcDelta(this._transferStats.p2pConsumed),d=this._cdnConsumed.calcDelta(this._transferStats.cdnConsumed),f=this._p2pMediaDownloaded.calcDelta(this._transferStats.p2pMediaDownloaded),h=this._p2pHeadersDownloaded.calcDelta(this._transferStats.p2pHeadersDownloaded),_=this._p2pMessagesDownloaded.calcDelta(this._transferStats.p2pMessagesDownloaded),p=this._p2pMessagesCount.calcDelta(this._transferStats.p2pMessagesCount),v=this._p2pUploaded.calcDelta(this._transferStats.p2pUploaded),g={p2pMediaDownloaded:f,p2pHeadersDownloaded:h,p2pMessagesDownloaded:_,p2pMessagesCount:p,cdnDownloaded:s,p2pUseful:l,cdnUseful:u,p2pConsumed:c,cdnConsumed:d,p2pUploaded:v,multipleDl:{PP:this._PP.calcDelta(i.PP),PC:this._PC.calcDelta(i.PC),CP:this._CP.calcDelta(i.CP),CC:this._CC.calcDelta(i.CC),HP:this._HP.calcDelta(i.HP),HD:this._HD.calcDelta(i.HD),M:this._M.calcDelta(i.M),total:this._total.calcDelta(o)}},m=this._receivedChunkRequest.calcDelta(this._efficiencyStats.receivedChunkRequestCount),y=this._dequeuedReceivedChunkRequest.calcDelta(this._efficiencyStats.dequeuedReceivedChunkRequestCount),S=this._missedDequeuedChunkRequest.calcDelta(this._efficiencyStats.missedDequeuedChunkRequestCount),T=this._sentSafeChunkRequest.calcDelta(this._efficiencyStats.safeChunkRequestCount),A=this._sentUnsafeChunkRequest.calcDelta(this._efficiencyStats.unsafeChunkRequestCount),R=this._timeoutSentSafeChunkRequest.calcDelta(this._efficiencyStats.safeChunkRequestTimeoutCount),D=this._timeoutSentUnsafeChunkRequest.calcDelta(this._efficiencyStats.unsafeChunkRequestTimeoutCount),C=this._getTimespanSinceLastPayload(),w=C>0?Math.round(m*this._conf.CHUNK_SIZE*8/C):0,b=C>0?Math.round((T+A)*this._conf.CHUNK_SIZE*8/C):0,O=this._gracedChunk.calcDelta(this._efficiencyStats.gracedChunksCount),P=this._expiredGraceChunk.calcDelta(this._efficiencyStats.expiredGraceChunksCount),L={receivedChunkRequestBitrate:w,sentChunkRequestBitrate:b,receivedChunkRequestsMissedRatio:y>0?(0,E.toDecimal)(S/y,2):0,sentSafeChunkRequests:T,sentUnsafeChunkRequests:A,sentSafeChunkRequestsTimeout:R,sentUnsafeChunkRequestsTimeout:D,uploadQueueExpirationRatio:m>0?(0,E.toDecimal)(1-y/m,2):0,gracedChunks:O,expiredGraceChunks:P},I=this._abortFragmentCount.calcDelta(this._mediaStats.abortFragmentCount),k=this._emergencyTrackSwitchCount.calcDelta(this._mediaStats.emergencyTrackSwitchCount),N={emergencyTrackSwitchCPM:k/(C/6e4)};this._qosAnalyticsHandler.initialized&&(N=(0,a.default)(N,this._qosAnalyticsHandler.getQoSAnalytics()));var M=this._moduleState.isAlwaysDvr&&this._moduleState.isLive();this._moduleState.resetIsAlwaysDvr();var U={transfers:g,efficiency:L,qos:N,peers:this._getPeerStats(),buffer:this._getBufferStats(),abr:this._getAbrStats(),live:this._moduleState.isLive(),signalingServerConnected:e,trackerConnected:t,trackerVersion:n,trackerId:r,sessionDuration:this._getSessionDuration(),timespan:C,options:{p2pDownloadAlwaysOn:this._optionsObserver.p2pDownloadAlwaysOn,p2pUploadAlwaysOn:this._optionsObserver.p2pUploadAlwaysOn},confLabel:this._conf.CONF_LABEL,qosTester:this._conf.QOS_P2P_DISABLED,mediaDuration:Math.round(this._mediaStats.duration),videoTrackCount:this._mediaStats.videoTrackCount,minBitrate:this._mediaStats.minBitrate,maxBitrate:this._mediaStats.maxBitrate,abortFragmentCount:I,isAlwaysDvr:M};return this._updateLastPayloadTimestamp(),this._optionsObserver.reset(),U}},{key:"_calculateControlPayload",value:function(){var e=this._missedIceCandidate.calcDelta(this._controlStats.missedIceCandidateCount),t=this._gatheredIceCandidate.calcDelta(this._controlStats.gatheredIceCandidateCount),n=this._iceCandidatesBucket.calcDelta(this._controlStats.iceCandidatesBucketCount),r=this._earlyIceGatheringFinished.calcDelta(this._controlStats.earlyIceGatheringFinishedCount),i=n>0?(0,E.toDecimal)(e/n,2):0,a=n>0?(0,E.toDecimal)(t/n,2):0,o=n>0?r/n:0,s=this._controlStats.getSampledIceGatheringDuration(),u=this._p2pSgtCheckSuccess.calcDelta(this._controlStats.nbRightHashP2P),l=this._p2pSgtCheckFail.calcDelta(this._controlStats.nbWrongHashP2P),c=this._hybridSgtCheckSuccess.calcDelta(this._controlStats.nbRightHashDLM),d=this._hybridSgtCheckFail.calcDelta(this._controlStats.nbWrongHashDLM),f=this._checkHeartbeatFailed.calcDelta(this._controlStats.checkHeartbeatFailed),h=this._getSegmentSuccess.calcDelta(this._controlStats.getSegmentSuccess),_=this._getSegmentFallback.calcDelta(this._controlStats.getSegmentFallback),p=this._segmentLockTimeout.calcDelta(this._controlStats.segmentLockTimeout),v=this._fillSegmentSuccess.calcDelta(this._controlStats.fillSegmentSuccess),g=this._fillSegmentFallback.calcDelta(this._controlStats.fillSegmentFallback),m=this._fillSegmentTimeout.calcDelta(this._controlStats.fillSegmentTimeout),y=this._sentOfferSdpVolume.calcDelta(this._controlStats.sentOfferSdpVolume),S=this._sentAnswerSdpVolume.calcDelta(this._controlStats.sentAnswerSdpVolume),T=this._sentIceCandidatesVolune.calcDelta(this._controlStats.sentIceCandidatesVolume),A=this._signalingMessageCount.calcDelta(this._controlStats.signalingMessagesCount),R=this._sentDistributorRootCount.calcDelta(this._controlStats.sentDistributorRootCount),D=this._sentTrackerInitCount.calcDelta(this._controlStats.sentTrackerInitCount),C=this._sentTrackerPeersCount.calcDelta(this._controlStats.sentTrackerPeersCount),w=this._sentTrackerTracksCount.calcDelta(this._controlStats.sentTrackerTracksCount),b={live:this._moduleState.isLive(),meanMissedIceCandidate:i,meanGatheredIceCandidate:a,earlyIceCandidateGatheringRatio:o,sampledIceGatheringDuration:s,p2pSgtCheckSuccess:u,p2pSgtCheckFail:l,hybridSgtCheckSuccess:c,hybridSgtCheckFail:d,checkHeartbeatFailed:f,getSegmentSuccess:h,getSegmentFallback:_,segmentLockTimeout:p,fillSegmentSuccess:v,fillSegmentFallback:g,fillSegmentTimeout:m,sessionDuration:this._getSessionDuration(),timespan:this._getTimespanSinceLastPayload("control"),confLabel:this._conf.CONF_LABEL,sentOfferSdpVolume:y,sentAnswerSdpVolume:S,sentIceCandidatesVolume:T,signalingMessagesCount:A,sentDistributorRootCount:R,sentTrackerInitCount:D,sentTrackerPeersCount:C,sentTrackerTracksCount:w};return this._updateLastPayloadTimestamp("control"),b}},{key:"sendStats",value:function(){var e=this._calculateStatsPayload();e.timespan<2*this._conf.ANALYTICS.STATS_INTERVAL&&this._analyticsClient.send(e)}},{key:"sendControl",value:function(){var e=this._calculateControlPayload();e.timespan<2*this._conf.ANALYTICS.CONTROL_INTERVAL&&this._analyticsClient.send(e,"control")}},{key:"dispose",value:function(){this._qosAnalyticsHandler.dispose()}}]),e}();t.default=y,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(62),l=r(u),c=n(17),d=n(2),f=r(d),h=function(){function e(t){var n=this;(0,a.default)(this,e);var r=t.moduleState,i=t.transferStats,o=t.eventBus;this._analyticsClient=new l.default(t,"traffic"),this._moduleState=r,this._transferStats=i,this._p2p=new c.Delta,this._cdn=new c.Delta,this._upload=new c.Delta,this._lastPayloadTimestamp=Date.now(),o.once(f.default.Media.ENDED,this.sendUsage.bind(this)),o.on(f.default.TrafficAnalytics.STOP_SENDING_USAGE,function(){n._disconnected=!0}),o.on(f.default.TrafficAnalytics.RESTART_SENDING_USAGE,function(){n._disconnected=!1})}return(0,s.default)(e,[{key:"_calculateUsagePayload",value:function(){var e=this._p2p.calcDelta(this._transferStats.p2pUseful),t=this._cdn.calcDelta(this._transferStats.cdnDownloaded),n=this._upload.calcDelta(this._transferStats.p2pUploaded),r=this._getTimespanSinceLastPayload(),i={live:this._moduleState.isLive(),cdn:t,p2p:e,upload:n,timespan:r};return this._updateLastPayloadTimestamp(),i}},{key:"_getTimespanSinceLastPayload",value:function(){return Date.now()-this._lastPayloadTimestamp}},{key:"_updateLastPayloadTimestamp",value:function(){this._lastPayloadTimestamp=Date.now()}},{key:"sendUsage",value:function(e){if(!this._disconnected){var t=this._calculateUsagePayload();e&&(t.unload=!0),this._analyticsClient.send(t,"usage")}}}]),e}();t.default=h,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(17),l=n(24),c=function(){function e(){(0,a.default)(this,e),this._timeSpentPlayingDelta=new u.Delta,this._timeSpentPausedDelta=new u.Delta,this._timeSpentRebufferingDelta=new u.Delta,this._timeSpentRebufferingWithBufferDelta=new u.Delta,this._timeSpentSeekingDelta=new u.Delta,this._timeSpentEndedDelta=new u.Delta,this._rebufferingCountDelta=new u.Delta,this._rebufferingWithBufferCountDelta=new u.Delta,this._lastTimeDelta=new u.Delta(Date.now()),this._droppedFrameCountDelta=new u.Delta,this._trackSwitchCountDelta=new u.Delta}return(0,s.default)(e,[{key:"_normalizePerMinute",value:function(e,t,n,r){var i=this._lastTimeDelta.calcDelta(Date.now()),a=this._rebufferingCountDelta.calcDelta(e),o=a/(i/6e4),s=this._rebufferingWithBufferCountDelta.calcDelta(t),u=s/(i/6e4),c=this._droppedFrameCountDelta.calcDelta(n),d=c/(i/6e4),f=this._trackSwitchCountDelta.calcDelta(r),h=f/(i/6e4);return{rebufferingCPM:(0,l.toDecimal)(o,2),rebufferingWithBufferCPM:(0,l.toDecimal)(u,2),droppedFrameCPM:(0,l.toDecimal)(d,2),trackSwitchCPM:(0,l.toDecimal)(h,2)}}},{key:"format",value:function(e,t){var n=this._normalizePerMinute(e.rebufferingCount,e.rebufferingCountWithBuffer,e.droppedFrameCount,t);return{rebufferingCPM:n.rebufferingCPM,rebufferingWithBufferCPM:n.rebufferingWithBufferCPM,droppedFrameCPM:n.droppedFrameCPM,trackSwitchCPM:n.trackSwitchCPM,timeSpentPlaying:(0,l.toDecimal)(this._timeSpentPlayingDelta.calcDelta(e.timeSpentPlaying),2),timeSpentPaused:(0,l.toDecimal)(this._timeSpentPausedDelta.calcDelta(e.timeSpentPaused),2),timeSpentEnded:(0,l.toDecimal)(this._timeSpentEndedDelta.calcDelta(e.timeSpentEnded),2),timeSpentRebuffering:(0,l.toDecimal)(this._timeSpentRebufferingDelta.calcDelta(e.timeSpentRebuffering),2),timeSpentRebufferingWithBuffer:(0,l.toDecimal)(this._timeSpentRebufferingWithBufferDelta.calcDelta(e.timeSpentRebufferingWithBuffer),2),timeSpentSeeking:(0,l.toDecimal)(this._timeSpentSeekingDelta.calcDelta(e.timeSpentSeeking),2),startupTime:e.startupTime,endedOnce:e.endedOnce}}}]),e}();t.default=c,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(125),l=r(u),c=n(165),d=r(c),f=n(4),h=n(2),_=r(h),p=function(){function e(t,n){(0,a.default)(this,e),this._trackSwitchCount=-1,n.eventBus.on(_.default.Metrics.TRACK_SWITCH,this._onTrackSwitch.bind(this)),null!==t.mediaElement&&(this._initialized=!0,this._qosAnalytics=new l.default(t.mediaElement,f.createInterval),this._qoSAnalyticsFormatter=new d.default)}return(0,s.default)(e,[{key:"_onTrackSwitch",value:function(){this._trackSwitchCount++}},{key:"getQoSAnalytics",value:function(){if(!this._initialized)throw new Error("getQoSAnalytics was called on non-initialized QoSAnalyticsHandler");var e=this._qosAnalytics.getQoSAnalytics();return this._qoSAnalyticsFormatter.format(e,this._trackSwitchCount)}},{key:"dispose",value:function(){this._qosAnalytics&&this._qosAnalytics.dispose()}},{key:"initialized",get:function(){return this._initialized}}]),e}();t.default=p,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(18),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),c=n(87),d=r(c),f=function(){function e(){(0,s.default)(this,e),this._scriptOrigin=null,this._metadata={}}return(0,l.default)(e,[{key:"_onErrorListener",value:function(e){e.filename&&e.filename===this._scriptOrigin&&this.notifyError(new d.default(e))}},{key:"notify",value:function(e,t){throw arguments.length>2&&void 0!==arguments[2]&&arguments[2],new Error("AbstractError#notify should be implemented")}},{key:"notifyError",value:function(e,t){throw new Error("AbstractError#notifyError should be implemented")}},{key:"_getAppVersion",value:function(){return"4.10.14".split("-")[0]}},{key:"setMetadata",value:function(e){(0,a.default)(this._metadata,e)}},{key:"setScriptOrigin",value:function(e){this._scriptOrigin=e}},{key:"setCustomer",value:function(e){}}]),e}();t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),c=n(10),d=r(c),f=n(253),h=r(f),_=n(9),p=r(_),v=n(167),E=r(v),g=n(169),m=r(g),y=n(86),S=r(y),T=n(87),A=(r(T),function(e){function t(){(0,s.default)(this,t);var e=(0,d.default)(this,(t.__proto__||(0,a.default)(t)).call(this));return window.addEventListener("error",e._onErrorListener.bind(e)),m.default.apiKey=S.default.ERRORS.API_KEY,m.default.notifyHandler=S.default.ERRORS.HANDLER,m.default.notifyReleaseStages=S.default.ERRORS.STAGES,m.default.disableLog=!0,m.default.releaseStage="production",m.default.autoNotify=!1,m.default.appVersion=e._getAppVersion(),e}return(0,p.default)(t,e),(0,l.default)(t,[{key:"notify",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"warning",r=n;r.match(/^(warning|info|error)$/)||(r="warning"),m.default.notify(e,t,this._metadata,r)}},{key:"notifyError",value:function(e,t){m.default.notifyException(e,{groupingHash:t||e.message})}},{key:"setMetadata",value:function(e){(0,h.default)(t.prototype.__proto__||(0,a.default)(t.prototype),"setMetadata",this).call(this,e),m.default.metaData=this._metadata}},{key:"setCustomer",value:function(e){m.default.userId=e}
        }]),t}(E.default));t.default=new A,e.exports=t.default},function(e,t,n){"use strict";var r,i,a=n(31),o=function(e){return e&&e.__esModule?e:{default:e}}(a);!function(n,a){function s(){b=!1}function u(){var e=document.currentScript||A;if(!e&&b){var t=document.scripts||document.getElementsByTagName("script");e=t[t.length-1]}return e}function l(e){var t=u();t&&(e.script={src:t.src,content:p("inlineScript",!0)?t.innerHTML:""})}function c(e){var t=p("disableLog"),r=n.console;void 0===r||void 0===r.log||t||r.log("[Bugsnag] "+e)}function d(e,t,r){if(r>=p("maxDepth",w))return encodeURIComponent(t)+"=[RECURSIVE]";r=r+1||1;try{if(n.Node&&e instanceof n.Node)return encodeURIComponent(t)+"="+encodeURIComponent(S(e));var i=[];for(var a in e)if(e.hasOwnProperty(a)&&null!=a&&null!=e[a]){var s=t?t+"["+a+"]":a,u=e[a];i.push("object"===(void 0===u?"undefined":(0,o.default)(u))?d(u,s,r):encodeURIComponent(s)+"="+encodeURIComponent(u))}return i.join("&")}catch(e){return encodeURIComponent(t)+"="+encodeURIComponent(""+e)}}function f(e,t,n){if(null==t)return e;if(n>=p("maxDepth",w))return"[RECURSIVE]";e=e||{};for(var r in t)if(t.hasOwnProperty(r))try{t[r].constructor===Object?e[r]=f(e[r],t[r],n+1||1):e[r]=t[r]}catch(n){e[r]=t[r]}return e}function h(e,t){if(e+="?"+d(t)+"&ct=img&cb="+(new Date).getTime(),"undefined"!=typeof BUGSNAG_TESTING&&D.testRequest)D.testRequest(e,t);else if("xhr"===p("notifyHandler")){var n=new XMLHttpRequest;n.open("GET",e,!0),n.send()}else(new Image).src=e}function _(e){var t={},n=/^data\-([\w\-]+)$/;if(e)for(var r=e.attributes,i=0;i<r.length;i++){var a=r[i];if(n.test(a.nodeName)){var o=a.nodeName.match(n)[1];t[o]=a.value||a.nodeValue}}return t}function p(e,t){O=O||_(M);var n=void 0!==D[e]?D[e]:O[e.toLowerCase()];return"false"===n&&(n=!1),void 0!==n?n:t}function v(e){return!(!e||!e.match(P))||(c("Invalid API key '"+e+"'"),!1)}function E(e,t){var r=p("apiKey");if(v(r)&&C){C-=1;var i=p("releaseStage","production"),a=p("notifyReleaseStages");if(a){for(var o=!1,s=0;s<a.length;s++)if(i===a[s]){o=!0;break}if(!o)return}var u=[e.name,e.message,e.stacktrace].join("|");if(u!==R){R=u,T&&(t=t||{},t["Last Event"]=y(T));var l={notifierVersion:k,apiKey:r,projectRoot:p("projectRoot")||n.location.protocol+"//"+n.location.host,context:p("context")||n.location.pathname,userId:p("userId"),user:p("user"),metaData:f(f({},p("metaData")),t),releaseStage:i,appVersion:p("appVersion"),url:n.location.href,userAgent:navigator.userAgent,language:navigator.language||navigator.userLanguage,severity:e.severity,name:e.name,message:e.message,stacktrace:e.stacktrace,file:e.file,lineNumber:e.lineNumber,columnNumber:e.columnNumber,payloadVersion:"2"},d=D.beforeNotify;if("function"==typeof d&&!1===d(l,l.metaData))return;if(0===l.lineNumber&&/Script error\.?/.test(l.message))return c("Ignoring cross-domain script error. See https://bugsnag.com/docs/notifiers/js/cors");h(p("endpoint")||I,l)}}}function g(){var e,t;try{throw new Error("")}catch(n){e="<generated>\n",t=m(n)}if(!t){e="<generated-ie>\n";var n=[];try{for(var r=arguments.callee.caller.caller;r&&n.length<10;){var i=L.test(r.toString())?RegExp.$1||"[anonymous]":"[anonymous]";n.push(i),r=r.caller}}catch(e){c(e)}t=n.join("\n")}return e+t}function m(e){return e.stack||e.backtrace||e.stacktrace}function y(e){return{millisecondsAgo:new Date-e.timeStamp,type:e.type,which:e.which,target:S(e.target)}}function S(e){if(e){var t=e.attributes;if(t){for(var n="<"+e.nodeName.toLowerCase(),r=0;r<t.length;r++)t[r].value&&"null"!==t[r].value.toString()&&(n+=" "+t[r].name+'="'+t[r].value+'"');return n+">"}return e.nodeName}}var T,A,R,D={},C=10,w=5;D.noConflict=function(){return n.Bugsnag=a,void 0===a&&delete n.Bugsnag,D},D.refresh=function(){C=10},D.notifyException=function(e,t,n,r){e&&(t&&"string"!=typeof t&&(n=t,t=void 0),n||(n={}),l(n),E({name:t||e.name,message:e.message||e.description,stacktrace:m(e)||g(),file:e.fileName||e.sourceURL,lineNumber:e.lineNumber||e.line,columnNumber:e.columnNumber?e.columnNumber+1:void 0,severity:r||"warning"},n))},D.notify=function(e,t,r,i){E({name:e,message:t,stacktrace:g(),file:n.location.toString(),lineNumber:1,severity:i||"warning"},r)};var b="complete"!==document.readyState;document.addEventListener?(document.addEventListener("DOMContentLoaded",s,!0),n.addEventListener("load",s,!0)):n.attachEvent("onload",s);var O,P=/^[0-9a-f]{32}$/i,L=/function\s*([\w\-$]+)?\s*\(/i,I="https://notify.bugsnag.com/js",k="2.5.0",N=document.getElementsByTagName("script"),M=N[N.length-1];if(n.atob&&n.ErrorEvent)try{0===new n.ErrorEvent("test").colno&&!1}catch(e){}n.Bugsnag=D,r=[],void 0!==(i=function(){return D}.apply(t,r))&&(e.exports=i)}(window,window.Bugsnag)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(105),a=r(i),o=n(40),s=r(o),u=n(0),l=r(u),c=n(1),d=r(c),f=n(4),h=n(24),_=n(49),p=r(_),v=n(232),E={GET:"GET",POST:"POST"},g={JSON:"json",ARRAY_BUFFER:"arraybuffer"},m={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},y={INVALID_STATUS:"Response status is not part of valid status codes",REQUEST_ABORTED:"Request has been aborted",REQUEST_ERROR:"An error occured while sending the request",REQUEST_TIMEOUT:"Request timeout"},S=function(){function e(t,n,r){(0,l.default)(this,e),this._method=t,this._url=n,this._retryCount=0,this._aborted=!1,this._options=p.default.merge({responseType:e.ResponseTypes.JSON,validStatusCodes:[].concat((0,s.default)((0,h.range)(200,206)),[304]),timeout:0,retry:0,retryDelay:0,withCredentials:!1,headers:{},events:{onprogress:v.noop}},r)}return(0,d.default)(e,[{key:"send",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new a.default(function(n,r){function i(){var e=this;this._send(t).then(function(e){n(e)}).catch(function(t){return e._retryCount===e._options.retry?void r(t):(e._retryCount++,void(0,f.createTimeout)(function(){e._init(),i.call(e)},e._options.retryDelay))})}i.call(e)})}},{key:"abort",value:function(){throw new TypeError("Cannot call abstract method")}},{key:"_send",value:function(){throw new TypeError("Cannot call abstract method")}},{key:"_init",value:function(){throw new TypeError("Cannot call abstract method")}},{key:"isStreamroot",set:function(e){this._isStreamrootEndpoint=e}}]),e}();S.Methods=E,S.ResponseTypes=g,S.ReadyStates=m,S.Errors=y,t.default=S,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(105),a=r(i),o=n(52),s=r(o),u=n(7),l=r(u),c=n(0),d=r(c),f=n(1),h=r(f),_=n(10),p=r(_),v=n(9),E=r(v),g=n(170),m=r(g),y=n(4),S=n(172),T=r(S),A=n(173),R=r(A),D=function(e){function t(e,n,r){(0,d.default)(this,t);var i=(0,p.default)(this,(t.__proto__||(0,l.default)(t)).call(this,e,n,r));return i._init(),i}return(0,E.default)(t,e),(0,h.default)(t,[{key:"_init",value:function(){this._xhr=new XMLHttpRequest,this._xhr.open(this._method,this._url,!0),this._xhr.responseType=this._options.responseType,this._xhr.withCredentials=this._options.withCredentials;for(var e=(0,s.default)(this._options.headers),t=0,n=e.length;t<n;t++){var r=e[t];this._xhr.setRequestHeader(r,this._options.headers[r])}this._aborted=!1}},{key:"abort",value:function(){this._aborted=!0,this._xhr.abort()}},{key:"_send",value:function(e){var n=this;return new a.default(function(r,i){n._aborted?i(new T.default(t.Errors.REQUEST_ABORTED)):n._options.timeout&&(n._retryTimer=(0,y.createTimeout)(function(){n.abort(),i(new T.default(t.Errors.REQUEST_TIMEOUT))},n._options.timeout)),n._xhr.onloadend=function(){n._aborted?i(new T.default(t.Errors.REQUEST_ABORTED)):n._xhr.readyState===t.ReadyStates.DONE?n._options.validStatusCodes.indexOf(n._xhr.status)>-1?r(n._xhr.response):i(new T.default(t.Errors.INVALID_STATUS,n._xhr.status)):i(new T.default(t.Errors.REQUEST_ERROR))},n._xhr.onprogress=function(e){var t=new R.default(e.lengthComputable,e.loaded,e.total);n._options.events.onprogress(t)},n._xhr.onerror=function(){i(new T.default(t.Errors.REQUEST_ERROR))},n._xhr.send(e)})}}]),t}(m.default);t.default=D,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,a.default)(this,e),this._message=t,this._status=n}return(0,s.default)(e,[{key:"message",get:function(){return this._message}},{key:"status",get:function(){return this._status}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(t,n,r){(0,a.default)(this,e),this._lengthComputable=t,this._loaded=n,this._total=r}return(0,s.default)(e,[{key:"lengthComputable",get:function(){return this._lengthComputable}},{key:"loaded",get:function(){return this._loaded}},{key:"total",get:function(){return this._total}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(175),i=function(e){return e&&e.__esModule?e:{default:e}}(r),a=function(e){var t=[],n=e,r=function(){for(var e=-1,r=Date.now(),i=0;i<t.length&&r-t[i].timestamp()>n;i++)e=i;return e},a=function(){var e=r();e>-1&&t.splice(0,e+1)},o=function(e){a();var n=new i.default(e);t.push(n)},s=function(){if(a(),!t.length)return 0;for(var e=0,n=0;n<t.length;n++)e+=t[n].value();return e/t.length},u=function(){if(a(),!t.length)return 0;for(var e=0,n=0;n<t.length;n++)e+=t[n].value();return e};this.addPoint=o,this.compute=s,this.computeSum=u};t.default=a,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){var t=e,n=Date.now();this.timestamp=function(){return n},this.value=function(){return t}};t.default=r,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(n.USE_COMBINED_ABR_FEEDBACK){var r=e.cdnDownloaded+e.p2pDownloaded,i=e.cdnDownloaded/r,a=void 0;if(i<n.ABR_SEGMENT_CDN_RATIO_THRESHOLD||e.cdnDownloaded<n.ABR_CDN_DL_THRESHOLD){var o=void 0;if(null!==t.cdnTimestamp){var s=Date.now()-t.cdnTimestamp,u=Math.max(0,1-s/n.ABR_CDN_DL_DECAY_TIME);o=(1-u)*t.p2pSpeed+u*t.cdnSpeed}else o=t.p2pSpeed;a=8*r/o}else a=8*e.cdnDownloaded/t.cdnSpeed/i;e.p2pDuration=(1-i)*a,e.cdnDuration=i*a}else t.p2pSpeed>0?e.p2pDuration=8*e.p2pDownloaded/t.p2pSpeed:e.p2pDuration=0,null!==t.cdnSpeed?e.cdnDuration=8*e.cdnDownloaded/t.cdnSpeed:e.cdnDuration=0},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(40),a=r(i),o=n(8),s=r(o),u=n(7),l=r(u),c=n(0),d=r(c),f=n(1),h=r(f),_=n(10),p=r(_),v=n(9),E=r(v),g=n(97),m=r(g),y=n(2),S=r(y),T=n(5),A=r(T),R=n(4),D=function(e){function t(e,n){(0,d.default)(this,t);var r=[],i=(0,p.default)(this,(t.__proto__||(0,l.default)(t)).call(this,r));return i._peerIds=r,i._peerConnector=e,i._sharedState=n,i._sharedState.eventBus.on(S.default.Metrics.TRACK_SWITCH,i._onTrackSwitch,i),i}return(0,E.default)(t,e),(0,h.default)(t,[{key:"dispose",value:function(){this._tryDequeueTimer&&this._tryDequeueTimer.clear(),this._sharedState.eventBus.removeListener(S.default.Metrics.TRACK_SWITCH,this._onTrackSwitch,this)}},{key:"flush",value:function(){this._sharedState.peerStats.excessMatch+=this._peerIds.length,this._peerIds.length=0}},{key:"onPeersFromTracker",value:function(e,t){if(null!==e)return void A.default.notify("Error asking peers from tracker:",e.message);var n=[],r=!0,i=!1,o=void 0;try{for(var u,l=(0,s.default)(t);!(r=(u=l.next()).done);r=!0){var c=u.value,d=c.peers;n.push.apply(n,(0,a.default)(d))}}catch(e){i=!0,o=e}finally{try{!r&&l.return&&l.return()}finally{if(i)throw o}}if(!(n.length<1)){this.flush(),this._sharedState.peerStats.match+=n.length;var f=!0,h=!1,_=void 0;try{for(var p,v=(0,s.default)(n);!(f=(p=v.next()).done);f=!0){var E=p.value;this.push(E)}}catch(e){h=!0,_=e}finally{try{!f&&v.return&&v.return()}finally{if(h)throw _}}void 0===this._tryDequeueTimer&&this._createTryDequeueTimer()}}},{key:"_onTrackSwitch",value:function(e){e.isVideo&&this.flush()}},{key:"_createTryDequeueTimer",value:function(){this._tryDequeueTimer=(0,R.createInterval)(this._onTryDequeueTimer.bind(this),this._sharedState.conf.CANDIDATE_PEERS_TRY_DEQUEUE_INTERVAL)}},{key:"_onTryDequeueTimer",value:function(){var e=Math.min(this._peerIds.length,this._peerConnector.getOpenConnectorSlotsCount());e>0&&this.tryDequeueN(e)}},{key:"_canDequeue",value:function(){return this._peerIds.length>0&&this._peerConnector.getOpenConnectorSlotsCount()>this._sharedState.conf.RESERVED_OFFER_SLOTS}},{key:"_dequeuedCallback",value:function(e){this._peerConnector.createPeerConnection(e)}}]),t}(m.default);t.default=D,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(21),l=r(u),c=n(184),d=r(c),f=n(89),h=r(f),_=n(2),p=r(_),v=n(95),E=r(v),g={PENDING:"pending",DOWNLOADING:"downloading",DOWNLOADED:"downloaded",CDN_DOWNLOADED:"CDNdownloaded",FAILED:"failed"},m=function(){function e(t,n,r,i,o){(0,a.default)(this,e),this._sharedState=o,this._conf=o.conf,this._transferStats=o.transferStats,this._efficiencyStats=o.efficiencyStats,this._controlStats=o.controlStats,this._workerHelper=o.workerHelper,this._p2pCache=n,this._dataLocked=!1,this._downloadStatus=[],this._writeLock=!1,this._isEmpty=!0,this._partialSegmentRequested=!1,this._broadcastedSegmentInfoCalled=!1,this._segmentCoord=t,this._peerPool=r,this._segmentInfoMap=i,this._ee=new l.default}return(0,s.default)(e,[{key:"getEE",value:function(){return this._ee}},{key:"_initChunkStatus",value:function(e){var t=Math.ceil(e/this._conf.CHUNK_SIZE);E.default.clear(this._downloadStatus);for(var n=0;n<t;n++)this._downloadStatus.push(g.PENDING)}},{key:"setSegmentSize",value:function(e){this.size||(this.size=e,this.segment=new h.default(e,this._segmentCoord,this._sharedState.eventBus),this._initChunkStatus(e))}},{key:"getNumberOfChunks",value:function(){return this._downloadStatus.length}},{key:"getChunk",value:function(e,t){if(!this._dataLocked&&this._isChunkP2POrCDNDownloaded(e)){var n=this._conf.CHUNK_SIZE,r=e*this._conf.CHUNK_SIZE;r+n>this.size&&(n=this.size-r),this.segment.getBinaryData(r,n,t)}else this._dataLocked&&void 0,t(null)}},{key:"_getConsecutiveChunksCount",value:function(e,t,n){for(var r=1,i=1===t?0:e.length-1,a=1===t?e.length-1:0,o=i;o!==a;o+=t){var s=o+t;if(s>=0&&s<=e.length-1){if(1!==Math.abs(e[o]-e[s])||r===n)break;r++}}return r}},{key:"_getRemainingChunks",value:function(){for(var e=[],t=0,n=this._downloadStatus.length;t<n;t++)this._downloadStatus[t]!==g.FAILED&&this._downloadStatus[t]!==g.PENDING||e.push(t);return e}},{key:"_encodePartialBatchStr",value:function(e,t){var n=e;return e&&(n+=","),n+=""+t[0],t.length>1&&(n+="-"+t[t.length-1]),n}},{key:"getNextChunks",value:function(e,t){for(var n="",r=t,i=this._getRemainingChunks();i.length>0&&r>0;){var a=i[0],o=i[i.length-1],s=void 0,u=void 0;if(this._downloadStatus.length-1-o===a){var l=this._getConsecutiveChunksCount(i,1,r),c=this._getConsecutiveChunksCount(i,-1,r);u=Math.max(l,c),s=u===l?1:-1}else s=this._downloadStatus.length-1-o>a?1:-1,u=this._getConsecutiveChunksCount(i,s,r);var d=1===s?0:i.length-u,f=i.splice(d,u);f=1===s?f:f.reverse(),n=this._encodePartialBatchStr(n,f),r-=f.length;for(var h=0,_=f.length;h<_;h++)this._downloadStatus[f[h]]=g.DOWNLOADING}return{encoded:n,size:t-r}}},{key:"chunkDownloaded",value:function(e,t){if(!this.segment||t>=this._downloadStatus.length)return void(this._transferStats.multipleDlM+=e.byteLength);if(this._isEmpty=!1,this._isChunkP2POrCDNDownloaded(t)||this._writeLock){var n=this._downloadStatus[t];n===g.DOWNLOADED?this._transferStats.multipleDlPP+=e.byteLength:(n===g.CDN_DOWNLOADED||this._writeLock)&&(this._transferStats.multipleDlCP+=e.byteLength)}else if(this._downloadStatus[t]=g.DOWNLOADED,this.segment.setBinaryData(e,t*this._conf.CHUNK_SIZE),(this._sharedState.moduleState.isLive()&&this._conf.ALLOW_LIVE_PUSH_SEGMENT||!this._sharedState.moduleState.isLive()&&this._conf.ALLOW_VOD_PUSH_SEGMENT)&&this._broadcastSegmentInfo(),this.isSegmentDownloaded()){var r=this._p2pCache.getSegmentHandler(this._segmentCoord);r&&r.seeders.clear(),this.lockSegmentData(),this._checkHashP2P(this.segment)}this._sharedState.eventBus.emit(p.default.ChunkManager.CHUNK_DOWNLOADED)}},{key:"timeout",value:function(e){this._downloadStatus[e]===g.DOWNLOADING&&(this._downloadStatus[e]=g.FAILED)}},{key:"isSegmentDownloaded",value:function(){var e=this;return!!this.size&&this._downloadStatus.every(function(t,n){return e._isChunkP2POrCDNDownloaded(n)})}},{key:"shouldDownloadSegment",value:function(){return!this.isSegmentDownloaded()&&!this.partialSegment&&!this._partialSegmentRequested}},{key:"getPartialSegment",value:function(){var e=this;return this._partialSegmentRequested=!0,!(this._isEmpty||!this.size)&&(function(){e.partialSegment||e._dataLocked||(e.partialSegment=new d.default(e._segmentCoord,e._p2pCache,e.segment,e._downloadStatus,e.size,e,e.isSegmentDownloaded(),e._segmentInfoMap,e._sharedState))}(),this._dataLocked||(this._writeLock=!0),this.partialSegment)}},{key:"getPercentageOfChunksDownloaded",value:function(){var e=this;return this._downloadStatus.reduce(function(t,n,r){return t+(e._isChunkP2POrCDNDownloaded(r)?1/e.getNumberOfChunks()*100:0)},0)}},{key:"storeSegment",value:function(e){this._isEmpty=!1,this.segment=e,this.size||(this._initChunkStatus(e.byteLength),this.size=e.byteLength),this._updateDownloadStatus(),this._transferStats.p2pUseful+=this.getP2PAndCDNDownloads().p2pDownloaded}},{key:"_broadcastSegmentInfo",value:function(){var e=this.getPercentageOfChunksDownloaded();!this._broadcastedSegmentInfoCalled&&e>=this._conf.MIN_CHUNK_PERCENTAGE_DOWNLOADED_FOR_HAS_SEGMENT_ANSWER&&(this._broadcastedSegmentInfoCalled=!0,this._peerPool.broadcastSegmentInfo(this._segmentCoord))}},{key:"_updateDownloadStatus",value:function(){var e=void 0;e={start:0,end:this.getNumberOfChunks()},this.partialSegment&&this.partialSegment.getCDNIndexRange()&&(e=this.partialSegment.getCDNIndexRange());for(var t=e.start;t<e.end;t++){if(this._isChunkP2POrCDNDownloaded(t)){var n=this._conf.CHUNK_SIZE;t===this.getNumberOfChunks()-1&&(n=this.size-(this.getNumberOfChunks()-1)*this._conf.CHUNK_SIZE),this._downloadStatus[t]===g.DOWNLOADED?this._transferStats.multipleDlPC+=n:this._downloadStatus[t]===g.CDN_DOWNLOADED&&(this._transferStats.multipleDlCC+=n)}this._downloadStatus[t]=g.CDN_DOWNLOADED}}},{key:"getP2PAndCDNDownloads",value:function(){var e=0,t=0,n=this.getNumberOfChunks()-1;if(this.size)for(var r=0;r<this._downloadStatus.length;r++){var i=void 0,a=this._downloadStatus[r];i=r<n?this._conf.CHUNK_SIZE:this.size-n*this._conf.CHUNK_SIZE,a===g.DOWNLOADED?e+=i:a===g.CDN_DOWNLOADED&&(t+=i)}return{p2pDownloaded:e,cdnDownloaded:t}}},{key:"lockSegmentData",value:function(){this._dataLocked=!0}},{key:"unlockSegmentData",value:function(){this._dataLocked=!1}},{key:"removePartialSegment",value:function(){delete this.partialSegment}},{key:"_checkHashP2P",value:function(e){var t=this,n=this._segmentInfoMap.getSegmentInfo(this._segmentCoord),r=function(e,r){n.hash===r?(t._controlStats.nbRightHashP2P++,t.segment.setBinaryData(e),t.segment.setComplete(),t._transferStats.p2pUseful+=t.size,t.unlockSegmentData()):(t._controlStats.nbWrongHashP2P++,t._p2pCache.removeSegmentHandler(n.segmentCoord),t._transferStats.multipleDlHP+=t.size)};e.getBinaryData(0,e.byteLength,function(e){t._workerHelper.callHashWorker(e,r)})}},{key:"_isChunkP2POrCDNDownloaded",value:function(e){var t=this._downloadStatus[e];return t===g.DOWNLOADED||t===g.CDN_DOWNLOADED}},{key:"dispose",value:function(){this.segment&&this.segment.destroy()}},{key:"hasChunksToDownload",get:function(){return this._downloadStatus.indexOf(g.FAILED)>=0||this._downloadStatus.indexOf(g.PENDING)>=0}}]),e}();t.default=m,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),c=n(10),d=r(c),f=n(9),h=r(f),_=n(88),p=r(_),v=n(4),E=n(50),g=r(E),m=n(5),y=r(m),S=function(e){function t(e,n,r,i,o,u){(0,s.default)(this,t);var l=(0,d.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n,u));l._chunkManager=o,l._peer=r,l._sharedState=i;var c=i.moduleState.isLive()?i.conf.LIVE.CHUNK_TIMEOUT:i.conf.CHUNK_TIMEOUT;return l._timeoutTimer=(0,v.createTimeout)(function(){l._chunkTimedOut()},c),l._timedOut=!1,l}return(0,h.default)(t,e),(0,l.default)(t,[{key:"isEqual",value:function(e){return this.id===e.id}},{key:"_chunkTimedOut",value:function(){this._timedOut=!0,this._chunkManager.timeout(this._chunkIndex,this._bandwidthSafety),this._bandwidthSafety===g.default.SAFE?(this._sharedState.efficiencyStats.safeChunkRequestCount++,this._sharedState.efficiencyStats.safeChunkRequestTimeoutCount++):this._bandwidthSafety===g.default.UNSAFE&&(this._sharedState.efficiencyStats.unsafeChunkRequestCount++,this._sharedState.efficiencyStats.unsafeChunkRequestTimeoutCount++),this._peer.timeoutChunk(this)}},{key:"dataDownloaded",value:function(e){this._chunkManager.chunkDownloaded(e,this._chunkIndex),this._timedOut||(this._bandwidthSafety===g.default.SAFE?this._sharedState.efficiencyStats.safeChunkRequestCount++:this._bandwidthSafety===g.default.UNSAFE&&this._sharedState.efficiencyStats.unsafeChunkRequestCount++,this._timeoutTimer?this._timeoutTimer.clear():y.default.notifyError(new Error("clear() call on undefined DownloadChunkRequest.timeoutTimer.")))}},{key:"id",get:function(){return t.getIdOf(this._segmentCoord,this._chunkIndex)}},{key:"timestamp",get:function(){return this._timestamp}}],[{key:"getIdOf",value:function(e,t){return e.viewToString()+"C"+t}}]),t}(p.default);t.default=S,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(37),a=r(i),o=n(40),s=r(o),u=n(67),l=r(u),c=n(8),d=r(c),f=n(16),h=r(f),_=n(0),p=r(_),v=n(1),E=r(v),g=function(){function e(t,n,r){(0,p.default)(this,e),this._peerPool=t,this._peerConnector=n,this._secondOrderExclusions=new h.default,this._sharedState=r}return(0,E.default)(e,[{key:"addSecondOrderExclusion",value:function(e,t,n,r){this._secondOrderExclusions.set(e,{rank:t,releaseTimestamp:Date.now()+n,tag:r})}},{key:"_clearExpiredExclusions",value:function(){var e=Date.now(),t=!0,n=!1,r=void 0;try{for(var i,a=(0,d.default)(this._secondOrderExclusions.entries());!(t=(i=a.next()).done);t=!0){var o=(0,l.default)(i.value,2),s=o[0];o[1].releaseTimestamp<=e&&this._secondOrderExclusions.delete(s)}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}}},{key:"exclusionList",get:function(){this._clearExpiredExclusions();var e=this._peerConnector.getPendingConnectionPeers(),t=!0,n=!1,r=void 0;try{for(var i,o=(0,d.default)(this._peerPool.getPeerArray());!(t=(i=o.next()).done);t=!0){var u=i.value;e.push(u.getId())}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}var c=this._sharedState.conf.MAX_TRACKER_EXCLUSION_LENGTH-e.length;if(c>=this._secondOrderExclusions.size)return[].concat((0,s.default)(e),(0,s.default)(this._secondOrderExclusions.keys()));var f=Date.now(),h=(0,a.default)(this._secondOrderExclusions.entries());h.sort(function(e,t){var n=(0,l.default)(e,2),r=(n[0],n[1]),i=(0,l.default)(t,2),a=(i[0],i[1]);return(a.releaseTimestamp-f)*a.rank-(r.releaseTimestamp-f)*r.rank});var _=h.map(function(e){var t=(0,l.default)(e,2),n=t[0];return t[1],n});return[].concat((0,s.default)(e),(0,s.default)(_.slice(0,c)))}},{key:"secondOrderExclusions",get:function(){return this._clearExpiredExclusions(),this._secondOrderExclusions}}]),e}();t.default=g,e.exports=t.default},function(e,t,n){"use strict";e.exports={TRACK_CHANGE_EVENT:"onTrackChange",EMERGENCY_FRAG_LOAD_ABORT:"onEmergencyFragLoadAborted"}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(16),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),c=n(64),d=n(47),f=n(5),h=r(f),_=function(){function e(t,n){(0,s.default)(this,e),this._mediaMap=t,this._sharedState=n,this._cachedSegmentList=new a.default,this._cachedSegmentTime=new a.default}return(0,l.default)(e,[{key:"getSegmentListAfterEdge",value:function(e,t,n){var r=t.viewToString(),i=this._cachedSegmentList.get(e.viewToString());if(i&&i.edgeString===r&&i.duration===n)return i.cachedSegmentList;var a=this.getSegmentTime(t),o=void 0;return null===a?(h.default.notifyError(new Error("Unexpected getSegmentTime error: track edge timestamp is not supposed to be unreliable")),o=[]):o=this._mediaMap.getSegmentList(e,a,n),(this._sharedState.conf.ENABLE_PREBUFFER_FEEDBACK||this._sharedState.conf.ENABLE_FIX_UNRELIABLE_SEGMENT_TIME)&&(o=this._filterGreaterThanTrackEdge(o,t)),this._cachedSegmentList.set(e.viewToString(),{edgeString:r,cachedSegmentList:o,duration:n}),o}},{key:"_filterGreaterThanTrackEdge",value:function(e,t){for(var n=0;n<e.length;n++)if(e[n].getId()>t.getId())return e.slice(n);return[]}},{key:"getSegmentTime",value:function(e){if(e.fromPeer&&this._sharedState.moduleState.streamType===d.StreamTypes.HLS&&this._sharedState.conf.ENABLE_FIX_UNRELIABLE_SEGMENT_TIME)return null;var t=this._cachedSegmentTime.get(e.viewToString());if(void 0!==t)return t;var n=this._mediaMap.getSegmentTime(e);if(this._cachedSegmentTime.set(e.viewToString(),n),this._cachedSegmentTime.size>this._sharedState.conf.GETSEGMENTTIME_CACHE_MAX_SIZE){var r=this._cachedSegmentTime.keys(),i=r.next().value,a=(0,c.unwrap)(i);this._cachedSegmentTime.delete(a)}return n}}]),e}();t.default=_,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(220),l=function(){function e(t,n,r){(0,a.default)(this,e),this._isNearEdge=!1,this.isAlwaysDvr=!0,this.currentTracks=new u.CurrentTracks(t),this._playerInterface=n,this._streamType=r,this.nextSegmentPrebuffered={video:!1,audio:!1}}return(0,s.default)(e,[{key:"isLive",value:function(){return this._playerInterface.isLive()}},{key:"resetIsAlwaysDvr",value:function(){!this._isNearEdge&&this.isLive()&&(this.isAlwaysDvr=!0)}},{key:"isNearEdge",get:function(){return this._isNearEdge},set:function(e){e&&this.isAlwaysDvr&&(this.isAlwaysDvr=!1),this._isNearEdge=e}},{key:"streamType",get:function(){return this._streamType}}]),e}();t.default=l,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(243),a=r(i),o=n(7),s=r(o),u=n(0),l=r(u),c=n(10),d=r(c),f=n(9),h=r(f),_=n(5),p=r(_),v=n(63),E=r(v),g=function(e){function t(e,n,r,i,o,u,c,f,h){function _(e,t,r,i){function a(a,o){t.hash===o?(M.nbRightHashDLM++,e.response=a,v(e),r(e,I)):(M.nbWrongHashDLM++,N.multipleDlHD+=H,N.multipleDlHP+=x,n.removeSegmentHandler(I),i(e,I))}w.callHashWorker(e.response,a)}function v(e){B=e.response,n.fillSegment(I,e.response),u.unlockSegmentData(),u.removePartialSegment()}function E(){L?x=o:(x=U.start*R.CHUNK_SIZE,U.end<G.length&&(x+=(G.length-U.end-1)*R.CHUNK_SIZE,x+=o-(G.length-1)*R.CHUNK_SIZE))}function g(){for(var e=0;e<G.length;e++)if("downloaded"!==G[e]&&"CDNdownloaded"!==G[e])return e}function m(){for(var e=G.length-1;e>=0;e--)if("downloaded"!==G[e]&&"CDNdownloaded"!==G[e])return e+1}function y(){U=R.RANGE_REQUEST_ALLOWED?{start:g(),end:m()}:{start:0,end:G.length}}function S(e){if(!R.RANGE_REQUEST_ALLOWED)return e;var t=void 0;if(void 0===U.start||void 0===U.end)throw new Error("PartialSegmentP2P: getUpdatedRange called with complete segment");var n=e?e.start+U.start*R.CHUNK_SIZE:U.start*R.CHUNK_SIZE;return U.end===G.length&&e?t=e.end:U.end<G.length&&(t=e?e.start+U.end*R.CHUNK_SIZE-1:U.end*R.CHUNK_SIZE-1),{start:n,end:t}}function T(e){if(void 0===U)throw new Error("assertion: _cdnIndexRange is not defined");if(void 0===B)throw new Error("assertion: _segmentData is not defined");try{B.setBinaryData(e,U.start*R.CHUNK_SIZE)}catch(e){throw p.default.notifyError(e),new Error("Invalid configuration: The current stream has no range request enabled and the p2p configuration has range request set to true.")}return B}function A(e){h.transferStats.cdnDownloaded+=e.byteLength}(0,l.default)(this,t);var R=h.conf,D=h.status,C=h.eventBus,w=h.workerHelper,b=h.controlStats,O=h.transferStats,P=(0,d.default)(this,(t.__proto__||(0,s.default)(t)).call(this)),L=c,I=e,k=f,N=O,M=b,U=void 0,x=void 0,F=void 0,B=void 0,G=void 0,H=0;return P.getFullSegment=function(e,t,n){if(this.isComplete())B.getBinaryData(0,B.byteLength,function(n){e.response=n,u.removePartialSegment(),t(e,null)});else{C.emit("CDNSegmentDownloaded",I);var r=e.response;A(r),H=r.byteLength,T(r).getBinaryData(0,B.byteLength,function(r){if(e.response=r,0!==x){u.lockSegmentData();var i=k.getSegmentInfo(I);_(e,i,t,n)}else v(e),t(e,I)})}},P.getUpdatedRange=S,P.getCDNIndexRange=function(){return U},P.isComplete=function(){return L},P.isLocked=function(){return u.dataLocked},function(){if(B=r,!i.length)throw new Error("PartialSegmentP2P should not be instantiated with an empty segment");G=i.slice(),y(),E(),F=D.getMeanInstantSpeed()}(),(0,a.default)(P,{p2pSpeed:{get:function(){return F},set:void 0},p2pAmount:{get:function(){return x},set:void 0}}),P}return(0,h.default)(t,e),t}(E.default);t.default=g,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),a=r(i),o=n(39),s=r(o),u=n(16),l=r(u),c=n(4),d=n(94),f=r(d),h=n(225),_=r(h),p=n(17),v=n(96),E=n(205),g=r(E),m=n(186),y=r(m),S=n(2),T=r(S),A=n(179),R=r(A),D=n(224),C=r(D),w=n(50),b=r(w),O=n(35),P=r(O),L=n(65),I=r(L),k=n(5),N=r(k),M=function(e,t,n,r,i){var o=r,u=r.conf,d=r.peerStats,h=new p.Delta,E=new p.Delta,m=new p.Delta,S=new p.Delta(Date.now()),A=r.eventBus,D=e,w=d,O=new _.default(n,r),L=this,k=P.default.fromHalfLife(0,u.PEER_UPLOAD_SPEED_EMA_HALF_LIFE,u.PEER_SPEED_MONITOR_INTERVAL),M=P.default.fromHalfLife(0,u.PEER_DOWNLOAD_SPEED_EMA_HALF_LIFE,u.PEER_SPEED_MONITOR_INTERVAL),U=Math.max(u.BLOCK_SEEDER_SCHEDULING_WINDOW,u.PEER_TIMEOUT_RATIO_WINDOW),x=new I.default(U),F=new I.default(U),B=Date.now(),G=0,H=0,j=!1,W=void 0,V=0,K=0,q=void 0,Y=0,X=0,z=0,Q=0,Z=!1,$=!1,J=void 0,ee=!1,te=new l.default,ne=new l.default,re=s.default,ie=!1,ae=function(){var e=S.calcDelta(Date.now()),t=h.calcDelta(G),n=E.calcDelta(H),i=m.calcDelta(O.dataUploaded);V=8*t/e,K=8*i/e;var a=8*n/e,o=Date.now()-r.moduleState.currentTracks.lastSwitchTimestamp;Z?u.POST_TRACK_SWITCH_PEER_LOCK_SENSITIVITY_ON&&o<u.POST_TRACK_SWITCH_PEER_SPEED_SENSITIVITY_DURATION?M.update(a,P.default.halfLifeToEMAWeight(u.PEER_DOWNLOAD_SPEED_SENSITIVE_EMA_HALF_LIFE,u.PEER_SPEED_MONITOR_INTERVAL)):M.update(a):a>0&&(M.update(a,1),Z=!0),$?u.POST_TRACK_SWITCH_PEER_LOCK_SENSITIVITY_ON&&o<u.POST_TRACK_SWITCH_PEER_SPEED_SENSITIVITY_DURATION?k.update(K,P.default.halfLifeToEMAWeight(u.PEER_UPLOAD_SPEED_SENSITIVE_EMA_HALF_LIFE,u.PEER_SPEED_MONITOR_INTERVAL)):k.update(K):K>0&&(k.update(K,1),$=!0),x.push(Y),F.push(X)},oe=function(e){n.sendMessage("requestHasSegment",{segmentCoord:e})},se=function(e,t){var r=t.pushed;n.sendMessage("hasSegment",{segmentInfo:e,pushed:!!r})},ue=function(e){Y++,X++,ne.set(e.id,te.get(e.id)),te.delete(e.id),(0,c.createTimeout)(function(){var t=ne.get(e.id);t&&t.timestamp===e.timestamp&&ne.delete(e.id)},u.CHUNK_GRACE_DURATION),this.isBannedSeeder()||Ee(u.BLOCK_SEEDER_SCHEDULING_WINDOW)>u.BLOCK_SEEDER_SCHEDULING_TIMEOUT_THRESHOLD&&Y>u.BLOCK_SEEDER_SCHEDULING_REQUEST_THRESHOLD&&(re=Date.now())},le=function(e,t,r,i){var s=g.default.decode(t),u=!0,l=!1,c=void 0;try{
            for(var d,f=(0,a.default)(s);!(u=(d=f.next()).done);u=!0){var h=d.value,_=new R.default(e,h,this,o,i,r);te.set(_.id,_)}}catch(e){l=!0,c=e}finally{try{!u&&f.return&&f.return()}finally{if(l)throw c}}n.sendMessage("requestChunks",{segmentCoord:e,ids:t,safe:r===b.default.SAFE})},ce=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];ie=e,J?J.clear():N.default.notifyError(new Error("clear() call on undefined Peer.speedMonitorTimer")),n.removeListener(T.default.PeerConnection.BINARY_DATA_RECEIVED,he),n.removeListener(T.default.PeerConnection.MESSAGE_RECEIVED,fe),n.close()},de=function(){J?J.clear():N.default.notifyError(new Error("clear() call on undefined Peer.speedMonitorTimer")),O.dispose(),q.dispose(),n.destroy()},fe=function(e,n){var i=void 0;switch(e){case"heartbeat":W=n.videoTrack;break;case"requestHasSegment":A.emit("segmentRequested",L,new t(n.segmentCoord));break;case"hasSegment":i=new t(n.segmentInfo.segmentCoord),i.fromPeer=!0;var o=new f.default(i,n.segmentInfo.size,n.segmentInfo.hash),s=!!n.pushed;A.emit("hasSegment",L,o,{pushed:s});break;case"requestChunks":if(!r.isP2PUploadOn)return;i=new t(n.segmentCoord);var u=g.default.decode(n.ids),l=n.safe?b.default.SAFE:b.default.UNSAFE,c=!0,d=!1,h=void 0;try{for(var _,p=(0,a.default)(u);!(c=(_=p.next()).done);c=!0){var v=_.value;r.efficiencyStats.receivedChunkRequestCount++,O.push(new C.default(i,v,r,l))}}catch(e){d=!0,h=e}finally{try{!c&&p.return&&p.return()}finally{if(d)throw h}}break;default:return void N.default.notifyError(new Error("Invalid message "+e+" sent by peerConnection"))}ee||(w.active++,ee=!0)},he=function(e,t,n){G+=e.byteLength;var i=te.get(R.default.getIdOf(n,t));i?(Y++,i.dataDownloaded(e),H+=e.byteLength,te.delete(i.id)):(Q++,i=ne.get(R.default.getIdOf(n,t)),i?(z++,r.efficiencyStats.gracedChunksCount++,i.dataDownloaded(e),ne.delete(i.id)):(r.efficiencyStats.expiredGraceChunksCount++,r.transferStats.multipleDlM+=e.byteLength)),_e()},_e=function(){j||(w.transfer++,j=!0)},pe=function(){return!W||r.moduleState.currentTracks.video.viewToString()===W},ve=function(){return Date.now()-B<u.PEER_INIT_LOCKED_DURATION},Ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.PEER_TIMEOUT_RATIO_WINDOW,t=x.subDelta(e),n=F.subDelta(e);return t>0?n/t:0},ge=function(e){for(var t=0;t<e.length;t++)oe(e[t])};L.getRtt=n.getRtt.bind(n),L.requestHasSegment=oe,L.answerHasSegment=se,L.requestChunks=le,L.timeoutChunk=ue,L.isOnSameTrack=pe,L.close=ce,L.getDataDownloaded=function(){return G},L.getDataUploaded=function(){return O.dataUploaded},L.getId=function(){return D},L.getDlSpeed=function(){return V},L.getUpSpeed=function(){return K},L.getUsefulDlSpeedEMA=function(){return M.value},L.getUpSpeedEMA=function(){return k.value},L.getChunkTimeoutCount=function(){return X},L.getChunkRequestedCount=function(){return Y},L.getLateChunksCount=function(){return Q},L.getGracedChunksCount=function(){return z},L.getUploadCapacity=function(){return q.value},L.isLooser=function(){var e=Ee()>u.PEER_CRITICAL_CHUNK_TIMEOUT_THRESHOLD,t=k.value<u.LOOSER_UPLOAD_THRESHOLD;return e&&t},L.isBannedSeeder=function(){return Date.now()-re<u.BLOCK_SEEDER_SCHEDULING_DURATION},L.getChunksQuantityForInterval=function(e){var t=q.value*(e/1e3),n=Math.ceil(t*(1+u.PEER_UPLOAD_CAPACITY_EXTRA_RATIO)/(8*u.CHUNK_SIZE/1024)),r=Math.floor(n*u.PEER_UPLOAD_CAPACITY_SAFE_RATIO/(1+u.PEER_UPLOAD_CAPACITY_EXTRA_RATIO));return{safe:r,unsafe:n-r}},L.locked=function(){return(!!u.POST_TRACK_SWITCH_PEER_LOCK_SENSITIVITY_ON||pe())&&(ve()||k.value/r.abrStats.estimatedBitrate>u.PEER_LOCKED_UPLOAD_THRESHOLD||M.value/r.abrStats.estimatedBitrate>u.PEER_LOCKED_DOWNLOAD_THRESHOLD)},L.getDebugInfos=function(){return{id:D.slice(-7),RawDownloadSpeed:new v.BitDataAmount(1e3*V,"ps"),RawUploadSpeed:new v.BitDataAmount(1e3*K,"ps"),DataDownloaded:new v.ByteDataAmount(G),DataUploaded:new v.ByteDataAmount(O.dataUploaded),RTT:n.getRtt()>=0?n.getRtt():"unavailable",UploadCapacity:new v.BitDataAmount(1e3*q.value,"ps"),ConenctedDuration:Math.round((Date.now()-B)/1e3),OngoingRequests:te.size,GracingRequests:ne.size,RequestedChunks:Y,GracedChunks:z,TimeoutChunks:X,LateChunks:Q,GracedRatio:(Y?z/Y:0).toFixed(2),TimeoutRatio:(Y?X/Y:0).toFixed(2),LateRatio:(Y?Q/Y:0).toFixed(2),SmoothedUsefulDownloadSpeed:new v.ByteDataAmount(1e3*this.getUsefulDlSpeedEMA()/8,"ps"),SmoothedUploadSpeed:new v.ByteDataAmount(1e3*this.getUpSpeedEMA()/8,"ps"),WindowedTimeoutRatio:Ee().toFixed(2),PeerStatus:(this.locked()?"locked":"unlocked")+"-"+(this.isLooser()?"looser":"normal"),LastCRank:this.lastCRank?this.lastCRank.toFixed(2):"unavailable",SeederTimeoutRatio:Ee(u.BLOCK_SEEDER_SCHEDULING_WINDOW).toFixed(2),SeederBanned:this.isBannedSeeder(),VideoTrack:W,SameTrack:pe()}},function(){q=new y.default(r,L,i),J=(0,c.createInterval)(ae,u.PEER_SPEED_MONITOR_INTERVAL),O.onTransfering=_e,n.once(T.default.PeerConnection.DISCONNECTED,function(){w.disconnected++,A.emit(T.default.Peer.PEER_DISCONNECTED,L,ie),de()}),n.on(T.default.PeerConnection.BINARY_DATA_RECEIVED,he),n.on(T.default.PeerConnection.MESSAGE_RECEIVED,fe),A.once("segmentInfo",ge,L),x.push(0),F.push(0)}()};t.default=M,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(35),l=r(u),c=n(65),d=r(c),f=n(17),h=n(4),_=function(){function e(t,n,r){var i=this;(0,a.default)(this,e);var o=t.conf,s=this._getTrimmedWindowTimeout(t),u=new f.Delta(n.getDataDownloaded()),c=new f.Delta(Date.now()),_=new d.default(s),p=new d.default(s);this._capacityEmwa=new l.default(r,o.PEER_UPLOAD_CAPACITY_EWMA_WEIGHT_UP),_.push(n.getChunkTimeoutCount()),p.push(n.getChunkRequestedCount()),this._timer=(0,h.createInterval)(function(){_.push(n.getChunkTimeoutCount()),p.push(n.getChunkRequestedCount());var e=p.delta,t=_.delta,r=u.calcDelta(n.getDataDownloaded()),a=c.calcDelta(Date.now());if(null!==t&&null!==e){var s=8*r/1024*1e3/a,l=e>0?t/e:0;s>=i._capacityEmwa.value?i._capacityEmwa.update(s):l>=o.MAX_PEER_UPLOAD_CAPACITY_TIMEOUT_RATIO&&(o.PUC_EMWA_WEIGHT_USE_TIMEOUT_RATIO?i._capacityEmwa.update(s,Math.min(l,o.PUC_EMWA_WEIGHT_CAP)):i._capacityEmwa.update(s,o.PEER_UPLOAD_CAPACITY_EWMA_WEIGHT_DOWN))}},o.PEER_UPLOAD_CAPACITY_COMPUTATION_INTERVAL)}return(0,s.default)(e,[{key:"_getTrimmedWindowTimeout",value:function(e){var t=e.conf,n=e.moduleState,r=t.PEER_UPLOAD_CAPACITY_COMPUTATION_INTERVAL,i=n.isLive()?t.LIVE.CHUNK_TIMEOUT:t.CHUNK_TIMEOUT;return r*Math.ceil(i/r)+100}},{key:"dispose",value:function(){this._timer.clear()}},{key:"value",get:function(){return this._capacityEmwa.value}}]),e}();t.default=_,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(139),a=r(i),o=n(133),s=r(o),u=n(136),l=r(u),c=n(142),d=r(c),f=n(141),h=r(f),_=n(152),p=r(_),v=n(132),E=r(v),g=n(151),m=r(g),y=n(129),S=r(y),T=n(143),A=r(T),R=n(140),D=r(R),C=n(137),w=r(C),b=n(146),O=r(b),P=n(155),L=r(P),I=n(154),k=n(145),N=r(k),M=n(134),U=r(M),x=n(144),F=r(x),B=n(61),G=r(B),H=n(153),j=r(H),W=n(46),V=n(147),K=r(V),q=n(47),Y=n(148),X=r(Y),z=n(5),Q=r(z),Z=n(130),$=r(Z),J=n(135),ee=r(J),te=n(85),ne=r(te),re=n(156),ie=r(re),ae=n(157),oe=r(ae),se=n(138),ue=r(se),le=n(131),ce=r(le),de=n(149),fe=r(de),he=n(150),_e=r(he);Q.default.setScriptOrigin(window.document.currentScript&&window.document.currentScript.src?window.document.currentScript.src:null);var pe=function e(t,n,r,i,o,u,c){var f=this;if("string"!=typeof c||""===c||c.length>10)throw new Error("Unvalid argument in PeerAgent constructor: integration version must be a non-empty string of less than 10 characters");var _=new $.default,v=new K.default(i,n,c,t,_,r,u);Q.default.setCustomer(v.conf.ID_CLIENT),Q.default.setMetadata({stream:v.moduleState.content}),(0,W.checkInterface)(j.default,r),(0,W.checkInterface)(G.default,o.prototype),(0,q.assertStreamType)(u);var g=void 0,y=void 0,T=void 0,R=void 0,C=void 0,b=void 0,P=void 0,k=void 0,M=void 0,x=void 0,B=void 0,H=void 0,V=void 0,Y=void 0,z=void 0,Z=!1,J=void 0,te=void 0,re=void 0,ae=function(){M=(0,I.createScheduler)(r,R,b,v)},se=function(){x&&(B=new N.default,C=new ue.default,y=new A.default(t,C,o,B,v),T=new D.default(v),Y=new E.default(_,v),t.isLive()?z=new m.default(t,_,v):(0,_e.default)(v),R=new w.default(y,B,v),P=new O.default(B,R,v),k=new L.default(R,v),b=new U.default(r,v),ae(),C.init(R,M),g=new s.default(R,M,v),V=new S.default(_,v),(0,ce.default)(v),ee.default.connect(v),a.default.listenEvents(M,R,B,b,v),te.listenEvents(re),le()),Z=!0},le=function(){v.conf.DEBUG&&(H=new p.default(y,z,v))},de=function(e){return e.trackView&&e.trackView.type&&("audio"===e.trackView.type||"video"===e.trackView.type)},he=function(e){if(!x)throw new Error("P2P is not activated, getP2PData can't be called");var t=void 0;return Z?t=x?R.getPartialSegment(e)||new d.default(e,R,B,v):new h.default(e):(re=de(e),se(),t=new h.default(e)),re&&te.updateWithSegmentView(e),M.updateTrackEdge(e),t},pe=function(e,t,n){return null!==n&&(0,W.checkInterface)(G.default,n),F.default.getSegment(this,e,t,n,v)},ve=function(){x&&(Z&&(V.dispose(),g.dispose(),R.dispose(),y.dispose(),T.dispose(),H&&H.dispose(),Y.dispose(),z&&z.dispose()),J.removeAllExternalEventListener()),ie.default.removeFromPeerAgentList(v.peerToken),v.dispose()};!function(){(x=ne.default.isP2PEnabled(v.conf))&&(J=new l.default(t),te=new fe.default(J,v))}(),this.getSegment=pe,this.getP2PData=he,this.dispose=ve,this.setMediaElement=function(e){f.mediaElement=e},Object.defineProperty(this,"mediaElement",{get:function(){return _.mediaElement},set:function(e){_.mediaElement=e}}),Object.defineProperty(this,"p2pDownloadOn",{get:function(){return v.isP2PDownloadOn},set:function(e){e!==v.isP2PDownloadOn&&(v.isP2PDownloadOn=e,v.eventBus.emit("p2pDownloadToggle",e))}}),Object.defineProperty(this,"version",{get:function(){return e.version}}),Object.defineProperty(this,"p2pUploadOn",{get:function(){return v.isP2PUploadOn},set:function(e){e!==v.isP2PUploadOn&&(v.isP2PUploadOn=e,v.eventBus.emit("p2pUploadToggle",e))}}),Object.defineProperty(this,"isP2PEnabled",{get:function(){return ne.default.isP2PEnabled(v.conf)}}),Object.defineProperty(this,"stats",{get:function(){return X.default.get(y,v,z,_)}}),Object.defineProperty(this,"nextSegmentPrebuffered",{get:function(){return v.moduleState.nextSegmentPrebuffered}}),Object.defineProperty(this,"PublicAPI",{get:function(){return oe.default.get(f)}}),ie.default.addToPeerAgentList(v.peerToken,this)};Object.defineProperty(pe,"StreamTypes",{get:function(){return q.StreamTypes}}),Object.defineProperty(pe,"version",{get:function(){return"4.10.14"}}),ie.default.setup(pe),t.default=pe,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(t){var n=this;(0,a.default)(this,e),this._conf=t,this._peers=[],this._peerUpoadCapacityComparator=function(e,t){var r=e.getChunksQuantityForInterval(n._conf.CHUNK_BATCHING_INTERVAL).safe;return t.getChunksQuantityForInterval(n._conf.CHUNK_BATCHING_INTERVAL).safe-r}}return(0,s.default)(e,[{key:"add",value:function(e){this.remove(e),this._peers.push(e)}},{key:"remove",value:function(e){var t=e.getId();this._peers=this._peers.filter(function(e){return e.getId()!==t})}},{key:"all",value:function(){return this._peers.sort(this._peerUpoadCapacityComparator)}},{key:"allNotBanned",value:function(){return this._peers.filter(function(e){return!e.isBannedSeeder()}).sort(this._peerUpoadCapacityComparator)}},{key:"clear",value:function(){this._peers.length=0}},{key:"length",get:function(){return this._peers.length}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(21),i=function(e){return e&&e.__esModule?e:{default:e}}(r),a=function(){var e=!1,t=void 0,n=0,r=0,a=0,o=0,s=0,u=0,l=0,c=0,d="",f=!1,h="",_=this,p=void 0,v=void 0,E=new i.default,g=null,m=function(){var e=void 0,t=void 0,i=void 0,l=void 0;n&&(n>a&&(a=n),e=r?(r*p+n)/(p+1):n,t=p?p+1:1,p=t,r=e),o&&(o>u&&(u=o),i=s?(s*v+o)/(v+1):o,l=v?v+1:1,v=l,s=i)};_.getMyPeerId=function(){return t},_.setMyPeerId=function(e){t!==e&&(t=e)},_.getDlSpeed=function(){return n},_.setDlSpeed=function(e){n=e},_.getAvgDlSpeed=function(){return r},_.getMaxDlSpeed=function(){return a},_.getUpSpeed=function(){return o},_.setUpSpeed=function(e){o=e},_.getAvgUpSpeed=function(){return s},_.getMaxUpSpeed=function(){return u},_.getCdnCancelled=function(){return c},_.increaseCdnCancelledBy=function(e){c+=e},_.getConnected=function(){return e},_.setTrackerVersion=function(e){d=e},_.getTrackerVersion=function(){return d},_.setTrackerId=function(e){h=e},_.getTrackerId=function(){return h},_.setConnected=function(t){t!==e&&(e=t,!0===t?E.emit("tracker_ready"):E.emit("tracker_disconnected"))},_.getEE=function(){return E},_.setConnectedToSignalingServer=function(){f=!0,E.emit("signaling_ready")},_.setDisconnectedToSignalingServer=function(){f=!1,E.emit("signaling_disconnected")},_.getConnectedToSignalingServer=function(){return f},_.computeMaxAndAvgSpeed=m,_.setMeanInstantSpeed=function(e){l=e},_.getMeanInstantSpeed=function(){return l},_.setBearerToken=function(e){g=e},_.getBearerToken=function(){return g}};t.default=a,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n,r){var i=t?y.default.Methods.POST:y.default.Methods.GET,a=new y.default(i,e,{headers:{Authorization:r}}),s=t?(0,o.default)(t):null;a.isStreamroot=!0,a.send(s).then(function(e){n(null,e)},function(e){n(e,null)})}Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_TRACK_HASH=void 0;var a=n(38),o=r(a),s=n(18),u=r(s),l=n(0),c=r(l),d=n(1),f=r(d),h=n(21),_=r(h),p=n(30),v=r(p),E=n(4),g=n(64),m=n(48),y=r(m),S=n(2),T=r(S),A=n(5),R=r(A),D={TRACKS:"tracks",RECONNECT:"reconnect"},C={INIT:"init",PEERS:"peers",TRACKS:"tracks"},w=t.DEFAULT_TRACK_HASH="defautTrackHash",b=function(){function e(t,n,r){var i=this;(0,c.default)(this,e),this._conf=r.conf,this._status=r.status,this._moduleState=r.moduleState,this._controlStats=r.controlStats;var a=new _.default;this._trackerProtocolVersion=this._conf.CLIENT_TRACKER_PROTOCOL_VERSION,this._playerInterface=t,this._p2pCacheStats=n,this._connected=!1,this._delayReconnection=this._conf.TRACKER_DELAY_INIT,this._timerStore=new v.default,this._callQueue=[],this._pending=!1,this.getEE=function(){return a},r.eventBus.once(T.default.Distributor.READY,this._init.bind(this)),r.eventBus.on(T.default.Tracker.TRACKER_RECONNECTION_REQUEST,function(){i._init()}),r.eventBus.on(T.default.Tracker.TEMP_TRACKER_DISCONNECTION_REQUEST,function(){i.dispose()}),r.eventBus.on(T.default.Tracker.PERM_TRACKER_DISCONNECTION_REQUEST,function(){i.dispose(!0)})}return(0,f.default)(e,[{key:"_getVideoTrackHash",value:function(){var e=this._moduleState.currentTracks.video;return e?e.viewToString():w}},{key:"askPeers",value:function(e,t){var n=function(e,n){t(e,[n])},r={tracks:[this._getVideoTrackHash()],exclusions:e,peer_number:this._conf.MAX_NUMBER_OF_PEERS_ASKED_BY_GET_PEERS_MESSAGE,current_position:this._moduleState.videoCurrentTime,id:(0,g.unwrap)(this._peerID)};this._injectBufferIntoPayload(r),this._sendRequest(C.PEERS,r,n,!0)}},{key:"dispose",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._disconnect(e),this._timerStore.clearAll()}},{key:"_init",value:function(){if(!0!==this._conf.QOS_P2P_DISABLED&&""!==this._conf.TRACKER_URL&&!this._isPermanentlyDisconnected&&this._conf.CONTENT_ACTIVATED){this._trackerURL=this._conf.TRACKER_URL,this._bearerToken=this._status.getBearerToken();var e=(0,g.unwrap)(this._moduleState.content),t=this._conf.P2P_PROTOCOL_VERSION,n=this._conf.ID_CLIENT,r=this._moduleState.isLive(),i=this._status.getTrackerId(),a=void 0;a=r?{content:e,p2p_protocol:t,customer_id:n,is_live:r,buffer_level_max:this._playerInterface.getBufferLevelMax(),tracker_id:i}:{content:e,p2p_protocol:t,customer_id:n,is_live:r,tracker_id:i},this._sendRequest(C.INIT,a,this._onTrackerReady.bind(this),!0)}}},{key:"_onTrackerReady",value:function(e,t){if(e)return void R.default.notifyError(e);this._peerID=t.peer_id,this._status.setMyPeerId(this._peerID);var n=(0,E.createInterval)(this._publishTracks.bind(this),this._conf.SEND_TRACKS_INTERVAL);this._timerStore.registerAs(D.TRACKS,n),this._status.setConnected(!0),this._status.setTrackerId(t.tracker_id),this._connected=!0,this.getEE().emit("tracker_ready")}},{key:"_publishTracks",value:function(){var e={tracks:[this._getVideoTrackHash()],id:(0,g.unwrap)(this._peerID),current_position:this._moduleState.videoCurrentTime};this._injectBufferIntoPayload(e),this._sendRequest(C.TRACKS,e,function(){},!0)}},{key:"_injectBufferIntoPayload",value:function(e){var t=this._p2pCacheStats.getStats();t&&(this._moduleState.isLive()&&(t.near_edge=this._moduleState.isNearEdge),(0,u.default)(e,{buffer:t}))}},{key:"_sendRequest",value:function(e,t,n,r){var a=this;switch(e){case C.INIT:this._controlStats.sentTrackerInitCount++;break;case C.PEERS:this._controlStats.sentTrackerPeersCount++;break;case C.TRACKS:this._controlStats.sentTrackerTracksCount++;break;default:R.default.notifyError(new Error("Unexpected tracker route: "+e))}var o=function(e,t){if(e&&r)return a._disconnect(),a._scheduleReconnect(),void n(e,t);var o=a._callQueue.shift();void 0===o?a._pending=!1:i(o.url,o.data,o.callback,a._bearerToken),n(e,t)},s=this._trackerURL+e;this._pending?this._callQueue.push({url:s,data:t,callback:o}):(this._pending=!0,i(s,t,o,this._bearerToken))}},{key:"_disconnect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._isPermanentlyDisconnected=e,this._timerStore.clearNamedTimer(D.TRACKS),this._timerStore.clearNamedTimer(D.RECONNECT),this._pending=!1,this._callQueue=[],!0===this._connected&&(this._delayReconnection=this._conf.TRACKER_DELAY_INIT,this._status.setConnected(!1),this._connected=!1,i(this._trackerURL+"bye",{id:(0,g.unwrap)(this._peerID)},function(){},this._bearerToken),this.getEE().emit("tracker_disconnected"))}},{key:"_scheduleReconnect",value:function(){var e=(0,E.createTimeout)(this._init.bind(this),this._delayReconnection);this._timerStore.registerAs(D.RECONNECT,e),this._delayReconnection=Math.min(2*this._delayReconnection,this._conf.TRACKER_DELAY_MAX)}}]),e}();t.default=b},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(16),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),c=function(){function e(t){(0,s.default)(this,e),this._collection=new a.default,this._computationInterval=t}return(0,l.default)(e,[{key:"getOrCreate",value:function(e){var t=e.getId(),n=this._collection.get(t);return n||(n=e.getChunksQuantityForInterval(this._computationInterval),this._collection.set(t,n)),n}}]),e}();t.default=c,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(){(0,a.default)(this,e)}return(0,s.default)(e,[{key:"getBinaryData",value:function(e,t,n){throw new Error("must be implemented")}},{key:"setBinaryData",value:function(e,t){throw new Error("must be implemented")}},{key:"setComplete",value:function(){}},{key:"destroy",value:function(){}},{key:"byteLength",get:function(){return this._byteLength},set:function(e){this._byteLength=e}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=ArrayBuffer,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),c=n(10),d=r(c),f=n(9),h=r(f),_=n(193),p=r(_),v=n(192),E=r(v),g=function(e){function t(e){(0,s.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,a.default)(t)).call(this));if("number"==typeof e)n._binaryData=new p.default(e);else{if(!(e instanceof p.default))throw new Error(t.ERR_WRONG_PARAM_TYPE);n._binaryData=e}return n}return(0,h.default)(t,e),(0,l.default)(t,[{key:"getBinaryData",value:function(e,t,n){n(this._binaryData.slice(e,e+t))}},{key:"setBinaryData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;0===t&&e.byteLength===this._binaryData.byteLength?this._binaryData=e:this._binaryData=this._appendBuffer(e,t)}},{key:"_appendBuffer",value:function(e,t){var n=new Uint8Array(this._binaryData);return n.set(new Uint8Array(e),t),n.buffer}},{key:"byteLength",get:function(){return this._binaryData.byteLength},set:function(e){throw new TypeError(t.ERR_CANNOT_SET_BYTE_LENGTH)}}]),t}(E.default);g.ERR_CANNOT_SET_BYTE_LENGTH="Cannot manually set the byteLength",g.ERR_WRONG_PARAM_TYPE="Wrong parameter in Segment Constructor",t.default=g,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(2),l=r(u),c=n(90),d=r(c),f=function(){function e(t){(0,a.default)(this,e),this._ee=t,this.gotoIdle()}return(0,s.default)(e,[{key:"_setState",value:function(e){this._state!==e&&(this._prevState=this._state,this._state=e,this._prevState&&this._ee.emit(l.default.BufferManager.STATE_CHANGED,this._prevState,this._state))}},{key:"gotoIdle",value:function(){this._setState(d.default.IDLE)}},{key:"gotoNoPeer",value:function(){this._setState(d.default.NO_PEER)}},{key:"gotoRandom",value:function(){this._setState(d.default.RANDOM)}},{key:"gotoDynamic",value:function(){this._setState(d.default.DYNAMIC)}},{key:"gotoTopSeeder",value:function(){this._setState(d.default.TOP_SEEDER)}},{key:"getState",value:function(){return this._state}},{key:"isIdle",value:function(){return this._state===d.default.IDLE}},{key:"isNoPeer",value:function(){return this._state===d.default.NO_PEER}},{key:"isRandom",value:function(){return this._state===d.default.RANDOM}},{key:"isDynamic",value:function(){return this._state===d.default.DYNAMIC}},{key:"isTopSeeder",value:function(){return this._state===d.default.TOP_SEEDER}}]),e}();t.default=f,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={ZERO:"zero",CRITICALLY_LOW:"crit_low",LOW:"low",MODERATE:"moderate",HIGH:"high"};t.default=r,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={LOW:"target_low",HIGH:"target_high",RANDOM:"target_random",INIT:"target_init"};t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(17),l=n(4),c=n(35),d=r(c),f=1e3,h=function(){function e(t){(0,a.default)(this,e),this._uploadSpeedDelta=new u.Delta,this._uploadSpeedTimestampDelta=new u.Delta(Date.now()),this._sharedState=t,this._uploadCapacityEMWA=new d.default(0,this._sharedState.conf.LIVE.BUFFER_LEVEL_UPLOAD_SPEED_EMWA_WEIGHT),this._uploadSpeedInterval=(0,l.createInterval)(this._refreshUploadSpeed.bind(this),f)}return(0,s.default)(e,[{key:"_refreshUploadSpeed",value:function(){var e=this._sharedState.transferStats.p2pUploaded,t=this._uploadSpeedDelta.calcDelta(e),n=this._uploadSpeedTimestampDelta.calcDelta(Date.now()),r=8*t/n;r>0&&this._uploadCapacityEMWA.update(r)}},{key:"dispose",value:function(){this._uploadSpeedInterval.clear()}},{key:"uploadCapacityEMWA",get:function(){return this._uploadCapacityEMWA.value}}]),e}();t.default=h,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(21),l=r(u),c=n(30),d=r(c),f=n(2),h=r(f),_=n(5),p=r(_),v=n(4),E=function(){function e(t){(0,a.default)(this,e),this._isCommunicating=!0,this._isConnected=!0,this._rtt=-1,this._ee=new l.default,this._timerStore=new d.default,this._sharedState=t}return(0,s.default)(e,[{key:"_sendHeartbeat",value:function(){return this.sendMessage("heartbeat",{videoTrack:this._getVideoTrack()})}},{key:"_manageHeartbeat",value:function(){var e=this;this._sendHeartbeat();var t=(0,v.createInterval)(function(){e._isCommunicating||(e._sharedState.controlStats.checkHeartbeatFailed++,e._closeConnectionIfOpen()),e._isCommunicating=!1},this._sharedState.conf.CHECK_HEARTBEAT_INTERVAL),n=(0,v.createInterval)(this._sendHeartbeat.bind(this),this._sharedState.conf.SEND_HEARTBEAT_INTERVAL);this._timerStore.register(t),this._timerStore.register(n)}},{key:"_getVideoTrack",value:function(){var e="noTrack";return this._sharedState.moduleState.currentTracks.video&&(e=this._sharedState.moduleState.currentTracks.video.viewToString()),e}},{key:"_setDisconnected",value:function(){return this._isConnected?(this._isConnected=!1,void this._ee.emit(h.default.PeerConnection.DISCONNECTED)):void p.default.notifyError(new Error("Guarded attempt to trigger 'disconnected' event on PeerConnection more than once"))}},{key:"_closeConnectionIfOpen",value:function(){throw new Error("Cannot call abstract method")}},{key:"sendMessage",value:function(e,t){throw new Error("Cannot call abstract method")}},{key:"sendBinaryData",value:function(e,t){throw new Error("Cannot call abstract method")}},{key:"emit",value:function(e){for(var t,n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=this._ee).emit.apply(t,[e].concat(r))}},{key:"on",value:function(e,t){this._ee.on(e,t)}},{key:"once",value:function(e,t){this._ee.once(e,t)}},{key:"removeListener",value:function(e,t){this._ee.removeListener(e,t)}},{key:"getRtt",value:function(){return this._rtt}},{key:"getBufferedAmount",value:function(){throw new Error("Cannot call abstract method")}},{key:"onbufferedamountlow",set:function(e){throw new Error("Cannot call abstract method")}}]),e}();t.default=E,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(21),l=(r(u),n(2)),c=r(l),d=n(4),f=function(){function e(t,n){var r=this;(0,a.default)(this,e),this._stoppedAskingPeers=!1,this._conf=t,this._eventBus=n,this._updateSegmentTransferToPlayerTimestamp(),this._initTickInerval(),n.on(c.default.SRModuleInterface.SEGMENT_TRANSFERED_TO_MEDIA_ENGINE,function(){r._updateSegmentTransferToPlayerTimestamp()})}return(0,s.default)(e,[{key:"dispose",value:function(){this._tickInterval.clear()}},{key:"_initTickInerval",value:function(){var e=this;this._tickInterval=(0,d.createInterval)(function(){e._checkTimeSinceLastSegmentTransferToPlayer()},1e3)}},{key:"_updateSegmentTransferToPlayerTimestamp",value:function(){this._lastSegmentToPlayerTransferTimestamp=Date.now(),this._stoppedAskingPeers&&this._startAskingPeers()}},{key:"_checkTimeSinceLastSegmentTransferToPlayer",value:function(){Date.now()-this._lastSegmentToPlayerTransferTimestamp>=Number(this._conf.SEGMENT_REQUEST_TIMEOUT_TO_STOP_ASKING_PEERS)&&this._stopAskingPeers()}},{key:"_stopAskingPeers",value:function(){!1===this._stoppedAskingPeers&&(this._stoppedAskingPeers=!0,this._eventBus.emit(c.default.PeerPool.STOP_ASKING_PEERS),this._tickInterval.clear())}},{key:"_startAskingPeers",value:function(){this._stoppedAskingPeers&&(this._stoppedAskingPeers=!1,this._eventBus.emit(c.default.PeerPool.START_ASKING_PEERS),this._initTickInerval())}}]),e}();t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(21),l=(r(u),n(2)),c=r(l),d=n(4),f=function(){function e(t,n){var r=this;(0,a.default)(this,e),this._tempDisconnectedFromBackend=!1,this._conf=t,this._eventBus=n,this._updateTransferTimestamp(),this._initTickInerval(),n.on(c.default.UploadQueue.CHUNK_REQUESTED,function(){r._updateTransferTimestamp()}),n.on(c.default.ChunkManager.CHUNK_DOWNLOADED,function(){r._updateTransferTimestamp()}),n.on(c.default.SRModuleInterface.SEGMENT_TRANSFERED_TO_MEDIA_ENGINE,function(){r._updateTransferTimestamp()})}return(0,s.default)(e,[{key:"dispose",value:function(){this._tickInterval.clear()}},{key:"_initTickInerval",value:function(){var e=this;this._tickInterval=(0,d.createInterval)(function(){e._checkTimeSinceLastTransfer()},1e3)}},{key:"_updateTransferTimestamp",value:function(){this._lastTransferTimestamp=Date.now(),this._tempDisconnectedFromBackend&&this._reconnectToBackend()}},{key:"_checkTimeSinceLastTransfer",value:function(){Date.now()-this._lastTransferTimestamp>=Number(this._conf.TRANSFER_ACTIVITY_TIMEOUT_TO_DISCONNECT_FROM_BACKEND)&&this._temporarilyDisconnectFromBackend()}},{key:"_temporarilyDisconnectFromBackend",value:function(){!1===this._tempDisconnectedFromBackend&&(this._tempDisconnectedFromBackend=!0,this._eventBus.emit(c.default.Tracker.TEMP_TRACKER_DISCONNECTION_REQUEST),this._eventBus.emit(c.default.Signaling.TEMP_SIGNALING_DISCONNECTION_REQUEST),this._eventBus.emit(c.default.TrafficAnalytics.STOP_SENDING_USAGE),this._tickInterval.clear())}},{key:"_reconnectToBackend",value:function(){this._tempDisconnectedFromBackend&&(this._tempDisconnectedFromBackend=!1,this._eventBus.emit(c.default.Tracker.TRACKER_RECONNECTION_REQUEST),this._eventBus.emit(c.default.Signaling.SIGNALING_RECONNECTION_REQUEST),this._eventBus.emit(c.default.TrafficAnalytics.RESTART_SENDING_USAGE),this._initTickInerval())}}]),e}();t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(21),l=(r(u),n(201)),c=r(l),d=n(200),f=r(d),h=n(2),_=r(h),p=function(){function e(t,n){var r=this;(0,a.default)(this,e),this._conf=t,this._eventBus=n,this._eventBus.on(_.default.Config.CONFIG_UPDATED,function(){r._init()}),this._init()}return(0,s.default)(e,[{key:"dispose",value:function(){this._backendConnectionManager&&this._backendConnectionManager.dispose(),this._askPeersManager&&this._askPeersManager.dispose()}},{key:"_init",value:function(){this._conf.TRANSFER_ACTIVITY_TIMEOUT_TO_DISCONNECT_FROM_BACKEND&&!this._backendConnectionManager&&(this._backendConnectionManager=new c.default(this._conf,this._eventBus)),this._conf.SEGMENT_REQUEST_TIMEOUT_TO_STOP_ASKING_PEERS&&!this._askPeersManager&&(this._askPeersManager=new f.default(this._conf,this._eventBus))}}]),e}();t.default=p,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var i=n(18),a=r(i),o=n(38),s=r(o),u=n(31),l=r(u),c=n(7),d=r(c),f=n(0),h=r(f),_=n(1),p=r(_),v=n(10),E=r(v),g=n(9),m=r(g),y=n(199),S=r(y),T=n(207),A=r(T),R=n(5),D=r(R),C=n(100),w=r(C),b=n(2),O=r(b),P=n(206),L=r(P),I=n(4),k=n(230),N=function(e){function t(e,n,r,i){(0,h.default)(this,t);var a=(0,E.default)(this,(t.__proto__||(0,d.default)(t)).call(this,i));return a._rtcPeerConnection=e,a._rtcDataChannel=n,a._segmentCoord=r,a._initialize(),a}return(0,m.default)(t,e),(0,p.default)(t,[{key:"_initialize",value:function(){var e=this;this._rtcDataChannel.bufferedAmountLowThreshold=this._sharedState.conf.UP_BUFFERED_AMOUNT_LOW_THRESHOLD,this._rtcDataChannel.onclose=function(){e._setDisconnected()},this._rtcDataChannel.onerror=function(t){e._setDisconnected()},this._rtcDataChannel.onmessage=this._messageHandler.bind(this),this._rtcPeerConnection.oniceconnectionstatechange=function(){switch(e._rtcPeerConnection.iceConnectionState){case"failed":case"closed":e._rtcPeerConnection.oniceconnectionstatechange=function(){},e._closeConnectionIfOpen()}},this._manageHeartbeat();var t=(0,I.createInterval)(this._updateRTT.bind(this),this._sharedState.conf.PEER_COMPUTE_RTT_INTERVAL);this._timerStore.register(t)}},{key:"_messageHandler",value:function(e){switch(this._isCommunicating=!0,(0,l.default)(e.data)){case"string":this._messageDataHandler(e.data);break;
            default:this._binaryDataHandler(e.data)}}},{key:"_messageDataHandler",value:function(e){this._sharedState.transferStats.p2pMessagesDownloaded+=e.length,this._sharedState.transferStats.p2pMessagesCount++;var t=A.default.decode(JSON.parse(e));this.emit(O.default.PeerConnection.MESSAGE_RECEIVED,t.type,t.args)}},{key:"_binaryDataHandler",value:function(e){var t=(0,k.parseMetaData)(e,this._segmentCoord.fromArrayBuffer);this._sharedState.transferStats.p2pHeadersDownloaded+=e.byteLength-t.data.byteLength,this._sharedState.transferStats.p2pMediaDownloaded+=t.data.byteLength,this.emit(O.default.PeerConnection.BINARY_DATA_RECEIVED,t.data,t.chunkIndex,t.segmentCoord)}},{key:"_closeConnectionIfOpen",value:function(){"closing"!==this._rtcDataChannel.readyState&&"closed"!==this._rtcDataChannel.readyState&&this._rtcDataChannel.close(),"closed"!==this._rtcPeerConnection.signalingState&&this._rtcPeerConnection.close(),this._setDisconnected()}},{key:"_handleSendFailure",value:function(e){var t=new Error(e);D.default.notifyError(t),this._setDisconnected()}},{key:"_updateRTT",value:function(){var e=this;w.default.getPeerConnectionRTT(this._rtcPeerConnection,function(t){e._rtt=t})}},{key:"sendMessage",value:function(e,t){if("open"===this._rtcDataChannel.readyState){var n=A.default.encode(e,t),r=(0,s.default)(n);try{this._rtcDataChannel.send(r)}catch(e){return this._handleSendFailure("sendMessage failed while data channel open"),!1}return!0}return this._handleSendFailure("sendMessage failed: DataChannel readyState is not open but "+this._rtcDataChannel.readyState),!1}},{key:"sendBinaryData",value:function(e,t){var n=(0,k.encodeMetaData)(e,t);if("open"===this._rtcDataChannel.readyState){try{this._rtcDataChannel.send(n)}catch(e){return this._handleSendFailure("sendBinaryData failed while data channel open"),!1}return!0}return this._handleSendFailure("sendBinaryData failed: DataChannel readyState is not open but "+this._rtcDataChannel.readyState),!1}},{key:"close",value:function(){this._closeConnectionIfOpen(),this.destroy()}},{key:"destroy",value:function(){this._timerStore.clearAll(),(0,a.default)(this,new L.default)}},{key:"getBufferedAmount",value:function(){return this._rtcDataChannel.bufferedAmount}},{key:"onbufferedamountlow",set:function(e){this._rtcDataChannel.onbufferedamountlow=e}}]),t}(S.default);e.exports=N},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){R.default.notifyError(e)}Object.defineProperty(t,"__esModule",{value:!0});var a=n(37),o=r(a),s=n(106),u=r(s),l=n(18),c=r(l),d=n(8),f=r(d),h=n(16),_=r(h),p=n(0),v=r(p),E=n(1),g=r(E),m=n(209),y=r(m),S=n(203),T=r(S),A=n(5),R=r(A),D=n(100),C=r(D),w=n(229),b=r(w),O=n(30),P=r(O),L=n(4),I=n(36),k=r(I),N=/typ srflx/,M={ordered:!1,maxRetransmits:1},U=function(){function e(t,n,r,i){(0,v.default)(this,e),this._sharedState=i,this._conf=i.conf,this._controlStats=i.controlStats,this._signalingClient=new y.default(i),this._myPeerId=t,this._peerPool=n,this._peerStats=i.peerStats,this._signalingClient.connect(this._conf.SIGNALING_URL,t),this._signalingClient.on("webrtc_offer",this._onOffer.bind(this)),this._signalingClient.on("webrtc_answer",this._onAnswer.bind(this)),this._signalingClient.on("webrtc_icecandidate",this._onIceCandidate.bind(this)),this._peerConnectionCollection=new _.default,this.SegmentCoord=r,this._timerStore=new P.default}return(0,g.default)(e,[{key:"_autoSelectDataChannelType",value:function(){var e=k.default.getUAObject().browser;return"Firefox"===e.name&&"53"===e.major?"limited-retransmits":"limited-lifetime"}},{key:"_getDataChannelOptions",value:function(){var e=this._conf.DATACHANNEL_TYPE;switch("auto"===e&&(e=this._autoSelectDataChannelType()),e){case"reliable":return{ordered:!0};case"limited-lifetime":return{ordered:!1,maxPacketLifeTime:this._conf.DATACHANNEL_MAX_PACKET_LIFETIME};case"limited-retransmits":return{ordered:!1,maxRetransmits:this._conf.DATACHANNEL_MAX_RETRANSMITS};default:return R.default.notifyError(new Error("Invalid data channel type in injected config.")),M}}},{key:"createPeerConnection",value:function(e){var t=this,n=Math.random().toString().substr(2),r=C.default.createPeerConnection(this._conf),a=r.createDataChannel("comm",this._getDataChannelOptions());a.binaryType="arraybuffer";var o=Date.now(),s=this._manageConnectionTimeout(r,e,n,!0),u=this._createOpenDataChannelHandler(r,a,s,e,n,!0);a.onopen=u;var l={remotePeerId:e,rtcPeerConnection:r,connectionAttemptTimestamp:o,connectionTimeout:s,rtcDataChannel:a,connectionProgress:{hasLocalDescription:!1,hasRemoteDescription:!1,hasLocalDescriptionWithStun:!1,hasRemoteDescriptionWithStun:!1,hasLocalStunIceCandidate:!1,hasRemoteStunIceCandidate:!1}};this._peerConnectionCollection.set(n,l),r.createOffer(function(a){r.setLocalDescription(a,function(){var r=t._conf.TRANSFORM_SDP?C.default.transformOutgoingSdp(a.sdp):a.sdp,i={type:"webrtc_offer",connexion_id:n,sender_id:t._myPeerId,receiver_id:e,sdp:r};t._signalingClient.send(i),l.connectionProgress.hasLocalDescription=!0,N.test(r)&&(l.connectionProgress.hasLocalDescriptionWithStun=!0)},i)},i),this._manageIceCandidate(r,e,n)}},{key:"_manageIceCandidate",value:function(e,t,n){var r=this,i=this._createIceCandidateBucket(this._myPeerId,t,n);this._peerConnectionCollection.get(n).iceCandidatesBucket=i,e.onicecandidate=function(t){if(t.candidate){i.add(t.candidate);var a=r._peerConnectionCollection.get(n);a&&N.test(t.candidate.candidate)&&(a.connectionProgress.hasLocalStunIceCandidate=!0)}"complete"===e.iceGatheringState&&i.triggerEnd()&&(r._controlStats.earlyIceGatheringFinishedCount++,r._controlStats.setSampledIceGatheringDuration(i.timespan))}}},{key:"_onConnexionRefused",value:function(e,t){this._peerConnectionCollection.get(t).rtcPeerConnection.close(),this._peerConnectionCollection.delete(t),this._peerPool.offerDeclined(e)}},{key:"_onConnexionTimeout",value:function(e,t,n,r,i){e.oniceconnectionstatechange=function(){},this._timerStore.clear(i);var a=this._peerConnectionCollection.get(n);this._peerStats.incrementTimeout(e.iceConnectionState,e.iceGatheringState,r,a.connectionProgress),a.iceCandidatesBucket&&a.iceCandidatesBucket.cancel(),"have-local-offer"===e.signalingState&&this._peerStats.unansweredOffer++,e.close();var o=this._peerConnectionCollection.get(n);void 0!==o.connectionAttemptTimestamp&&this._peerStats.failedPeerConnectionAttemptDuration.addSample(Date.now()-o.connectionAttemptTimestamp),this._peerConnectionCollection.delete(n),this._peerPool.connectionAttemptTimeout(t)}},{key:"_manageConnectionTimeout",value:function(e,t,n,r){var i=this,a=(0,L.createTimeout)(function(){i._onConnexionTimeout(e,t,n,r,a)},this._conf.PEER_CONNECTION_TIMEOUT);return this._timerStore.register(a),e.oniceconnectionstatechange=function(){switch(e.iceConnectionState){case"failed":i._onConnexionTimeout(e,t,n,r,a)}},a}},{key:"_onOffer",value:function(e){var t=this;this._peerStats.offer++;var n=e.sender_id,r=e.connexion_id;if(this.getOpenConnectorSlotsCount()<=0){var a={type:"webrtc_answer",connexion_id:r,sender_id:this._myPeerId,receiver_id:n,accepted:!1};return void this._signalingClient.send(a)}var o=C.default.createPeerConnection(this._conf),s={remotePeerId:n,rtcPeerConnection:o,offeredAttemptTimestamp:Date.now(),connectionProgress:{hasLocalDescription:!1,hasRemoteDescription:!1,hasLocalDescriptionWithStun:!1,hasRemoteDescriptionWithStun:!1,hasLocalStunIceCandidate:!1,hasRemoteStunIceCandidate:!1}};this._peerConnectionCollection.set(r,s),this._manageIceCandidate(o,n,r);var u={sdp:e.sdp,type:"offer"},l=new C.default.SessionDescription(u);o.setRemoteDescription(l,function(){o.createAnswer(function(e){o.setLocalDescription(e,function(){e.sdp=t._conf.TRANSFORM_SDP?C.default.transformOutgoingSdp(e.sdp):e.sdp;var i={type:"webrtc_answer",connexion_id:r,sender_id:t._myPeerId,receiver_id:n,accepted:!0,sdp:e.sdp};t._signalingClient.send(i),s.connectionProgress.hasLocalDescription=!0,N.test(e.sdp)&&(s.connectionProgress.hasLocalDescriptionWithStun=!0)},i)},i),s.connectionProgress.hasRemoteDescription=!0,N.test(l.sdp)&&(s.connectionProgress.hasRemoteDescriptionWithStun=!0)},i);var c=this._manageConnectionTimeout(o,n,r,!1);o.ondatachannel=function(e){var a=e.channel||e;s.rtcDataChannel=a,a.binaryType="arraybuffer";var u=t._createOpenDataChannelHandler(o,a,c,n,r,!1);"connecting"===a.readyState?a.onopen=u:u(),a.onerror=i}}},{key:"_createOpenDataChannelHandler",value:function(e,t,n,r,i,a){var o=this;return function(){if(!o._peerConnectionCollection.get(i))return void o._peerStats.lateMessage++;var s=o._peerConnectionCollection.get(i);void 0!==s.connectionAttemptTimestamp&&o._peerStats.successPeerConnectionAttemptDuration.addSample(Date.now()-s.connectionAttemptTimestamp),o._peerConnectionCollection.delete(i),o._timerStore.clear(n);var u=new T.default(e,t,o.SegmentCoord,o._sharedState);o._peerPool.addPeerConnection(r,u,a)}}},{key:"_onAnswer",value:function(e){var t=e.sender_id,n=e.connexion_id;if(!this._peerConnectionCollection.get(n))return void this._peerStats.lateMessage++;var r=this._peerConnectionCollection.get(n),a=r.rtcPeerConnection,o=r.connectionTimeout,s=r.connectionProgress;if(a)if(e.accepted){var u={sdp:e.sdp,type:"answer"},l=new C.default.SessionDescription(u);a.setRemoteDescription(l,function(){s.hasRemoteDescription=!0,N.test(l.sdp)&&(s.hasRemoteDescriptionWithStun=!0)},i)}else this._timerStore.clear(o),this._onConnexionRefused(t,n)}},{key:"_onIceCandidate",value:function(e){var t=e.connexion_id;if(!this._peerConnectionCollection.get(t))return void this._peerStats.lateMessage++;for(var n=this._peerConnectionCollection.get(t),r=n.rtcPeerConnection,i=n.connectionProgress,a=0;a<e.icecandidate_array.length;a++){var o=e.icecandidate_array[a];N.test(o.candidate)&&(i.hasRemoteStunIceCandidate=!0),this._addIceCandidate(r,o)}}},{key:"_addIceCandidate",value:function(e,t){try{e.addIceCandidate(new C.default.IceCandidate(t))}catch(e){R.default.notifyError(e)}}},{key:"_createIceCandidateBucket",value:function(e,t,n){var r=this;return this._controlStats.iceCandidatesBucketCount++,new b.default(function(i){r._signalingClient.send({connexion_id:n,icecandidate_array:i,receiver_id:t,sender_id:e,type:"webrtc_icecandidate"})},function(){r._controlStats.gatheredIceCandidateCount++},function(){r._controlStats.missedIceCandidateCount++},this._conf.ICECANDIDATES_TIMEOUT)}},{key:"getPeerConnectionCount",value:function(){return this._peerConnectionCollection.size}},{key:"getOpenConnectorSlotsCount",value:function(){return Math.max(Math.round(this._peerPool.openSlotsCount()-this.getPeerConnectionCount()*this._conf.EXPECTED_CONNECTION_SUCCESS_RATE),0)}},{key:"dispose",value:function(){this._signalingClient.close(),this._timerStore.clearAll();var e=!0,t=!1,n=void 0;try{for(var r,i=(0,f.default)(this._peerConnectionCollection.values());!(e=(r=i.next()).done);e=!0){var a=r.value,o=a.rtcPeerConnection,s=a.rtcDataChannel,u=function(){};o.onicecandidate=u,o.oniceconnectionstatechange=u,o.ondatachannel=u,o.close(),s&&(s.onopen=u,s.onerror=u)}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}},{key:"getPendingConnectionDebugInfos",value:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var i,a=(0,f.default)(this._peerConnectionCollection.values());!(t=(i=a.next()).done);t=!0){var o=i.value,s=o.rtcPeerConnection,u=s.iceGatheringState,l=s.signalingState,d=s.iceConnectionState,h=o.rtcDataChannel?o.rtcDataChannel.readyState:"offered",_=o.connectionAttemptTimestamp||o.offeredAttemptTimestamp,p=_?Math.round((_+this._conf.PEER_CONNECTION_TIMEOUT-Date.now())/1e3):"unavailable",v={id:o.remotePeerId.slice(-7),timestamp:_,remainingTimeout:p,iceGatheringState:u,signalingState:l,iceConnectionState:d,readyState:h};e.push((0,c.default)(v,o.connectionProgress))}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}return e}},{key:"getPendingConnectionPeers",value:function(){var e=new u.default,t=!0,n=!1,r=void 0;try{for(var i,a=(0,f.default)(this._peerConnectionCollection.values());!(t=(i=a.next()).done);t=!0){var s=i.value;e.add(s.remotePeerId)}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}return(0,o.default)(e)}}]),e}();t.default=U,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){var t=[],n=e.split(","),r=!0,i=!1,a=void 0;try{for(var s,c=(0,u.default)(n);!(r=(s=c.next()).done);r=!0){var d=s.value,f=d.split("-"),h=""!==f[0]?Number(f[0]):NaN,_=""!==f[1]?Number(f[1]):NaN;if(1===f.length&&(0,o.default)(h))t.push(h);else{if(2!==f.length||!(0,o.default)(h)||!(0,o.default)(_))throw new Error("P2P protocol error: could not decode chunk batch");t=t.concat((0,l.range)(h,_))}}}catch(e){i=!0,a=e}finally{try{!r&&c.return&&c.return()}finally{if(i)throw a}}return t}Object.defineProperty(t,"__esModule",{value:!0});var a=n(241),o=r(a),s=n(8),u=r(s),l=n(24);t.default={decode:i},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(){(0,a.default)(this,e)}return(0,s.default)(e,[{key:"sendMessage",value:function(){throw new Error("One should not call sendMessage on a PeerConnection that has already been destroyed")}},{key:"sendBinaryData",value:function(){throw new Error("One should not call sendBinaryData on a PeerConnection that has already been destroyed")}},{key:"getRtt",value:function(){throw new Error("One should not call getRtt on a PeerConnection that has already been destroyed")}},{key:"getBufferedAmount",value:function(){throw new Error("One should not call getBufferedAmount on a PeerConnection that has already been destroyed")}},{key:"destroy",value:function(){throw new Error("One should not call destroy on a PeerConnection that has already been destroyed")}},{key:"close",value:function(){throw new Error("One should not call close on a PeerConnection that has already been destroyed")}},{key:"on",value:function(){throw new Error("One should not call on on a PeerConnection that has already been destroyed")}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={a:v[e]},r=l(e),i=o(t,r);return(0,p.default)(n,i),n}function a(e){var t=s(e.a);return{type:t,args:u(e,l(t))}}function o(e,t){var n={},r=!0,i=!1,a=void 0;try{for(var o,s=(0,h.default)((0,d.default)(t));!(r=(o=s.next()).done);r=!0){var u=o.value;if(void 0===e[u])throw new Error("P2P protocol error: missing mandatory property "+u+" from message to encode");var l=t[u];void 0!==l&&(n[l]=e[u])}}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}function s(e){var t=!0,n=!1,r=void 0;try{for(var i,a=(0,h.default)((0,d.default)(v));!(t=(i=a.next()).done);t=!0){var o=i.value;if(v[o]===e)return o}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}return null}function u(e,t){var n={},r=!0,i=!1,a=void 0;try{for(var o,s=(0,h.default)((0,d.default)(t));!(r=(o=s.next()).done);r=!0){var u=o.value,l=t[u],c=e[l];if(void 0===c)throw new Error("P2P protocol error: could not decode property "+u+" from encoded payload");n[u]=c}}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}function l(e){switch(e){case"info":return E;case"heartbeat":return S;case"requestHasSegment":return g;case"hasSegment":return m;case"requestChunks":return y;default:throw new Error("P2P protocol error: unhandled message type")}}Object.defineProperty(t,"__esModule",{value:!0});var c=n(52),d=r(c),f=n(8),h=r(f),_=n(18),p=r(_),v={info:"a",requestHasSegment:"b",hasSegment:"c",requestChunks:"d",heartbeat:"e"},E={city:"c",country:"d",latitude:"e",longitude:"f"},g={segmentCoord:"b"},m={segmentInfo:"b",pushed:"c"},y={segmentCoord:"b",ids:"c",safe:"d"},S={videoTrack:"b"};t.default={encode:i,decode:a},e.exports=t.default},function(e,t,n){"use strict";function r(e,t,n,r){return new i(e,t,n,r)}Object.defineProperty(t,"__esModule",{value:!0});var i=void 0;i=n(204),t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(38),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),c=n(49),d=r(c),f=n(5),h=r(f),_=n(2),p=r(_),v=n(4),E=function(){function e(t){var n=this;(0,s.default)(this,e),this._conf=t.conf,this._status=t.status,this._controlStats=t.controlStats,t.eventBus.on(p.default.Signaling.SIGNALING_RECONNECTION_REQUEST,function(){n._createConnection()}),t.eventBus.on(p.default.Signaling.TEMP_SIGNALING_DISCONNECTION_REQUEST,function(){n.close()}),t.eventBus.on(p.default.Signaling.PERM_SIGNALING_DISCONNECTION_REQUEST,function(){n.close(!0)}),this._init()}return(0,l.default)(e,[{key:"connect",value:function(e,t){this._url=e,this._id=t,""!==this._url&&this._createConnection()}},{key:"send",value:function(e){if(this._connection&&this._connection.readyState===WebSocket.OPEN){var t=e.receiver_id+","+(0,a.default)(d.default.omit(e,"receiver_id"));switch(this._connection.send(t),this._controlStats.signalingMessagesCount++,e.type){case"webrtc_answer":this._controlStats.sentAnswerSdpVolume+=t.length;break;case"webrtc_offer":this._controlStats.sentOfferSdpVolume+=t.length;break;case"webrtc_icecandidate":this._controlStats.sentIceCandidatesVolume+=t.length;break;default:h.default.notifyError(new Error("Invalid signaling message type sent."))}}else this._msgBuffer.push(e)}},{key:"on",value:function(e,t){this._handlers[e]=t}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._isPermanentlyDisconnected=e,this._disposing=!0,this._status.setDisconnectedToSignalingServer(),this._stopReconnectionLoop(),this._connection&&this._connection.close(),void 0!==this._connectionTimeout&&(this._connectionTimeout.clear(),delete this._connectionTimeout),void 0!==this._nextReconnectAttempt&&(this._nextReconnectAttempt.clear(),delete this._nextReconnectAttempt),this._init()}},{key:"_createConnection",value:function(){if(!this._isPermanentlyDisconnected){this._disposing=!1,!this._connection||this._connection.readyState!==WebSocket.CONNECTING&&this._connection.readyState!==WebSocket.OPEN||this.close(),this._connection=new WebSocket(this._url+"?id="+this._id+"&p2pVersion=4.10.14&client_id="+this._conf.ID_CLIENT);var e=this._connection;this._connectionTimeout=(0,v.createTimeout)(function(){e.close()},1e4),this._handleConnectionSuccess(),this._handleErrorAndClose(),this._handleMessages()}}},{key:"_handleErrorAndClose",value:function(){var e=this,t=this._connection,n=function(){t===e._connection&&(h.default.notify("Error on signaling connection"),e._status.setDisconnectedToSignalingServer(),e._tryReconnect())};this._connection.onerror=n,this._connection.onclose=n}},{key:"_tryReconnect",value:function(){var e=this,t=function(){delete e._nextReconnectAttempt,e._createConnection(),e._updateDelay()};if(void 0===this._nextReconnectAttempt&&!this._disposing){var n=this._delayReconnection;0===n&&(n=Math.round(Math.random()*this._conf.SIGNALING_DELAY_MAX_INIT)),this._nextReconnectAttempt=(0,v.createTimeout)(t,n)}}},{key:"_updateDelay",value:function(){this._delayReconnection=Math.min(this._delayReconnection+this._conf.SIGNALING_DELAY_STEP,this._conf.SIGNALING_DELAY_MAX)}},{key:"_handleConnectionSuccess",value:function(){var e=this;this._connection.onopen=function(){e._status.setConnectedToSignalingServer(),e._connectionTimeout&&(e._connectionTimeout.clear(),delete e._connectionTimeout),e._stopReconnectionLoop(),e._sendMessagesInBuffer()}}},{key:"_handleMessages",value:function(){var e=this;this._connection.onmessage=function(t){var n=JSON.parse(t.data);if(e._handlers[n.type]){var r=d.default.omit(n,"type");e._handlers[n.type](r)}}}},{key:"_init",value:function(){this._handlers={},this._delayReconnection=0,this._msgBuffer=[]}},{key:"_stopReconnectionLoop",value:function(){this._delayReconnection=0}},{key:"_sendMessagesInBuffer",value:function(){for(var e=0;e<this._msgBuffer.length;e++)this.send(this._msgBuffer[e]);this._msgBuffer=[]}}]),e}();t.default=E,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(){(0,a.default)(this,e)}return(0,s.default)(e,[{key:"viewToString",value:function(){return""}},{key:"isEqual",value:function(e){return!0}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),c=n(10),d=r(c),f=n(9),h=r(f),_=n(91),p=r(_),v=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,a.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,l.default)(t,[{key:"getSegmentListToDownload",value:function(){var e=[],t=this._currentTracks.audio;t&&(e=this._getSegmentsToDownloadByTrack(t,"audio"),this._sharedState.conf.ENABLE_P2P_SCHEDULER_OPTIM&&(e=e.slice(0,this._sharedState.conf.NB_SEGMENT_P2P_PREBUFFER)));var n=[],r=this._currentTracks.video;return r&&(n=this._getSegmentsToDownloadByTrack(r,"video"),this._sharedState.conf.ENABLE_P2P_SCHEDULER_OPTIM&&(n=n.slice(0,this._sharedState.conf.NB_SEGMENT_P2P_PREBUFFER))),this._cachedSegmentToDownload=e.concat(n).sort(function(e,t){return e.getId()-t.getId()}).slice(0,this._sharedState.conf.NB_SEGMENT_P2P_PREBUFFER),this._cachedSegmentToDownload}},{key:"updateTrackEdge",value:function(e){var t=this._findTrack(e);"audio"===t?this._edges.update({audio:e,video:null}):"video"===t&&this._edges.update({audio:null,video:e})}},{key:"_findTrack",value:function(e){var t=this._currentTracks.video;if(t&&e.isInTrack(t))return"video";var n=this._currentTracks.audio;return n&&e.isInTrack(n)?"audio":void 0}}]),t}(p.default);t.default=v,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),c=n(10),d=r(c),f=n(9),h=r(f),_=n(91),p=r(_),v=function(e){function t(){return(0,s.default)(this,t),(0,d.default)(this,(t.__proto__||(0,a.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,l.default)(t,[{key:"getSegmentListToDownload",value:function(){var e=[],t=this._currentTracks.video;return t&&(e=this._getSegmentsToDownloadByTrack(t,"video")),this._cachedSegmentToDownload=e.sort(function(e,t){return e.getId()-t.getId()}).slice(0,this._sharedState.conf.NB_SEGMENT_P2P_PREBUFFER),this._cachedSegmentToDownload}},{key:"updateTrackEdge",value:function(e){this._currentTracks.video&&e.isInTrack(this._currentTracks.video)&&this._edges.update({video:e,audio:null})}}]),t}(p.default);t.default=v,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(21),l=(r(u),n(2)),c=r(l),d=n(35),f=r(d),h=n(98),_=r(h),p=n(99),v=r(p),E=.1,g=10,m=function(){function e(t){var n=this;(0,a.default)(this,e),this._bandwidthEstimates=[],this._latencyHistory=new v.default(g),this.cdnSpeed=null,this.cdnTimestamp=null,this.p2pSpeed=0,this.estimatedBitrate=0,this.p2pUsefulEstimate=1,this.concurrentP2pDownloaded=0,this.concurrentP2pDownloadCount=0,this.cdnEstimationCount=0,this.zeroP2pSpeedWindowsCount=0,this.p2pSpeedWindowsCount=0,this.feebackCount=0,this.zeroDurationFeedbackCount=0,this.trackSwitchWithPeers=0,this._addBandwidthEstimate=function(e){n.feebackCount++;var t=e.p2pDuration+e.cdnDuration;if(0===t)return void n.zeroDurationFeedbackCount++;var r=e.p2pDownloaded+e.cdnDownloaded/t;n._bandwidthEWMA?n._bandwidthEWMA.update(r):n._bandwidthEWMA=new f.default(r,E),n._bandwidthEstimates.push(n._bandwidthEWMA.value),null!=e.latency&&e.cdnDownloaded>0&&n._latencyHistory.addSample(e.latency)},this._eventBus=t,this._eventBus.on(c.default.SRModuleInterface.ABR_FEEDBACK,this._addBandwidthEstimate)}return(0,s.default)(e,[{key:"flushBandwidthEstimates",value:function(){this._bandwidthEstimates=[]}},{key:"dispose",value:function(){this.flushBandwidthEstimates()}},{key:"bandwidthEstimateCV",get:function(){var e=_.default.meanAbsoluteDeviation(this._bandwidthEstimates),t=_.default.mean(this._bandwidthEstimates);return e&&t&&0!==t?e/t:0}},{key:"latencyHistoricalValue",get:function(){return 0===this._latencyHistory.length?50:Math.round(this._latencyHistory.mean)}}]),e}();t.default=m,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(2),l=r(u),c=n(90),d=r(c),f=n(66),h=r(f),_=function(){function e(t){(0,a.default)(this,e),this._alwaysDynamicBuffer=!0,this._lastLowBuffer=0,this.bufferRefill=0,this.bufferedAmount=0,this.lowerBufferTargetNetChangePerRebound=0,this.sampledHighLowBufferTargetGap=0,this.lowerTargetResetCount=0,this._timeSpentOnEdgeStaircase=new h.default,this._timeSpentWithoutPeerStaircase=new h.default,this._timeSpentDynamicStaircase=new h.default,this._timeSpentTopSeederStaircase=new h.default,this.timeLowerTargetAboveLiveEdgeStaircase=new h.default,this._globalEventBus=t,this._globalEventBus.on(l.default.Scheduler.REACHED_LIVE_EDGE_STATE_CHANGED,this._onLiveEdgeChanged.bind(this)),this._globalEventBus.on(l.default.BufferManager.LOW_BUFFER,this._onLowBuffer.bind(this)),this._globalEventBus.on(l.default.BufferManager.HIGH_BUFFER,this._onHighBuffer.bind(this)),this._globalEventBus.on(l.default.BufferManager.STATE_CHANGED,this._onBufferStateChange.bind(this))}return(0,s.default)(e,[{key:"_onLiveEdgeChanged",value:function(e){var t=e?1:0;this._timeSpentOnEdgeStaircase.updateMetric(t)}},{key:"_onBufferStateChange",value:function(e,t){switch(e){case d.default.NO_PEER:this._timeSpentWithoutPeerStaircase.updateMetric(0);break;case d.default.DYNAMIC:this._timeSpentDynamicStaircase.updateMetric(0);break;case d.default.TOP_SEEDER:this._timeSpentTopSeederStaircase.updateMetric(0)}switch(t){case d.default.NO_PEER:this._timeSpentWithoutPeerStaircase.updateMetric(1),e!==d.default.IDLE&&(this._alwaysDynamicBuffer=!1);break;case d.default.DYNAMIC:this._timeSpentDynamicStaircase.updateMetric(1);break;case d.default.TOP_SEEDER:this._timeSpentTopSeederStaircase.updateMetric(1),this._alwaysDynamicBuffer=!1;break;case d.default.RANDOM:this._alwaysDynamicBuffer=!1}this.bufferState=t}},{key:"_onLowBuffer",value:function(e){this._lastLowBuffer=e}},{key:"_onHighBuffer",value:function(e){this.bufferRefill+=e-this._lastLowBuffer}},{key:"_resetDynamicFlag",value:function(){this._alwaysDynamicBuffer=this.bufferState===d.default.DYNAMIC}},{key:"getTimeSpentOnEdgeRatio",value:function(){return this._timeSpentOnEdgeStaircase.getAverage()}},{key:"getTimeSpentWithoutPeerRatio",value:function(){return this._timeSpentWithoutPeerStaircase.getAverage()}},{key:"getTimeSpentTopSeederRatio",value:function(){return this._timeSpentTopSeederStaircase.getAverage()}},{key:"getTimeSpentDynamicIntegral",value:function(){return this._timeSpentDynamicStaircase.getIntegral()}},{key:"alwaysDynamicBuffer",get:function(){var e=void 0;return e=this.bufferState!==d.default.NO_PEER&&this._alwaysDynamicBuffer,this._resetDynamicFlag(),e}}]),e}();t.default=_,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(){(0,a.default)(this,e),this._sampledIceGatheringDuration=0,this.missedIceCandidateCount=0,this.gatheredIceCandidateCount=0,this.iceCandidatesBucketCount=0,this.earlyIceGatheringFinishedCount=0,this.newPeerConnectionCount=0,this.nbRightHashP2P=0,this.nbWrongHashP2P=0,this.nbRightHashDLM=0,this.nbWrongHashDLM=0,this.checkHeartbeatFailed=0,this.getSegmentSuccess=0,this.getSegmentFallback=0,this.segmentLockTimeout=0,this.fillSegmentSuccess=0,this.fillSegmentFallback=0,this.fillSegmentTimeout=0,this.signalingMessagesCount=0,this.sentOfferSdpVolume=0,this.sentAnswerSdpVolume=0,this.sentIceCandidatesVolume=0,this.sentDistributorRootCount=0,this.sentTrackerInitCount=0,this.sentTrackerPeersCount=0,this.sentTrackerTracksCount=0}return(0,s.default)(e,[{key:"getSampledIceGatheringDuration",value:function(){var e=this._sampledIceGatheringDuration;return this._sampledIceGatheringDuration=0,e}},{key:"setSampledIceGatheringDuration",value:function(e){0===this._sampledIceGatheringDuration&&(this._sampledIceGatheringDuration=e)}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=function(e){return e&&e.__esModule?e:{default:e}}(r),a=function e(){(0,i.default)(this,e),this.receivedChunkRequestCount=0,this.dequeuedReceivedChunkRequestCount=0,this.missedDequeuedChunkRequestCount=0,this.safeChunkRequestCount=0,this.unsafeChunkRequestCount=0,this.safeChunkRequestTimeoutCount=0,this.unsafeChunkRequestTimeoutCount=0,this.gracedChunksCount=0,this.expiredGraceChunksCount=0};t.default=a,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),c=function(){function e(t,n,r){(0,s.default)(this,e),this.abortFragmentCount=0,this.emergencyTrackSwitchCount=0,this.maxBitrate=0,this.minBitrate=0,this._playerInterface=t,this._mediaElementPlaceholder=n,this._mediaMap=r}return(0,l.default)(e,[{key:"duration",get:function(){return!this._playerInterface.isLive()&&this._mediaElementPlaceholder.mediaElement?this._mediaElementPlaceholder.mediaElement.duration:0}},{key:"videoTrackCount",get:function(){var e=this._mediaMap.getTrackList(),t=0,n=!0,r=!1,i=void 0;try{for(var o,s=(0,a.default)(e);!(n=(o=s.next()).done);n=!0){var u=o.value;u.type&&"video"!==u.type||(t++,u.bitrate&&(this.maxBitrate=Math.max(this.maxBitrate,u.bitrate),this.minBitrate=0===this.minBitrate?u.bitrate:Math.min(this.minBitrate,u.bitrate)))}}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}return t}}]),e}();t.default=c,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(66),l=r(u),c=n(92),d=r(c),f=n(93),h=(r(f),n(99)),_=r(h),p=n(234),v=r(p),E=20,g=10,m=function(){function e(t){(0,a.default)(this,e),this.match=0,this.excessMatch=0,this.offer=0,this.openedMatch=0,this.openedOffer=0,this.unansweredOffer=0,this.active=0,this.transfer=0,this.denied=0,this.droppedSameTrack=0,this.droppedOtherTrack=0,this.offerTimeout=0,this.answerTimeout=0,this.timeoutNewConnection=0,this.timeoutCheckingConnection=0,this.timeoutFailedConnection=0,this.timeoutNewIce=0,this.timeoutGatheringIce=0,this.timeoutCompleteIce=0,this.disconnected=0,this.lateMessage=0,this.exclusionSize=0,this.timeoutLocalSdp=0,this.timeoutRemoteSdp=0,this.timeoutLocalSdpWithStun=0,this.timeoutRemoteSdpWithStun=0,this.timeoutWithLocalStunIce=0,this.timeoutWithRemoteStunIce=0,this._statsProvider=t,this.peerPoolUploadCapacity=new l.default,this.locked=new l.default,this.loosers=new l.default,this.successPeerConnectionAttemptDuration=new _.default(E),this.failedPeerConnectionAttemptDuration=new _.default(E),this.dataChannelBufferEmptyingStats=new v.default(g)}return(0,s.default)(e,[{key:"incrementTimeout",value:function(e,t,n,r){switch(n?this.offerTimeout++:this.answerTimeout++,r.hasLocalDescription&&this.timeoutLocalSdp++,r.hasRemoteDescription&&this.timeoutRemoteSdp++,r.hasLocalDescriptionWithStun&&this.timeoutLocalSdpWithStun++,r.hasRemoteDescriptionWithStun&&this.timeoutRemoteSdpWithStun++,r.hasLocalStunIceCandidate&&this.timeoutWithLocalStunIce++,r.hasRemoteStunIceCandidate&&this.timeoutWithRemoteStunIce++,e){case"new":this.timeoutNewConnection++;break;case"checking":this.timeoutCheckingConnection++;break;
            case"failed":this.timeoutFailedConnection++}switch(t){case"new":this.timeoutNewIce++;break;case"gathering":this.timeoutGatheringIce++;break;case"complete":this.timeoutCompleteIce++}}},{key:"sampledPUC",get:function(){return this._statsProvider.getStat(d.default.PeerStats.SAMPLED_PUC)}}]),e}();t.default=m,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(){(0,a.default)(this,e),this._p2pUseful=0,this.cdnDownloaded=0,this.p2pConsumed=0,this.cdnConsumed=0,this.p2pMediaDownloaded=0,this.p2pHeadersDownloaded=0,this.p2pMessagesDownloaded=0,this.p2pMessagesCount=0,this.p2pUploaded=0,this.multipleDlPP=0,this.multipleDlPC=0,this.multipleDlCP=0,this.multipleDlCC=0,this.multipleDlHP=0,this.multipleDlHD=0,this.multipleDlM=0}return(0,s.default)(e,[{key:"p2pUseful",get:function(){return this._p2pUseful},set:function(e){if(e<this._p2pUseful)throw new TypeError("p2pUseful increment is not a positive number");this._p2pUseful=e}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.CurrentTracks=void 0;var i=n(104),a=r(i),o=n(39),s=r(o),u=n(0),l=r(u),c=n(1),d=r(c),f=n(2),h=r(f);t.CurrentTracks=function(){function e(t){(0,l.default)(this,e),this.audio=void 0,this.video=void 0,this._globalEventBus=t,this._lastSwitchTimestamp=s.default,(0,a.default)(this)}return(0,d.default)(e,[{key:"update",value:function(e){var t=e.audio,n=e.video;if(!t&&!n)throw new Error("There must be at least one updated track");!t||this.audio&&this.audio.viewToString()===t.viewToString()||(this.audio=t,this._globalEventBus.emit(h.default.Metrics.TRACK_SWITCH,{isVideo:!1})),!n||this.video&&this.video.viewToString()===n.viewToString()||(this.video=n||this.video,this._lastSwitchTimestamp=Date.now(),this._globalEventBus.emit(h.default.Metrics.TRACK_SWITCH,{isVideo:!0}))}},{key:"lastSwitchTimestamp",get:function(){return this._lastSwitchTimestamp}}]),e}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(51),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),c=n(178),d=r(c),f=n(188),h=r(f),_=n(61),p=r(_),v=n(46),E=function(){function e(t,n,r,i,o){(0,s.default)(this,e),(0,v.checkInterface)(p.default,t),this.segmentCoord=t,this.chunkManager=new d.default(t,n,r,i,o),this.seeders=new h.default(o.conf),(0,a.default)(this)}return(0,l.default)(e,[{key:"dispose",value:function(){this.chunkManager.dispose(),this.seeders.clear()}},{key:"hasChunksToDownload",get:function(){return this.chunkManager.hasChunksToDownload}}]),e}();t.default=E,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(104),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),c=n(5),d=r(c),f=function(){function e(t,n){(0,s.default)(this,e),this.audio=void 0,this.video=void 0,this._mediaMapCache=t,this._moduleState=n.moduleState,(0,a.default)(this)}return(0,l.default)(e,[{key:"update",value:function(e){var t=e.audio,n=e.video;if(void 0===t&&void 0===n)throw new Error("There must be at least one updated track edge");if(t&&(this.audio=t,this._moduleState.audioTrackEdge=t),n){this.video=n;var r=this._mediaMapCache.getSegmentTime(n);this._moduleState.videoTrackEdge=n,null!==r?this._moduleState.videoCurrentTime=r:d.default.notifyError(new Error("Unexpected getSegmentTime error: track edge timestamp is not supposed to be unreliable"))}}}]),e}();t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(50),l=r(u),c=function(){function e(t){(0,a.default)(this,e),this._safeQueue=[],this._unsafeQueue=[],this._sharedState=t}return(0,s.default)(e,[{key:"push",value:function(e){this._sharedState.conf.SPLIT_UPLOAD_QUEUE&&e.bandwidthSafety!==l.default.SAFE?this._unsafeQueue.push(e):this._safeQueue.push(e)}},{key:"shift",value:function(){return this._safeQueue.length?this._safeQueue.shift():this._unsafeQueue.shift()}},{key:"dispose",value:function(){this._safeQueue=[],this._unsafeQueue=[]}},{key:"length",get:function(){return this._safeQueue.length+this._unsafeQueue.length}}]),e}();t.default=c,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),c=n(10),d=r(c),f=n(9),h=r(f),_=n(88),p=r(_),v=function(e){function t(e,n,r,i){(0,s.default)(this,t);var o=(0,d.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n,i));return o._sharedState=r,o}return(0,h.default)(t,e),(0,l.default)(t,[{key:"isExpired",get:function(){var e=this._sharedState.moduleState.isLive()?this._sharedState.conf.LIVE.CHUNK_UP_TIMEOUT:this._sharedState.conf.CHUNK_UP_TIMEOUT;return Date.now()-this._timestamp>e}}]),t}(p.default);t.default=v,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),c=n(10),d=r(c),f=n(9),h=r(f),_=n(223),p=r(_),v=n(97),E=r(v),g=n(2),m=r(g),y=function(e){function t(e,n){(0,s.default)(this,t);var r=new p.default(n),i=(0,d.default)(this,(t.__proto__||(0,a.default)(t)).call(this,r));return i._dataUploaded=0,i._onTransfering=function(){},i._lastBufferedAmountMaxTimestamp=null,i._bufferedAmountAccumulator=0,i._peerConnection=e,i._sharedState=n,i._peerConnection.onbufferedamountlow=i._onBufferedAmountLow.bind(i),i._splittedQueue=r,i}return(0,h.default)(t,e),(0,l.default)(t,[{key:"_validateItem",value:function(e){return!e.isExpired}},{key:"_dequeuedCallback",value:function(e){this._sharedState.efficiencyStats.dequeuedReceivedChunkRequestCount++,this._sharedState.eventBus.emit(m.default.UploadQueue.CHUNK_REQUESTED,this,e)}},{key:"onChunkFound",value:function(e,t){var n=t.byteLength;this._lastBufferedAmountMaxTimestamp&&(this._bufferedAmountAccumulator+=n),this._peerConnection.sendBinaryData(t,e)&&(this._dataUploaded+=n,this._sharedState.transferStats.p2pUploaded+=n,this._onTransfering())}},{key:"onChunkMissed",value:function(){this._sharedState.efficiencyStats.missedDequeuedChunkRequestCount++,this._sharedState.conf.ENABLE_UPLOAD_DEQUEUE_ALL||this.tryDequeue()}},{key:"_canDequeue",value:function(){var e=this._peerConnection.getBufferedAmount()<=this._sharedState.conf.UP_MAX_BUFFERED_AMOUNT;return e||(this._lastBufferedAmountMaxTimestamp=Date.now(),this._bufferedAmountAccumulator=this._peerConnection.getBufferedAmount()),e}},{key:"_onBufferedAmountLow",value:function(){if(this._lastBufferedAmountMaxTimestamp){var e=Date.now()-this._lastBufferedAmountMaxTimestamp;e>0&&this._sharedState.peerStats.dataChannelBufferEmptyingStats.addSample({time:e,amount:this._bufferedAmountAccumulator}),this._lastBufferedAmountMaxTimestamp=null}this._sharedState.conf.ENABLE_UPLOAD_DEQUEUE_ALL?this.tryDequeueAll():this.tryDequeue()}},{key:"dispose",value:function(){this._splittedQueue.dispose()}},{key:"dataUploaded",get:function(){return this._dataUploaded}},{key:"onTransfering",set:function(e){this._onTransfering=e}}]),t}(E.default);t.default=y,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=void 0;u=n(228);var l=function(){function e(){(0,a.default)(this,e),this._disposed=!1}return(0,s.default)(e,[{key:"callHashWorker",value:function(e,t){var n=this;return u(e,function(){n._disposed||t.apply(void 0,arguments)})}},{key:"dispose",value:function(){this._disposed=!0}}]),e}();t.default=l,e.exports=t.default},function(e,t,n){"use strict";function r(){var e={mul32:function(e,t){var n=65535&t;return((t-n)*e|0)+(n*e|0)|0},hashBytes:function(e,t,n){for(var r=3432918353,i=461845907,a=n,o=-4&t,s=0;s<o;s+=4){var u=255&e[s]|(255&e[s+1])<<8|(255&e[s+2])<<16|(255&e[s+3])<<24;u=this.mul32(u,r),u=(131071&u)<<15|u>>>17,u=this.mul32(u,i),a^=u,a=(524287&a)<<13|a>>>19,a=5*a+3864292196|0}switch(u=0,t%4){case 3:u=(255&e[o+2])<<16;case 2:u|=(255&e[o+1])<<8;case 1:u|=255&e[o],u=this.mul32(u,r),u=(131071&u)<<15|u>>>17,u=this.mul32(u,i),a^=u}return a^=t,a^=a>>>16,a=this.mul32(a,2246822507),a^=a>>>13,a=this.mul32(a,3266489909),a^=a>>>16}};self.onmessage=function(t){var n=new Uint8Array(t.data.segmentData),r=e.hashBytes(n,n.length,0).toString();self.postMessage({segmentData:t.data.segmentData,jobIndex:t.data.jobIndex,hash:r},[t.data.segmentData])}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){var t=e.data,n=t.jobIndex,r=t.segmentData,i=t.hash,a=s[n];delete s[n],a(r,i)}function i(e,t){var n=s.push(t)-1;u.postMessage({segmentData:e,jobIndex:n},[e])}Object.defineProperty(t,"__esModule",{value:!0});var a=n(227),o=function(e){return e&&e.__esModule?e:{default:e}}(a),s=[],u=function(){try{var e=URL.createObjectURL(new Blob(["("+o.default.toString()+")()"],{type:"application/javascript"})),t=new Worker(e);return URL.revokeObjectURL(e),t}catch(e){return{onerror:null,onmessage:null,postMessage:function(){},terminate:function(){}}}}();u.onmessage=r,t.default=i,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=n(4),l=function(){function e(t,n,r,i){(0,a.default)(this,e),this._startTime=Date.now(),this._timespan=0,this._callbacks={added:n,finished:t,missed:r},this._elements=[],this._ended=!1,this._timer=(0,u.createTimeout)(this._ends.bind(this),i)}return(0,s.default)(e,[{key:"add",value:function(e){this._callbacks.added(e),this._ended?this._callbacks.missed(e):this._elements.push(e)}},{key:"triggerEnd",value:function(){return!this._ended&&(this._timer.clear(),this._ends(),this._timespan=Date.now()-this._startTime,!0)}},{key:"cancel",value:function(){if(!this._ended)return this._timer.clear(),this._ended=!0,this._elements=[],this._timespan=Date.now()-this._startTime,!0}},{key:"_ends",value:function(){this._ended=!0,this._callbacks.finished(this._elements),this._elements=[]}},{key:"timespan",get:function(){return this._timespan}}]),e}();t.default=l,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){var n=t.chunkIndex,r=t.segmentCoord,i=r.toArrayBuffer(),o=(0,a.numToUint8Array4)(n),s=e.byteLength,u=(0,a.uint16ToUint8Array2)(s),l=new Uint8Array(o.byteLength+u.byteLength+s+i.byteLength);return l.set(o,0),l.set(u,4),l.set(new Uint8Array(e),6),l.set(new Uint8Array(i),6+s),l.buffer}function i(e,t){var n=e.slice(0,4),r=e.slice(4,6),i=new Uint16Array(r)[0],a=e.slice(6,6+i),o=e.slice(6+i),s=new Uint32Array(n)[0];return{segmentCoord:t(o),chunkIndex:s,data:a}}Object.defineProperty(t,"__esModule",{value:!0}),t.parseMetaData=t.encodeMetaData=void 0;var a=n(96);t.encodeMetaData=r,t.parseMetaData=i},function(e,t,n){"use strict";function r(e,t){if("string"!=typeof e||!e.length)throw new TypeError(t)}function i(e){var t=e.contentUrl,n=e.contentId;if(null!==n&&void 0!==n)return r(n,"Unvalid p2pConfig property: contentId needs to be a non-empty string"),n;r(t,"Unvalid PeerAgent constructor argument: contentUrl needs to be a non-empty string");var i=o.default.parse(t,!0,!0);return i.host+i.pathname}Object.defineProperty(t,"__esModule",{value:!0}),t.formatContentId=void 0;var a=n(334),o=function(e){return e&&e.__esModule?e:{default:e}}(a);t.formatContentId=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.noop=function(){}},function(e,t,n){"use strict";function r(e){if(null===e.mediaElement)return 0;for(var t=e.mediaElement.buffered,n=e.mediaElement.currentTime,r=n,a=0;a<t.length;a++)t.start(a)<r+i&&t.end(a)>r&&(r=t.end(a));return r-n}Object.defineProperty(t,"__esModule",{value:!0});var i=.3;t.default={getBufferedAmount:r},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=r(i),o=n(1),s=r(o),u=function(){function e(t){(0,a.default)(this,e),this._maxSize=t,this._internalQueue=[]}return(0,s.default)(e,[{key:"addSample",value:function(e){this._internalQueue.length>=this._maxSize&&this._internalQueue.shift(),this._internalQueue.push(e)}},{key:"fetchSample",value:function(){if(this._internalQueue.length>0){var e=Math.floor(Math.random()*this._internalQueue.length);return this._internalQueue.splice(e,1)[0]}}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e,t,n){if(void 0!==t.backendUrl&&(e.DISTRIBUTOR.URL=t.backendUrl,e.DISTRIBUTOR.OVERRIDDEN=!0),t.cacheSize&&(e.P2P_CACHE_MAX_SIZE=1024*t.cacheSize*1024,e.LIVE.P2P_CACHE_MAX_SIZE=e.P2P_CACHE_MAX_SIZE),void 0!==t.activateP2P&&(e.ALLOW_P2P=!!t.activateP2P),void 0!==t.debug&&(e.DEBUG=!!t.debug),t.signalingUrl&&(e.SIGNALING_URL=t.signalingUrl),t.trackerUrl&&(e.TRACKER_URL=t.trackerUrl),t.analyticsUrl&&(e.ANALYTICS.KLARA_URL=t.analyticsUrl),t.deviceInfo&&(e.DEVICE_INFO=t.deviceInfo),void 0!==t.rangeRequestEnabled&&(e.RANGE_REQUEST_ALLOWED=!!t.rangeRequestEnabled),void 0!==t.enableStunServers&&(e.ENABLE_STUN=!!t.enableStunServers),!t.streamrootKey)throw new Error("There must be a streamrootKey in the P2PConfig object");e.ID_CLIENT=t.streamrootKey,e.ENABLE_MOBILE_BROWSER=!!t.mobileBrowserEnabled,e.P2P_PROTOCOL_VERSION+="-"+n}function i(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return void 0===t.CONF_LABEL?void o.default.notify("Received config from distributor, but no CONF_LABEL was present"):(e.CONF_LABEL=t.CONF_LABEL,n&&(e.P2P_PROTOCOL_VERSION+="-"+e.CONF_LABEL),void 0!==t.BACKEND_USE_SSL&&(e.BACKEND_USE_SSL=t.BACKEND_USE_SSL),void 0!==t.CHUNK_BATCHING_INTERVAL&&(e.CHUNK_BATCHING_INTERVAL=t.CHUNK_BATCHING_INTERVAL),void 0!==t.NB_SEGMENT_P2P_PREBUFFER&&(e.NB_SEGMENT_P2P_PREBUFFER=t.NB_SEGMENT_P2P_PREBUFFER),void 0!==t.MAX_BUFFER_DURATION&&(e.MAX_BUFFER_DURATION=t.MAX_BUFFER_DURATION),void 0!==t.MAX_NUMBER_OF_PEERS_ASKED_BY_GET_PEERS_MESSAGE&&(e.MAX_NUMBER_OF_PEERS_ASKED_BY_GET_PEERS_MESSAGE=t.MAX_NUMBER_OF_PEERS_ASKED_BY_GET_PEERS_MESSAGE),void 0!==t.CHUNK_TIMEOUT&&(e.CHUNK_TIMEOUT=t.CHUNK_TIMEOUT),void 0!==t.CHUNK_UP_TIMEOUT&&(e.CHUNK_UP_TIMEOUT=t.CHUNK_UP_TIMEOUT),void 0!==t.ICECANDIDATES_TIMEOUT&&(e.ICECANDIDATES_TIMEOUT=t.ICECANDIDATES_TIMEOUT),void 0!==t.UP_BUFFERED_AMOUNT_LOW_THRESHOLD&&(e.UP_BUFFERED_AMOUNT_LOW_THRESHOLD=t.UP_BUFFERED_AMOUNT_LOW_THRESHOLD),void 0!==t.UP_MAX_BUFFERED_AMOUNT&&(e.UP_MAX_BUFFERED_AMOUNT=t.UP_MAX_BUFFERED_AMOUNT),void 0!==t.OFFER_DECLINED_EXCLUSION_DURATION&&(e.OFFER_DECLINED_EXCLUSION_DURATION=t.OFFER_DECLINED_EXCLUSION_DURATION),void 0!==t.PEER_REMOVED_EXCLUSION_DURATION&&(e.PEER_REMOVED_EXCLUSION_DURATION=t.PEER_REMOVED_EXCLUSION_DURATION),void 0!==t.PEER_CONNECTION_ATTEMPT_TIMED_OUT_EXCLUSION_DURATION&&(e.PEER_CONNECTION_ATTEMPT_TIMED_OUT_EXCLUSION_DURATION=t.PEER_CONNECTION_ATTEMPT_TIMED_OUT_EXCLUSION_DURATION),void 0!==t.MIN_CHUNK_PERCENTAGE_DOWNLOADED_FOR_HAS_SEGMENT_ANSWER&&(e.MIN_CHUNK_PERCENTAGE_DOWNLOADED_FOR_HAS_SEGMENT_ANSWER=t.MIN_CHUNK_PERCENTAGE_DOWNLOADED_FOR_HAS_SEGMENT_ANSWER),void 0!==t.P2P_CACHE_MAX_SIZE&&(e.P2P_CACHE_MAX_SIZE=t.P2P_CACHE_MAX_SIZE),void 0!==t.ALLOW_LIVE_PUSH_SEGMENT&&(e.ALLOW_LIVE_PUSH_SEGMENT=t.ALLOW_LIVE_PUSH_SEGMENT),void 0!==t.ALLOW_VOD_PUSH_SEGMENT&&(e.ALLOW_VOD_PUSH_SEGMENT=t.ALLOW_VOD_PUSH_SEGMENT),void 0!==t.STUNSERVERS&&(e.STUNSERVERS=t.STUNSERVERS),void 0!==t.TRANSFORM_SDP&&(e.TRANSFORM_SDP=t.TRANSFORM_SDP),void 0!==t.LIVE&&(void 0!==t.LIVE.P2P_CACHE_MAX_SIZE&&(e.LIVE.P2P_CACHE_MAX_SIZE=t.LIVE.P2P_CACHE_MAX_SIZE),void 0!==t.LIVE.CHUNK_TIMEOUT&&(e.LIVE.CHUNK_TIMEOUT=t.LIVE.CHUNK_TIMEOUT),void 0!==t.LIVE.CHUNK_UP_TIMEOUT&&(e.LIVE.CHUNK_UP_TIMEOUT=t.LIVE.CHUNK_UP_TIMEOUT),void 0!==t.LIVE.LOWER_BUFFER_TARGET&&(e.LIVE.LOWER_BUFFER_TARGET=t.LIVE.LOWER_BUFFER_TARGET),void 0!==t.LIVE.HIGHER_BUFFER_TARGET&&(e.LIVE.HIGHER_BUFFER_TARGET=t.LIVE.HIGHER_BUFFER_TARGET),void 0!==t.LIVE.BUFFER_LEVEL_UPLOAD_SPEED_EMWA_WEIGHT&&(e.LIVE.BUFFER_LEVEL_UPLOAD_SPEED_EMWA_WEIGHT=t.LIVE.BUFFER_LEVEL_UPLOAD_SPEED_EMWA_WEIGHT),void 0!==t.LIVE.UPLOAD_THRESHOLD_MAX_BUFFER_TARGET_LOCKING&&(e.LIVE.UPLOAD_THRESHOLD_MAX_BUFFER_TARGET_LOCKING=t.LIVE.UPLOAD_THRESHOLD_MAX_BUFFER_TARGET_LOCKING),void 0!==t.LIVE.QOS_REF_PERCENTAGE&&(e.LIVE.QOS_REF_PERCENTAGE=t.LIVE.QOS_REF_PERCENTAGE),void 0!==t.LIVE.NEAR_EDGE_MARGIN&&(e.LIVE.NEAR_EDGE_MARGIN=t.LIVE.NEAR_EDGE_MARGIN),void 0!==t.LIVE.LOW_TARGET_P2P_DL_BLOCK_DURATION&&(e.LIVE.LOW_TARGET_P2P_DL_BLOCK_DURATION=t.LIVE.LOW_TARGET_P2P_DL_BLOCK_DURATION),void 0!==t.LIVE.CRITICAL_LOWER_TARGET_RATIO&&(e.LIVE.CRITICAL_LOWER_TARGET_RATIO=t.LIVE.CRITICAL_LOWER_TARGET_RATIO),void 0!==t.LIVE.FAST_BUFFER_FILL_FRACTION&&(e.LIVE.FAST_BUFFER_FILL_FRACTION=t.LIVE.FAST_BUFFER_FILL_FRACTION),void 0!==t.LIVE.LOWER_BUFFER_TARGET_DECREASE_STEP&&(e.LIVE.LOWER_BUFFER_TARGET_DECREASE_STEP=t.LIVE.LOWER_BUFFER_TARGET_DECREASE_STEP),void 0!==t.LIVE.LOWER_BUFFER_TARGET_INCREASE_STEP&&(e.LIVE.LOWER_BUFFER_TARGET_INCREASE_STEP=t.LIVE.LOWER_BUFFER_TARGET_INCREASE_STEP),void 0!==t.LIVE.ENABLE_DYNAMIC_LOWER_TARGET&&(e.LIVE.ENABLE_DYNAMIC_LOWER_TARGET=t.LIVE.ENABLE_DYNAMIC_LOWER_TARGET)),void 0!==t.QOS_REF_PERCENTAGE&&(e.QOS_REF_PERCENTAGE=t.QOS_REF_PERCENTAGE),void 0!==t.PEER_UPLOAD_CAPACITY_COMPUTATION_INTERVAL&&(e.PEER_UPLOAD_CAPACITY_COMPUTATION_INTERVAL=t.PEER_UPLOAD_CAPACITY_COMPUTATION_INTERVAL),void 0!==t.DEFAULT_PEER_UPLOAD_CAPACITY&&(e.DEFAULT_PEER_UPLOAD_CAPACITY=t.DEFAULT_PEER_UPLOAD_CAPACITY),void 0!==t.MIN_PEER_UPLOAD_CAPACITY&&(e.MIN_PEER_UPLOAD_CAPACITY=t.MIN_PEER_UPLOAD_CAPACITY),void 0!==t.MAX_PEER_UPLOAD_CAPACITY_TIMEOUT_RATIO&&(e.MAX_PEER_UPLOAD_CAPACITY_TIMEOUT_RATIO=t.MAX_PEER_UPLOAD_CAPACITY_TIMEOUT_RATIO),void 0!==t.PEER_UPLOAD_CAPACITY_EWMA_WEIGHT_UP&&(e.PEER_UPLOAD_CAPACITY_EWMA_WEIGHT_UP=t.PEER_UPLOAD_CAPACITY_EWMA_WEIGHT_UP),void 0!==t.PEER_UPLOAD_CAPACITY_EWMA_WEIGHT_DOWN&&(e.PEER_UPLOAD_CAPACITY_EWMA_WEIGHT_DOWN=t.PEER_UPLOAD_CAPACITY_EWMA_WEIGHT_DOWN),void 0!==t.PUC_EMWA_WEIGHT_USE_TIMEOUT_RATIO&&(e.PUC_EMWA_WEIGHT_USE_TIMEOUT_RATIO=t.PUC_EMWA_WEIGHT_USE_TIMEOUT_RATIO),void 0!==t.PUC_EMWA_WEIGHT_CAP&&(e.PUC_EMWA_WEIGHT_CAP=t.PUC_EMWA_WEIGHT_CAP),void 0!==t.PEER_UPLOAD_CAPACITY_SAFE_RATIO&&(e.PEER_UPLOAD_CAPACITY_SAFE_RATIO=t.PEER_UPLOAD_CAPACITY_SAFE_RATIO),void 0!==t.PEER_UPLOAD_CAPACITY_EXTRA_RATIO&&(e.PEER_UPLOAD_CAPACITY_EXTRA_RATIO=t.PEER_UPLOAD_CAPACITY_EXTRA_RATIO),void 0!==t.SPLIT_UPLOAD_QUEUE&&(e.SPLIT_UPLOAD_QUEUE=t.SPLIT_UPLOAD_QUEUE),void 0!==t.ENABLE_UPLOAD_DEQUEUE_ALL&&(e.ENABLE_UPLOAD_DEQUEUE_ALL=t.ENABLE_UPLOAD_DEQUEUE_ALL),void 0!==t.USE_CONTINOUS_PROGRESS_FEEDBACK&&(e.USE_CONTINOUS_PROGRESS_FEEDBACK=t.USE_CONTINOUS_PROGRESS_FEEDBACK),void 0!==t.PROGRESS_ADD_TOTAL&&(e.PROGRESS_ADD_TOTAL=t.PROGRESS_ADD_TOTAL),void 0!==t.DATACHANNEL_MAX_PACKET_LIFETIME&&(e.DATACHANNEL_MAX_PACKET_LIFETIME=t.DATACHANNEL_MAX_PACKET_LIFETIME),void 0!==t.DATACHANNEL_TYPE&&(e.DATACHANNEL_TYPE=t.DATACHANNEL_TYPE),void 0!==t.DATACHANNEL_MAX_RETRANSMITS&&(e.DATACHANNEL_MAX_RETRANSMITS=t.DATACHANNEL_MAX_RETRANSMITS),void 0!==t.ANALYTICS&&void 0!==t.ANALYTICS.EXPOSE_CONF_LABEL&&(e.ANALYTICS.EXPOSE_CONF_LABEL=t.ANALYTICS.EXPOSE_CONF_LABEL),void 0!==t.RANGE_REQUEST_ALLOWED&&(e.RANGE_REQUEST_ALLOWED=t.RANGE_REQUEST_ALLOWED),void 0!==t.ENABLE_STUN&&(e.ENABLE_STUN=t.ENABLE_STUN),void 0!==t.P2P_SPEED_ZERO_THRESHOLD&&(e.P2P_SPEED_ZERO_THRESHOLD=t.P2P_SPEED_ZERO_THRESHOLD),void 0!==t.P2P_SPEED_ESTIMATION_BUCKET_DURATION&&(e.P2P_SPEED_ESTIMATION_BUCKET_DURATION=t.P2P_SPEED_ESTIMATION_BUCKET_DURATION),void 0!==t.P2P_SPEED_ESTIMATION_BUCKET_COUNT&&(e.P2P_SPEED_ESTIMATION_BUCKET_COUNT=t.P2P_SPEED_ESTIMATION_BUCKET_COUNT),void 0!==t.P2P_SPEED_EMA_WEIGHT&&(e.P2P_SPEED_EMA_WEIGHT=t.P2P_SPEED_EMA_WEIGHT),void 0!==t.P2P_SPEED_EMA_ZERO_HALF_LIFE&&(e.P2P_SPEED_EMA_ZERO_HALF_LIFE=t.P2P_SPEED_EMA_ZERO_HALF_LIFE),void 0!==t.P2P_USEFUL_SMA_WINDOW&&(e.P2P_USEFUL_SMA_WINDOW=t.P2P_USEFUL_SMA_WINDOW),void 0!==t.P2P_USEFUL_CALCULATION_INTERVAL&&(e.P2P_USEFUL_CALCULATION_INTERVAL=t.P2P_USEFUL_CALCULATION_INTERVAL),void 0!==t.P2P_USEFUL_RATIO_WEIGHT&&(e.P2P_USEFUL_RATIO_WEIGHT=t.P2P_USEFUL_RATIO_WEIGHT),void 0!==t.P2P_DL_THRESHOLD_FOR_USEFUL_CORRECTION&&(e.P2P_DL_THRESHOLD_FOR_USEFUL_CORRECTION=t.P2P_DL_THRESHOLD_FOR_USEFUL_CORRECTION),void 0!==t.CDN_SPEED_ESTIMATE_CONSIDER_P2P&&(e.CDN_SPEED_ESTIMATE_CONSIDER_P2P=t.CDN_SPEED_ESTIMATE_CONSIDER_P2P),void 0!==t.ABR_SEGMENT_CDN_RATIO_THRESHOLD&&(e.ABR_SEGMENT_CDN_RATIO_THRESHOLD=t.ABR_SEGMENT_CDN_RATIO_THRESHOLD),void 0!==t.ABR_CDN_DL_THRESHOLD&&(e.ABR_CDN_DL_THRESHOLD=t.ABR_CDN_DL_THRESHOLD),void 0!==t.ABR_CDN_DL_DECAY_TIME&&(e.ABR_CDN_DL_DECAY_TIME=t.ABR_CDN_DL_DECAY_TIME),void 0!==t.USE_COMBINED_ABR_FEEDBACK&&(e.USE_COMBINED_ABR_FEEDBACK=t.USE_COMBINED_ABR_FEEDBACK),void 0!==t.CDN_CONCURRENT_SCALING_CAP&&(e.CDN_CONCURRENT_SCALING_CAP=t.CDN_CONCURRENT_SCALING_CAP),void 0!==t.ABR_CDN_SPEED_UPDATE_RATIO_THRESHOLD&&(e.ABR_CDN_SPEED_UPDATE_RATIO_THRESHOLD=t.ABR_CDN_SPEED_UPDATE_RATIO_THRESHOLD),void 0!==t.ENABLE_LATENCY_FEEDBACK&&(e.ENABLE_LATENCY_FEEDBACK=t.ENABLE_LATENCY_FEEDBACK),void 0!==t.ENABLE_PREBUFFER_FEEDBACK&&(e.ENABLE_PREBUFFER_FEEDBACK=t.ENABLE_PREBUFFER_FEEDBACK),void 0!==t.PEER_UPLOAD_SPEED_EMA_HALF_LIFE&&(e.PEER_UPLOAD_SPEED_EMA_HALF_LIFE=t.PEER_UPLOAD_SPEED_EMA_HALF_LIFE),void 0!==t.PEER_DOWNLOAD_SPEED_EMA_HALF_LIFE&&(e.PEER_DOWNLOAD_SPEED_EMA_HALF_LIFE=t.PEER_DOWNLOAD_SPEED_EMA_HALF_LIFE),void 0!==t.PEER_INIT_LOCKED_DURATION&&(e.PEER_INIT_LOCKED_DURATION=t.PEER_INIT_LOCKED_DURATION),void 0!==t.PEER_LOCKED_UPLOAD_THRESHOLD&&(e.PEER_LOCKED_UPLOAD_THRESHOLD=t.PEER_LOCKED_UPLOAD_THRESHOLD),void 0!==t.PEER_LOCKED_DOWNLOAD_THRESHOLD&&(e.PEER_LOCKED_DOWNLOAD_THRESHOLD=t.PEER_LOCKED_DOWNLOAD_THRESHOLD),void 0!==t.PEER_SPEED_MONITOR_INTERVAL&&(e.PEER_SPEED_MONITOR_INTERVAL=t.PEER_SPEED_MONITOR_INTERVAL),void 0!==t.PEER_TIMEOUT_RATIO_WINDOW&&(e.PEER_TIMEOUT_RATIO_WINDOW=t.PEER_TIMEOUT_RATIO_WINDOW),void 0!==t.PEER_CRITICAL_CHUNK_TIMEOUT_THRESHOLD&&(e.PEER_CRITICAL_CHUNK_TIMEOUT_THRESHOLD=t.PEER_CRITICAL_CHUNK_TIMEOUT_THRESHOLD),void 0!==t.LOOSER_UPLOAD_THRESHOLD&&(e.LOOSER_UPLOAD_THRESHOLD=t.LOOSER_UPLOAD_THRESHOLD),void 0!==t.CHUNK_GRACE_DURATION&&(e.CHUNK_GRACE_DURATION=t.CHUNK_GRACE_DURATION),void 0!==t.PEER_POOL_LIMIT&&(e.PEER_POOL_LIMIT=t.PEER_POOL_LIMIT),void 0!==t.RESERVED_OFFER_SLOTS&&(e.RESERVED_OFFER_SLOTS=t.RESERVED_OFFER_SLOTS),void 0!==t.CANDIDATE_PEERS_TRY_DEQUEUE_INTERVAL&&(e.CANDIDATE_PEERS_TRY_DEQUEUE_INTERVAL=t.CANDIDATE_PEERS_TRY_DEQUEUE_INTERVAL),void 0!==t.EXPECTED_CONNECTION_SUCCESS_RATE&&(e.EXPECTED_CONNECTION_SUCCESS_RATE=t.EXPECTED_CONNECTION_SUCCESS_RATE),void 0!==t.POST_TRACK_SWITCH_PEER_LOCK_SENSITIVITY_ON&&(e.POST_TRACK_SWITCH_PEER_LOCK_SENSITIVITY_ON=t.POST_TRACK_SWITCH_PEER_LOCK_SENSITIVITY_ON),void 0!==t.POST_TRACK_SWITCH_PEER_SPEED_SENSITIVITY_DURATION&&(e.POST_TRACK_SWITCH_PEER_SPEED_SENSITIVITY_DURATION=t.POST_TRACK_SWITCH_PEER_SPEED_SENSITIVITY_DURATION),void 0!==t.PEER_UPLOAD_SPEED_SENSITIVE_EMA_HALF_LIFE&&(e.PEER_UPLOAD_SPEED_SENSITIVE_EMA_HALF_LIFE=t.PEER_UPLOAD_SPEED_SENSITIVE_EMA_HALF_LIFE),void 0!==t.PEER_DOWNLOAD_SPEED_SENSITIVE_EMA_HALF_LIFE&&(e.PEER_DOWNLOAD_SPEED_SENSITIVE_EMA_HALF_LIFE=t.PEER_DOWNLOAD_SPEED_SENSITIVE_EMA_HALF_LIFE),void 0!==t.MAX_TRACKER_EXCLUSION_LENGTH&&(e.MAX_TRACKER_EXCLUSION_LENGTH=t.MAX_TRACKER_EXCLUSION_LENGTH),void 0!==t.PEER_DISCONNECTED_EXCLUSION_DURATION&&(e.PEER_DISCONNECTED_EXCLUSION_DURATION=t.PEER_DISCONNECTED_EXCLUSION_DURATION),void 0!==t.PEER_DISCONNECTED_EXCLUSION_RANK&&(e.PEER_DISCONNECTED_EXCLUSION_RANK=t.PEER_DISCONNECTED_EXCLUSION_RANK),void 0!==t.OFFER_DECLINED_EXCLUSION_RANK&&(e.OFFER_DECLINED_EXCLUSION_RANK=t.OFFER_DECLINED_EXCLUSION_RANK),void 0!==t.PEER_REMOVED_EXCLUSION_RANK&&(e.PEER_REMOVED_EXCLUSION_RANK=t.PEER_REMOVED_EXCLUSION_RANK),void 0!==t.PEER_CONNECTION_ATTEMPT_EXCLUSION_RANK&&(e.PEER_CONNECTION_ATTEMPT_EXCLUSION_RANK=t.PEER_CONNECTION_ATTEMPT_EXCLUSION_RANK),void 0!==t.BLOCK_SEEDER_SCHEDULING_WINDOW&&(e.BLOCK_SEEDER_SCHEDULING_WINDOW=t.BLOCK_SEEDER_SCHEDULING_WINDOW),void 0!==t.BLOCK_SEEDER_SCHEDULING_DURATION&&(e.BLOCK_SEEDER_SCHEDULING_DURATION=t.BLOCK_SEEDER_SCHEDULING_DURATION),void 0!==t.BLOCK_SEEDER_SCHEDULING_TIMEOUT_THRESHOLD&&(e.BLOCK_SEEDER_SCHEDULING_TIMEOUT_THRESHOLD=t.BLOCK_SEEDER_SCHEDULING_TIMEOUT_THRESHOLD),void 0!==t.BLOCK_SEEDER_SCHEDULING_REQUEST_THRESHOLD&&(e.BLOCK_SEEDER_SCHEDULING_REQUEST_THRESHOLD=t.BLOCK_SEEDER_SCHEDULING_REQUEST_THRESHOLD),void 0!==t.VOD_CRITICAL_BUFFER_THRESHOLD&&(e.VOD_CRITICAL_BUFFER_THRESHOLD=t.VOD_CRITICAL_BUFFER_THRESHOLD),void 0!==t.VOD_CRITICAL_BUFFER_P2P_STOP_DURATION&&(e.VOD_CRITICAL_BUFFER_P2P_STOP_DURATION=t.VOD_CRITICAL_BUFFER_P2P_STOP_DURATION),void 0!==t.VOD_SAFE_BUFFER_THRESHOLD&&(e.VOD_SAFE_BUFFER_THRESHOLD=t.VOD_SAFE_BUFFER_THRESHOLD),void 0!==t.MAX_PEER_CONNECTION_FAILURES&&(e.MAX_PEER_CONNECTION_FAILURES=t.MAX_PEER_CONNECTION_FAILURES),void 0!==t.SEGMENT_REQUEST_TIMEOUT_TO_STOP_ASKING_PEERS&&(e.SEGMENT_REQUEST_TIMEOUT_TO_STOP_ASKING_PEERS=t.SEGMENT_REQUEST_TIMEOUT_TO_STOP_ASKING_PEERS),void 0!==t.TRANSFER_ACTIVITY_TIMEOUT_TO_DISCONNECT_FROM_BACKEND&&(e.TRANSFER_ACTIVITY_TIMEOUT_TO_DISCONNECT_FROM_BACKEND=t.TRANSFER_ACTIVITY_TIMEOUT_TO_DISCONNECT_FROM_BACKEND),void 0!==t.ENABLE_FIX_UNRELIABLE_SEGMENT_TIME&&(e.ENABLE_FIX_UNRELIABLE_SEGMENT_TIME=t.ENABLE_FIX_UNRELIABLE_SEGMENT_TIME),void 0!==t.ENABLE_FILTER_BANNED_SEEDERS&&(e.ENABLE_FILTER_BANNED_SEEDERS=t.ENABLE_FILTER_BANNED_SEEDERS),void 0!==t.SEGMENT_ID_ACCEPTABLE_RANGE&&(e.SEGMENT_ID_ACCEPTABLE_RANGE=t.SEGMENT_ID_ACCEPTABLE_RANGE),void 0!==t.ENABLE_PUSH_SEGMENT_OPTIM&&(e.ENABLE_PUSH_SEGMENT_OPTIM=t.ENABLE_PUSH_SEGMENT_OPTIM),void 0!==t.ENABLE_P2P_SCHEDULER_OPTIM&&(e.ENABLE_P2P_SCHEDULER_OPTIM=t.ENABLE_P2P_SCHEDULER_OPTIM),void 0!==t.ENABLE_TRACK_EDGE_GC_BLOCK&&(e.ENABLE_TRACK_EDGE_GC_BLOCK=t.ENABLE_TRACK_EDGE_GC_BLOCK),void 0!==t.P2P_CACHE_GC_TRACK_EDGE_BLOCK_DURATION&&(e.P2P_CACHE_GC_TRACK_EDGE_BLOCK_DURATION=t.P2P_CACHE_GC_TRACK_EDGE_BLOCK_DURATION),void 0)}Object.defineProperty(t,"__esModule",{value:!0}),t.overloadConfigFromDistributor=t.overloadP2PConfig=void 0;var a=n(5),o=function(e){return e&&e.__esModule?e:{default:e}}(a);t.overloadP2PConfig=r,t.overloadConfigFromDistributor=i},function(e,t,n){"use strict";function r(e){if(/Android.* Chrome\/[0-9.]+ /.test(e)){if(-1!==e.indexOf("wv"))return!0;if(/ Version\/[0-9]+\.[0.9]+ /.test(e))return!0}return!1}function i(){var e=o.default.getUAObject();return e.ua?-1!==e.ua.indexOf("CrKey")?"chromecast":(e.device,e.os,o.default.isMobile()?r(e.ua)?"android-webview":"web-mobile":"web-desktop"):"unknown"}Object.defineProperty(t,"__esModule",{value:!0});var a=n(36),o=function(e){return e&&e.__esModule?e:{default:e}}(a);t.default={get:i},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var i=n(7),a=r(i),o=n(0),s=r(o),u=n(1),l=r(u),c=n(10),d=r(c),f=n(9),h=r(f),_=n(5),p=r(_),v=n(101),E=n(238),g=r(E),m=null,y={},S={},T=function(){},A=function(e){function t(e,n,r){(0,s.default)(this,t);var i=(0,d.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n,r));return i._createTimer(),i}return(0,h.default)(t,e),(0,l.default)(t,[{key:"_createTimer",value:function(){var e=this;if(m){var t=this._isRepeatable?"setInterval":"setTimeout";m.postMessage({command:t,id:this._id,time:this._time}),y[this._id]=this._callback}else if(this._isRepeatable){var n=function t(){S[e._id]=setTimeout(t,e._time),e._callback()};S[this._id]=setTimeout(n,this._time)}else{var r=function(){e._callback(),e._callback=T};S[this._id]=setTimeout(r,this._time)}}},{key:"clear",value:function(){m?(delete y[this._id],m.postMessage({command:"clear",id:this._id})):(clearTimeout(S[this._id]),delete S[this._id]),this._callback=T}}]),t}(v.AbstractTimer);try{window.Worker&&(m=new window.Worker(URL.createObjectURL(new Blob(["("+g.default.toString()+")()"],{type:"text/javascript"}))),m.onmessage=function(e){var t=e.data,n=t.id,r=t.command;y[n]&&(y[n](),"triggerTimeout"===r&&delete y[n])},m.onerror=function(e){p.default.notify("Error in TimerWorker",e.message)})}catch(e){}e.exports=A},function(e,t,n){"use strict";function r(){function e(e){return function(){self.postMessage({id:e,command:"triggerTimeout"}),delete n[e]}}function t(e,r){return function(){self.postMessage({id:e,command:"triggerInterval"}),n[e]=setTimeout(t(e,r),r)}}var n={};self.onmessage=function(r){var i=r.data,a=i.command,o=i.id,s=i.time;switch(a){case"setTimeout":n[o]=setTimeout(e(o),s);break;case"setInterval":n[o]=setTimeout(t(o,s),s);break;case"clear":clearTimeout(n[o]),delete n[o]}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(){String.prototype.endsWith=function(e){var t=this.toString();return t.lastIndexOf(e)===t.length-1}}function i(e){return e.endsWith("/")?e:e+"/"}Object.defineProperty(t,"__esModule",{value:!0}),t.polyfillEndsWith=r,t.formatUrl=i,String.prototype.endsWith||r()},function(e,t,n){e.exports={default:n(256),__esModule:!0}},function(e,t,n){e.exports={default:n(259),__esModule:!0}},function(e,t,n){e.exports={default:n(263),__esModule:!0}},function(e,t,n){e.exports={default:n(264),__esModule:!0}},function(e,t,n){e.exports={default:n(265),__esModule:!0}},function(e,t,n){e.exports={default:n(267),__esModule:!0}},function(e,t,n){e.exports={default:n(270),__esModule:!0}},function(e,t,n){e.exports={default:n(271),__esModule:!0}},function(e,t,n){e.exports={default:n(274),__esModule:!0}},function(e,t,n){e.exports={default:n(275),__esModule:!0}},function(e,t,n){e.exports={default:n(278),__esModule:!0}},function(e,t,n){e.exports={default:n(279),__esModule:!0}},function(e,t,n){"use strict";t.__esModule=!0;var r=n(18),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=i.default||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var i=n(7),a=r(i),o=n(245),s=r(o);t.default=function e(t,n,r){null===t&&(t=Function.prototype);var i=(0,s.default)(t,n);if(void 0===i){var o=(0,a.default)(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var u=i.get;return void 0!==u?u.call(r):void 0}},function(e,t,n){n(29),n(302),e.exports=n(3).Array.from},function(e,t,n){n(34),n(29),e.exports=n(300)},function(e,t,n){n(34),n(29),e.exports=n(301)},function(e,t,n){var r=n(3),i=r.JSON||(r.JSON={stringify:JSON.stringify});e.exports=function(e){return i.stringify.apply(i,arguments)}},function(e,t,n){n(60),n(29),n(34),n(304),n(324),e.exports=n(3).Map},function(e,t,n){n(305),e.exports=n(3).Number.isInteger},function(e,t,n){n(306),e.exports=9007199254740991},function(e,t,n){n(307),e.exports=-9007199254740991},function(e,t,n){n(308),e.exports=n(3).Object.assign},function(e,t,n){n(309);var r=n(3).Object;e.exports=function(e,t){return r.create(e,t)}},function(e,t,n){n(310);var r=n(3).Object;e.exports=function(e,t){return r.defineProperties(e,t)}},function(e,t,n){n(311);var r=n(3).Object;e.exports=function(e,t,n){return r.defineProperty(e,t,n)}},function(e,t,n){n(312),e.exports=n(3).Object.freeze},function(e,t,n){n(313);var r=n(3).Object;e.exports=function(e,t){return r.getOwnPropertyDescriptor(e,t)}},function(e,t,n){n(314);var r=n(3).Object;e.exports=function(e){return r.getOwnPropertyNames(e)}},function(e,t,n){n(315),e.exports=n(3).Object.getPrototypeOf},function(e,t,n){n(316),e.exports=n(3).Object.isFrozen},function(e,t,n){n(317),e.exports=n(3).Object.is},function(e,t,n){n(318),e.exports=n(3).Object.keys},function(e,t,n){n(319),e.exports=n(3).Object.seal},function(e,t,n){n(320),e.exports=n(3).Object.setPrototypeOf},function(e,t,n){n(325),e.exports=n(3).Object.values},function(e,t,n){
            n(60),n(29),n(34),n(321),e.exports=n(3).Promise},function(e,t,n){n(60),n(29),n(34),n(322),n(326),e.exports=n(3).Set},function(e,t,n){n(323),n(60),n(327),n(328),e.exports=n(3).Symbol},function(e,t,n){n(29),n(34),e.exports=n(82).f("iterator")},function(e,t){e.exports=function(){}},function(e,t,n){var r=n(55);e.exports=function(e,t){var n=[];return r(e,!1,n.push,n,t),n}},function(e,t,n){var r=n(20),i=n(58),a=n(299);e.exports=function(e){return function(t,n,o){var s,u=r(t),l=i(u.length),c=a(o,l);if(e&&n!=n){for(;l>c;)if((s=u[c++])!=s)return!0}else for(;l>c;c++)if((e||c in u)&&u[c]===n)return e||c||0;return!e&&-1}}},function(e,t,n){var r=n(22),i=n(72),a=n(33),o=n(58),s=n(285);e.exports=function(e,t){var n=1==e,u=2==e,l=3==e,c=4==e,d=6==e,f=5==e||d,h=t||s;return function(t,s,_){for(var p,v,E=a(t),g=i(E),m=r(s,_,3),y=o(g.length),S=0,T=n?h(t,y):u?h(t,0):void 0;y>S;S++)if((f||S in g)&&(p=g[S],v=m(p,S,E),e))if(n)T[S]=v;else if(v)switch(e){case 3:return!0;case 5:return p;case 6:return S;case 2:T.push(p)}else if(c)return!1;return d?-1:l||c?c:T}}},function(e,t,n){var r=n(13),i=n(113),a=n(11)("species");e.exports=function(e){var t;return i(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!i(t.prototype)||(t=void 0),r(t)&&null===(t=t[a])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){var r=n(284);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){"use strict";var r=n(15),i=n(44);e.exports=function(e,t,n){t in e?r.f(e,t,i(0,n)):e[t]=n}},function(e,t,n){var r=n(27),i=n(75),a=n(43);e.exports=function(e){var t=r(e),n=i.f;if(n)for(var o,s=n(e),u=a.f,l=0;s.length>l;)u.call(e,o=s[l++])&&t.push(o);return t}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(13),i=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&i(e)===e}},function(e,t,n){"use strict";var r=n(57),i=n(44),a=n(45),o={};n(23)(o,n(11)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=r(o,{next:i(1,n)}),a(e,t+" Iterator")}},function(e,t,n){var r=n(27),i=n(20);e.exports=function(e,t){for(var n,a=i(e),o=r(a),s=o.length,u=0;s>u;)if(a[n=o[u++]]===t)return n}},function(e,t,n){var r=n(12),i=n(124).set,a=r.MutationObserver||r.WebKitMutationObserver,o=r.process,s=r.Promise,u="process"==n(41)(o);e.exports=function(){var e,t,n,l=function(){var r,i;for(u&&(r=o.domain)&&r.exit();e;){i=e.fn,e=e.next;try{i()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(u)n=function(){o.nextTick(l)};else if(a){var c=!0,d=document.createTextNode("");new a(l).observe(d,{characterData:!0}),n=function(){d.data=c=!c}}else if(s&&s.resolve){var f=s.resolve();n=function(){f.then(l)}}else n=function(){i.call(r,l)};return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}}},function(e,t,n){"use strict";var r=n(27),i=n(75),a=n(43),o=n(33),s=n(72),u=Object.assign;e.exports=!u||n(25)(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=u({},e)[n]||Object.keys(u({},t)).join("")!=r})?function(e,t){for(var n=o(e),u=arguments.length,l=1,c=i.f,d=a.f;u>l;)for(var f,h=s(arguments[l++]),_=c?r(h).concat(c(h)):r(h),p=_.length,v=0;p>v;)d.call(h,f=_[v++])&&(n[f]=h[f]);return n}:u},function(e,t,n){var r=n(27),i=n(20),a=n(43).f;e.exports=function(e){return function(t){for(var n,o=i(t),s=r(o),u=s.length,l=0,c=[];u>l;)a.call(o,n=s[l++])&&c.push(e?[n,o[n]]:o[n]);return c}}},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},function(e,t,n){var r=n(13),i=n(19),a=function(e,t){if(i(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{r=n(22)(Function.call,n(74).f(Object.prototype,"__proto__").set,2),r(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return a(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:a}},function(e,t,n){var r=n(19),i=n(68),a=n(11)("species");e.exports=function(e,t){var n,o=r(e).constructor;return void 0===o||void 0==(n=r(o)[a])?t:i(n)}},function(e,t,n){var r=n(79),i=n(54);e.exports=function(e){return function(t,n){var a,o,s=String(i(t)),u=r(n),l=s.length;return u<0||u>=l?e?"":void 0:(a=s.charCodeAt(u),a<55296||a>56319||u+1===l||(o=s.charCodeAt(u+1))<56320||o>57343?e?s.charAt(u):a:e?s.slice(u,u+2):o-56320+(a-55296<<10)+65536)}}},function(e,t,n){var r=n(79),i=Math.max,a=Math.min;e.exports=function(e,t){return e=r(e),e<0?i(e+t,0):a(e,t)}},function(e,t,n){var r=n(19),i=n(83);e.exports=n(3).getIterator=function(e){var t=i(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return r(t.call(e))}},function(e,t,n){var r=n(53),i=n(11)("iterator"),a=n(32);e.exports=n(3).isIterable=function(e){var t=Object(e);return void 0!==t[i]||"@@iterator"in t||a.hasOwnProperty(r(t))}},function(e,t,n){"use strict";var r=n(22),i=n(6),a=n(33),o=n(114),s=n(112),u=n(58),l=n(286),c=n(83);i(i.S+i.F*!n(115)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,i,d,f=a(e),h="function"==typeof this?this:Array,_=arguments.length,p=_>1?arguments[1]:void 0,v=void 0!==p,E=0,g=c(f);if(v&&(p=r(p,_>2?arguments[2]:void 0,2)),void 0==g||h==Array&&s(g))for(t=u(f.length),n=new h(t);t>E;E++)l(n,E,v?p(f[E],E):f[E]);else for(d=g.call(f),n=new h;!(i=d.next()).done;E++)l(n,E,v?o(d,p,[i.value,E],!0):i.value);return n.length=E,n}})},function(e,t,n){"use strict";var r=n(280),i=n(116),a=n(32),o=n(20);e.exports=n(73)(Array,"Array",function(e,t){this._t=o(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):"keys"==t?i(0,n):"values"==t?i(0,e[n]):i(0,[n,e[n]])},"values"),a.Arguments=a.Array,r("keys"),r("values"),r("entries")},function(e,t,n){"use strict";var r=n(107);e.exports=n(109)("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=r.getEntry(this,e);return t&&t.v},set:function(e,t){return r.def(this,0===e?0:e,t)}},r,!0)},function(e,t,n){var r=n(6);r(r.S,"Number",{isInteger:n(289)})},function(e,t,n){var r=n(6);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,n){var r=n(6);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(e,t,n){var r=n(6);r(r.S+r.F,"Object",{assign:n(293)})},function(e,t,n){var r=n(6);r(r.S,"Object",{create:n(57)})},function(e,t,n){var r=n(6);r(r.S+r.F*!n(14),"Object",{defineProperties:n(117)})},function(e,t,n){var r=n(6);r(r.S+r.F*!n(14),"Object",{defineProperty:n(15).f})},function(e,t,n){var r=n(13),i=n(42).onFreeze;n(28)("freeze",function(e){return function(t){return e&&r(t)?e(i(t)):t}})},function(e,t,n){var r=n(20),i=n(74).f;n(28)("getOwnPropertyDescriptor",function(){return function(e,t){return i(r(e),t)}})},function(e,t,n){n(28)("getOwnPropertyNames",function(){return n(118).f})},function(e,t,n){var r=n(33),i=n(120);n(28)("getPrototypeOf",function(){return function(e){return i(r(e))}})},function(e,t,n){var r=n(13);n(28)("isFrozen",function(e){return function(t){return!r(t)||!!e&&e(t)}})},function(e,t,n){var r=n(6);r(r.S,"Object",{is:n(295)})},function(e,t,n){var r=n(33),i=n(27);n(28)("keys",function(){return function(e){return i(r(e))}})},function(e,t,n){var r=n(13),i=n(42).onFreeze;n(28)("seal",function(e){return function(t){return e&&r(t)?e(i(t)):t}})},function(e,t,n){var r=n(6);r(r.S,"Object",{setPrototypeOf:n(296).set})},function(e,t,n){"use strict";var r,i,a,o=n(56),s=n(12),u=n(22),l=n(53),c=n(6),d=n(13),f=n(68),h=n(69),_=n(55),p=n(297),v=n(124).set,E=n(292)(),g=s.TypeError,m=s.process,y=s.Promise,m=s.process,S="process"==l(m),T=function(){},A=!!function(){try{var e=y.resolve(1),t=(e.constructor={})[n(11)("species")]=function(e){e(T,T)};return(S||"function"==typeof PromiseRejectionEvent)&&e.then(T)instanceof t}catch(e){}}(),R=function(e,t){return e===t||e===y&&t===a},D=function(e){var t;return!(!d(e)||"function"!=typeof(t=e.then))&&t},C=function(e){return R(y,e)?new w(e):new i(e)},w=i=function(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw g("Bad Promise constructor");t=e,n=r}),this.resolve=f(t),this.reject=f(n)},b=function(e){try{e()}catch(e){return{error:e}}},O=function(e,t){if(!e._n){e._n=!0;var n=e._c;E(function(){for(var r=e._v,i=1==e._s,a=0;n.length>a;)!function(t){var n,a,o=i?t.ok:t.fail,s=t.resolve,u=t.reject,l=t.domain;try{o?(i||(2==e._h&&I(e),e._h=1),!0===o?n=r:(l&&l.enter(),n=o(r),l&&l.exit()),n===t.promise?u(g("Promise-chain cycle")):(a=D(n))?a.call(n,s,u):s(n)):u(r)}catch(e){u(e)}}(n[a++]);e._c=[],e._n=!1,t&&!e._h&&P(e)})}},P=function(e){v.call(s,function(){var t,n,r,i=e._v;if(L(e)&&(t=b(function(){S?m.emit("unhandledRejection",i,e):(n=s.onunhandledrejection)?n({promise:e,reason:i}):(r=s.console)&&r.error&&r.error("Unhandled promise rejection",i)}),e._h=S||L(e)?2:1),e._a=void 0,t)throw t.error})},L=function(e){if(1==e._h)return!1;for(var t,n=e._a||e._c,r=0;n.length>r;)if(t=n[r++],t.fail||!L(t.promise))return!1;return!0},I=function(e){v.call(s,function(){var t;S?m.emit("rejectionHandled",e):(t=s.onrejectionhandled)&&t({promise:e,reason:e._v})})},k=function(e){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=e,t._s=2,t._a||(t._a=t._c.slice()),O(t,!0))},N=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw g("Promise can't be resolved itself");(t=D(e))?E(function(){var r={_w:n,_d:!1};try{t.call(e,u(N,r,1),u(k,r,1))}catch(e){k.call(r,e)}}):(n._v=e,n._s=1,O(n,!1))}catch(e){k.call({_w:n,_d:!1},e)}}};A||(y=function(e){h(this,y,"Promise","_h"),f(e),r.call(this);try{e(u(N,this,1),u(k,this,1))}catch(e){k.call(this,e)}},r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},r.prototype=n(76)(y.prototype,{then:function(e,t){var n=C(p(this,y));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=S?m.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&O(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),w=function(){var e=new r;this.promise=e,this.resolve=u(N,e,1),this.reject=u(k,e,1)}),c(c.G+c.W+c.F*!A,{Promise:y}),n(45)(y,"Promise"),n(123)("Promise"),a=n(3).Promise,c(c.S+c.F*!A,"Promise",{reject:function(e){var t=C(this);return(0,t.reject)(e),t.promise}}),c(c.S+c.F*(o||!A),"Promise",{resolve:function(e){if(e instanceof y&&R(e.constructor,this))return e;var t=C(this);return(0,t.resolve)(e),t.promise}}),c(c.S+c.F*!(A&&n(115)(function(e){y.all(e).catch(T)})),"Promise",{all:function(e){var t=this,n=C(t),r=n.resolve,i=n.reject,a=b(function(){var n=[],a=0,o=1;_(e,!1,function(e){var s=a++,u=!1;n.push(void 0),o++,t.resolve(e).then(function(e){u||(u=!0,n[s]=e,--o||r(n))},i)}),--o||r(n)});return a&&i(a.error),n.promise},race:function(e){var t=this,n=C(t),r=n.reject,i=b(function(){_(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return i&&r(i.error),n.promise}})},function(e,t,n){"use strict";var r=n(107);e.exports=n(109)("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return r.def(this,e=0===e?0:e,e)}},r)},function(e,t,n){"use strict";var r=n(12),i=n(26),a=n(14),o=n(6),s=n(122),u=n(42).KEY,l=n(25),c=n(78),d=n(45),f=n(59),h=n(11),_=n(82),p=n(81),v=n(291),E=n(287),g=n(113),m=n(19),y=n(20),S=n(80),T=n(44),A=n(57),R=n(118),D=n(74),C=n(15),w=n(27),b=D.f,O=C.f,P=R.f,L=r.Symbol,I=r.JSON,k=I&&I.stringify,N=h("_hidden"),M=h("toPrimitive"),U={}.propertyIsEnumerable,x=c("symbol-registry"),F=c("symbols"),B=c("op-symbols"),G=Object.prototype,H="function"==typeof L,j=r.QObject,W=!j||!j.prototype||!j.prototype.findChild,V=a&&l(function(){return 7!=A(O({},"a",{get:function(){return O(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=b(G,t);r&&delete G[t],O(e,t,n),r&&e!==G&&O(G,t,r)}:O,K=function(e){var t=F[e]=A(L.prototype);return t._k=e,t},q=H&&"symbol"==typeof L.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof L},Y=function(e,t,n){return e===G&&Y(B,t,n),m(e),t=S(t,!0),m(n),i(F,t)?(n.enumerable?(i(e,N)&&e[N][t]&&(e[N][t]=!1),n=A(n,{enumerable:T(0,!1)})):(i(e,N)||O(e,N,T(1,{})),e[N][t]=!0),V(e,t,n)):O(e,t,n)},X=function(e,t){m(e);for(var n,r=E(t=y(t)),i=0,a=r.length;a>i;)Y(e,n=r[i++],t[n]);return e},z=function(e,t){return void 0===t?A(e):X(A(e),t)},Q=function(e){var t=U.call(this,e=S(e,!0));return!(this===G&&i(F,e)&&!i(B,e))&&(!(t||!i(this,e)||!i(F,e)||i(this,N)&&this[N][e])||t)},Z=function(e,t){if(e=y(e),t=S(t,!0),e!==G||!i(F,t)||i(B,t)){var n=b(e,t);return!n||!i(F,t)||i(e,N)&&e[N][t]||(n.enumerable=!0),n}},$=function(e){for(var t,n=P(y(e)),r=[],a=0;n.length>a;)i(F,t=n[a++])||t==N||t==u||r.push(t);return r},J=function(e){for(var t,n=e===G,r=P(n?B:y(e)),a=[],o=0;r.length>o;)!i(F,t=r[o++])||n&&!i(G,t)||a.push(F[t]);return a};H||(L=function(){if(this instanceof L)throw TypeError("Symbol is not a constructor!");var e=f(arguments.length>0?arguments[0]:void 0),t=function(n){this===G&&t.call(B,n),i(this,N)&&i(this[N],e)&&(this[N][e]=!1),V(this,e,T(1,n))};return a&&W&&V(G,e,{configurable:!0,set:t}),K(e)},s(L.prototype,"toString",function(){return this._k}),D.f=Z,C.f=Y,n(119).f=R.f=$,n(43).f=Q,n(75).f=J,a&&!n(56)&&s(G,"propertyIsEnumerable",Q,!0),_.f=function(e){return K(h(e))}),o(o.G+o.W+o.F*!H,{Symbol:L});for(var ee="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),te=0;ee.length>te;)h(ee[te++]);for(var ee=w(h.store),te=0;ee.length>te;)p(ee[te++]);o(o.S+o.F*!H,"Symbol",{for:function(e){return i(x,e+="")?x[e]:x[e]=L(e)},keyFor:function(e){if(q(e))return v(x,e);throw TypeError(e+" is not a symbol!")},useSetter:function(){W=!0},useSimple:function(){W=!1}}),o(o.S+o.F*!H,"Object",{create:z,defineProperty:Y,defineProperties:X,getOwnPropertyDescriptor:Z,getOwnPropertyNames:$,getOwnPropertySymbols:J}),I&&o(o.S+o.F*(!H||l(function(){var e=L();return"[null]"!=k([e])||"{}"!=k({a:e})||"{}"!=k(Object(e))})),"JSON",{stringify:function(e){if(void 0!==e&&!q(e)){for(var t,n,r=[e],i=1;arguments.length>i;)r.push(arguments[i++]);return t=r[1],"function"==typeof t&&(n=t),!n&&g(t)||(t=function(e,t){if(n&&(t=n.call(this,e,t)),!q(t))return t}),r[1]=t,k.apply(I,r)}}}),L.prototype[M]||n(23)(L.prototype,M,L.prototype.valueOf),d(L,"Symbol"),d(Math,"Math",!0),d(r.JSON,"JSON",!0)},function(e,t,n){var r=n(6);r(r.P+r.R,"Map",{toJSON:n(108)("Map")})},function(e,t,n){var r=n(6),i=n(294)(!1);r(r.S,"Object",{values:function(e){return i(e)}})},function(e,t,n){var r=n(6);r(r.P+r.R,"Set",{toJSON:n(108)("Set")})},function(e,t,n){n(81)("asyncIterator")},function(e,t,n){n(81)("observable")},function(e,t,n){(function(e,r){var i;!function(a){function o(e){throw new RangeError(L[e])}function s(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function u(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),e=e.replace(P,"."),r+s(e.split("."),t).join(".")}function l(e){for(var t,n,r=[],i=0,a=e.length;i<a;)t=e.charCodeAt(i++),t>=55296&&t<=56319&&i<a?(n=e.charCodeAt(i++),56320==(64512&n)?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--)):r.push(t);return r}function c(e){return s(e,function(e){var t="";return e>65535&&(e-=65536,t+=N(e>>>10&1023|55296),e=56320|1023&e),t+=N(e)}).join("")}function d(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:y}function f(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function h(e,t,n){var r=0;for(e=n?k(e/R):e>>1,e+=k(e/t);e>I*T>>1;r+=y)e=k(e/I);return k(r+(I+1)*e/(e+A))}function _(e){var t,n,r,i,a,s,u,l,f,_,p=[],v=e.length,E=0,g=C,A=D;for(n=e.lastIndexOf(w),n<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&o("not-basic"),p.push(e.charCodeAt(r));for(i=n>0?n+1:0;i<v;){for(a=E,s=1,u=y;i>=v&&o("invalid-input"),l=d(e.charCodeAt(i++)),(l>=y||l>k((m-E)/s))&&o("overflow"),E+=l*s,f=u<=A?S:u>=A+T?T:u-A,!(l<f);u+=y)_=y-f,s>k(m/_)&&o("overflow"),s*=_;t=p.length+1,A=h(E-a,t,0==a),k(E/t)>m-g&&o("overflow"),g+=k(E/t),E%=t,p.splice(E++,0,g)}return c(p)}function p(e){var t,n,r,i,a,s,u,c,d,_,p,v,E,g,A,R=[];for(e=l(e),v=e.length,t=C,n=0,a=D,s=0;s<v;++s)(p=e[s])<128&&R.push(N(p));for(r=i=R.length,i&&R.push(w);r<v;){for(u=m,s=0;s<v;++s)(p=e[s])>=t&&p<u&&(u=p);for(E=r+1,u-t>k((m-n)/E)&&o("overflow"),n+=(u-t)*E,t=u,s=0;s<v;++s)if(p=e[s],p<t&&++n>m&&o("overflow"),p==t){for(c=n,d=y;_=d<=a?S:d>=a+T?T:d-a,!(c<_);d+=y)A=c-_,g=y-_,R.push(N(f(_+A%g,0))),c=k(A/g);R.push(N(f(c,0))),a=h(n,E,r==i),n=0,++r}++n,++t}return R.join("")}function v(e){return u(e,function(e){return b.test(e)?_(e.slice(4).toLowerCase()):e})}function E(e){return u(e,function(e){return O.test(e)?"xn--"+p(e):e})}var g,m=("object"==typeof t&&t&&t.nodeType,"object"==typeof e&&e&&e.nodeType,"object"==typeof r&&r,2147483647),y=36,S=1,T=26,A=38,R=700,D=72,C=128,w="-",b=/^xn--/,O=/[^\x20-\x7E]/,P=/[\x2E\u3002\uFF0E\uFF61]/g,L={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},I=y-S,k=Math.floor,N=String.fromCharCode;g={version:"1.4.1",ucs2:{decode:l,encode:c},decode:_,encode:p,toASCII:E,toUnicode:v},void 0!==(i=function(){return g}.call(t,n,t,e))&&(e.exports=i)}()}).call(t,n(339)(e),n(84))},function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,a){t=t||"&",n=n||"=";var o={};if("string"!=typeof e||0===e.length)return o;var s=/\+/g;e=e.split(t);var u=1e3;a&&"number"==typeof a.maxKeys&&(u=a.maxKeys);var l=e.length;u>0&&l>u&&(l=u);for(var c=0;c<l;++c){var d,f,h,_,p=e[c].replace(s,"%20"),v=p.indexOf(n);v>=0?(d=p.substr(0,v),f=p.substr(v+1)):(d=p,f=""),h=decodeURIComponent(d),_=decodeURIComponent(f),r(o,h)?i(o[h])?o[h].push(_):o[h]=[o[h],_]:o[h]=_}return o};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";function r(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var i=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,s){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?r(o(e),function(o){var s=encodeURIComponent(i(o))+n;return a(e[o])?r(e[o],function(e){return s+encodeURIComponent(i(e))}).join(t):s+encodeURIComponent(i(e[o]))}).join(t):s?encodeURIComponent(i(s))+n+encodeURIComponent(i(e)):""};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},function(e,t,n){"use strict";t.decode=t.parse=n(330),t.encode=t.stringify=n(331)},function(e,t,n){var r;!function(i,a){"use strict";var o="model",s="name",u="type",l="vendor",c="version",d="mobile",f="tablet",h={extend:function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},_={rgx:function(e,t){for(var n,r,i,a,o,s,u=0;u<t.length&&!o;){var l=t[u],c=t[u+1];for(n=r=0;n<l.length&&!o;)if(o=l[n++].exec(e))for(i=0;i<c.length;i++)s=o[++r],a=c[i],"object"==typeof a&&a.length>0?2==a.length?"function"==typeof a[1]?this[a[0]]=a[1].call(this,s):this[a[0]]=a[1]:3==a.length?"function"!=typeof a[1]||a[1].exec&&a[1].test?this[a[0]]=s?s.replace(a[1],a[2]):void 0:this[a[0]]=s?a[1].call(this,s,a[2]):void 0:4==a.length&&(this[a[0]]=s?a[3].call(this,s.replace(a[1],a[2])):void 0):this[a]=s||void 0;u+=2}},str:function(e,t){for(var n in t)if("object"==typeof t[n]&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(h.has(t[n][r],e))return"?"===n?void 0:n}else if(h.has(t[n],e))return"?"===n?void 0:n;return e}},p={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},v={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[s,c],[/(opios)[\/\s]+([\w\.]+)/i],[[s,"Opera Mini"],c],[/\s(opr)\/([\w\.]+)/i],[[s,"Opera"],c],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser)\/([\w\.-]+)/i],[s,c],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[s,"IE"],c],[/(edge)\/((\d+)?[\w\.]+)/i],[s,c],[/(yabrowser)\/([\w\.]+)/i],[[s,"Yandex"],c],[/(puffin)\/([\w\.]+)/i],[[s,"Puffin"],c],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[s,"UCBrowser"],c],[/(comodo_dragon)\/([\w\.]+)/i],[[s,/_/g," "],c],[/(micromessenger)\/([\w\.]+)/i],[[s,"WeChat"],c],[/(QQ)\/([\d\.]+)/i],[s,c],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[s,c],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[c,[s,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[c,[s,"Facebook"]],[/(headlesschrome) ([\w\.]+)/i],[c,[s,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[s,/(.+)/,"$1 WebView"],c],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[s,/(.+(?:g|us))(.+)/,"$1 $2"],c],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[c,[s,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[s,c],[/(dolfin)\/([\w\.]+)/i],[[s,"Dolphin"],c],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[s,"Chrome"],c],[/(coast)\/([\w\.]+)/i],[[s,"Opera Coast"],c],[/fxios\/([\w\.-]+)/i],[c,[s,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[c,[s,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[c,s],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[s,[c,_.str,p.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[s,c],[/(navigator|netscape)\/([\w\.-]+)/i],[[s,"Netscape"],c],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[s,c]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",h.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",h.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[["architecture",h.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[o,l,[u,f]],[/applecoremedia\/[\w\.]+ \((ipad)/],[o,[l,"Apple"],[u,f]],[/(apple\s{0,1}tv)/i],[[o,"Apple TV"],[l,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[l,o,[u,f]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[o,[l,"Amazon"],[u,f]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[[o,_.str,p.device.amazon.model],[l,"Amazon"],[u,d]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[o,l,[u,d]],[/\((ip[honed|\s\w*]+);/i],[o,[l,"Apple"],[u,d]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[l,o,[u,d]],[/\(bb10;\s(\w+)/i],[o,[l,"BlackBerry"],[u,d]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[o,[l,"Asus"],[u,f]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[l,"Sony"],[o,"Xperia Tablet"],[u,f]],[/android.+\s([c-g]\d{4}|so[-l]\w+)\sbuild\//i],[o,[l,"Sony"],[u,d]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[l,o,[u,"console"]],[/android.+;\s(shield)\sbuild/i],[o,[l,"Nvidia"],[u,"console"]],[/(playstation\s[34portablevi]+)/i],[o,[l,"Sony"],[u,"console"]],[/(sprint\s(\w+))/i],[[l,_.str,p.device.sprint.vendor],[o,_.str,p.device.sprint.model],[u,d]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[l,o,[u,f]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[l,[o,/_/g," "],[u,d]],[/(nexus\s9)/i],[o,[l,"HTC"],[u,f]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[o,[l,"Huawei"],[u,d]],[/(microsoft);\s(lumia[\s\w]+)/i],[l,o,[u,d]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[o,[l,"Microsoft"],[u,"console"]],[/(kin\.[onetw]{3})/i],[[o,/\./g," "],[l,"Microsoft"],[u,d]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[o,[l,"Motorola"],[u,d]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[o,[l,"Motorola"],[u,f]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[l,h.trim],[o,h.trim],[u,"smarttv"]],[/hbbtv.+maple;(\d+)/i],[[o,/^/,"SmartTV"],[l,"Samsung"],[u,"smarttv"]],[/\(dtv[\);].+(aquos)/i],[o,[l,"Sharp"],[u,"smarttv"]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[l,"Samsung"],o,[u,f]],[/smart-tv.+(samsung)/i],[l,[u,"smarttv"],o],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[l,"Samsung"],o,[u,d]],[/sie-(\w+)*/i],[o,[l,"Siemens"],[u,d]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[l,"Nokia"],o,[u,d]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[o,[l,"Acer"],[u,f]],[/android.+([vl]k\-?\d{3})\s+build/i],[o,[l,"LG"],[u,f]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[l,"LG"],o,[u,f]],[/(lg) netcast\.tv/i],[l,o,[u,"smarttv"]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i,/android.+lg(\-?[\d\w]+)\s+build/i],[o,[l,"LG"],[u,d]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[o,[l,"Lenovo"],[u,f]],[/linux;.+((jolla));/i],[l,o,[u,d]],[/((pebble))app\/[\d\.]+\s/i],[l,o,[u,"wearable"]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[l,o,[u,d]],[/crkey/i],[[o,"Chromecast"],[l,"Google"]],[/android.+;\s(glass)\s\d/i],[o,[l,"Google"],[u,"wearable"]],[/android.+;\s(pixel c)\s/i],[o,[l,"Google"],[u,f]],[/android.+;\s(pixel xl|pixel)\s/i],[o,[l,"Google"],[u,d]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d\w)?)\s+build/i],[[o,/_/g," "],[l,"Xiaomi"],[u,d]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[o,[l,"Meizu"],[u,f]],[/android.+a000(1)\s+build/i],[o,[l,"OnePlus"],[u,d]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[o,[l,"RCA"],[u,f]],[/android.+[;\/]\s*(Venue[\d\s]*)\s+build/i],[o,[l,"Dell"],[u,f]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[o,[l,"Verizon"],[u,f]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[l,"Barnes & Noble"],o,[u,f]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[o,[l,"NuVision"],[u,f]],[/android.+[;\/]\s*(zte)?.+(k\d{2})\s+build/i],[[l,"ZTE"],o,[u,f]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[o,[l,"Swiss"],[u,d]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[o,[l,"Swiss"],[u,f]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[o,[l,"Zeki"],[u,f]],[/(android).+[;\/]\s+([YR]\d{2}x?.*)\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(.+)\s+build/i],[[l,"Dragon Touch"],o,[u,f]],[/android.+[;\/]\s*(NS-?.+)\s+build/i],[o,[l,"Insignia"],[u,f]],[/android.+[;\/]\s*((NX|Next)-?.+)\s+build/i],[o,[l,"NextBook"],[u,f]],[/android.+[;\/]\s*(Xtreme\_?)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[l,"Voice"],o,[u,d]],[/android.+[;\/]\s*(LVTEL\-?)?(V1[12])\s+build/i],[[l,"LvTel"],o,[u,d]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[o,[l,"Envizen"],[u,f]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(.*\b)\s+build/i],[l,o,[u,f]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[o,[l,"MachSpeed"],[u,f]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[l,o,[u,f]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[o,[l,"Rotor"],[u,f]],[/android.+(KS(.+))\s+build/i],[o,[l,"Amazon"],[u,f]],[/android.+(Gigaset)[\s\-]+(Q.+)\s+build/i],[l,o,[u,f]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[u,h.lowerize],l,o],[/(android.+)[;\/].+build/i],[o,[l,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[c,[s,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[s,c],[/rv\:([\w\.]+).*(gecko)/i],[c,s]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[s,c],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s]+\w)*/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[s,[c,_.str,p.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[s,"Windows"],[c,_.str,p.os.windows.version]],[/\((bb)(10);/i],[[s,"BlackBerry"],c],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[s,c],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[s,"Symbian"],c],[/\((series40);/i],[s],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[s,"Firefox OS"],c],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[s,c],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[s,"Chromium OS"],c],[/(sunos)\s?([\w\.]+\d)*/i],[[s,"Solaris"],c],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[s,c],[/(haiku)\s(\w+)/i],[s,c],[/cfnetwork\/.+darwin/i,/ip[honead]+(?:.*os\s([\w]+)*\slike\smac|;\sopera)/i],[[c,/_/g,"."],[s,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[s,"Mac OS"],[c,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[s,c]]},E=function(e,t){this[s]=e,this[c]=t},g=function(e){this.architecture=e},m=function(e,t,n){this[l]=e,this[o]=t,this[u]=n},y=E,S=E,T=function(e,t){if("object"==typeof e&&(t=e,e=void 0),!(this instanceof T))return new T(e,t).getResult();var n=e||(i&&i.navigator&&i.navigator.userAgent?i.navigator.userAgent:""),r=t?h.extend(v,t):v,a=new E,o=new g,s=new m,u=new y,l=new S;return this.getBrowser=function(){return _.rgx.call(a,n,r.browser),a.major=h.major(a.version),a},this.getCPU=function(){return _.rgx.call(o,n,r.cpu),o},this.getDevice=function(){return _.rgx.call(s,n,r.device),s},this.getEngine=function(){return _.rgx.call(u,n,r.engine),u},this.getOS=function(){return _.rgx.call(l,n,r.os),l},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=e,a=new E,o=new g,s=new m,u=new y,l=new S,this},this};T.VERSION="0.7.14",T.BROWSER={NAME:s,MAJOR:"major",VERSION:c},T.CPU={ARCHITECTURE:"architecture"},T.DEVICE={MODEL:o,VENDOR:l,TYPE:u,CONSOLE:"console",MOBILE:d,SMARTTV:"smarttv",TABLET:f,WEARABLE:"wearable",EMBEDDED:"embedded"},T.ENGINE={NAME:s,VERSION:c},T.OS={NAME:s,VERSION:c},void 0!==t?(void 0!==e&&e.exports&&(t=e.exports=T),
            t.UAParser=T):n(338)?void 0!==(r=function(){return T}.call(t,n,t,e))&&(e.exports=r):i&&(i.UAParser=T);var A=i&&(i.jQuery||i.Zepto);if(void 0!==A){var R=new T;A.ua=R.getResult(),A.ua.get=function(){return R.getUA()},A.ua.set=function(e){R.setUA(e);var t=R.getResult();for(var n in t)A.ua[n]=t[n]}}}("object"==typeof window?window:this)},function(e,t,n){"use strict";function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function i(e,t,n){if(e&&l.isObject(e)&&e instanceof r)return e;var i=new r;return i.parse(e,t,n),i}function a(e){return l.isString(e)&&(e=i(e)),e instanceof r?e.format():r.prototype.format.call(e)}function o(e,t){return i(e,!1,!0).resolve(t)}function s(e,t){return e?i(e,!1,!0).resolveObject(t):t}var u=n(329),l=n(335);t.parse=i,t.resolve=o,t.resolveObject=s,t.format=a,t.Url=r;var c=/^([a-z0-9.+-]+:)/i,d=/:[0-9]*$/,f=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,h=["<",">",'"',"`"," ","\r","\n","\t"],_=["{","}","|","\\","^","`"].concat(h),p=["'"].concat(_),v=["%","/","?",";","#"].concat(p),E=["/","?","#"],g=/^[+a-z0-9A-Z_-]{0,63}$/,m=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,y={javascript:!0,"javascript:":!0},S={javascript:!0,"javascript:":!0},T={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},A=n(332);r.prototype.parse=function(e,t,n){if(!l.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r=e.indexOf("?"),i=-1!==r&&r<e.indexOf("#")?"?":"#",a=e.split(i),o=/\\/g;a[0]=a[0].replace(o,"/"),e=a.join(i);var s=e;if(s=s.trim(),!n&&1===e.split("#").length){var d=f.exec(s);if(d)return this.path=s,this.href=s,this.pathname=d[1],d[2]?(this.search=d[2],this.query=t?A.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var h=c.exec(s);if(h){h=h[0];var _=h.toLowerCase();this.protocol=_,s=s.substr(h.length)}if(n||h||s.match(/^\/\/[^@\/]+@[^@\/]+/)){var R="//"===s.substr(0,2);!R||h&&S[h]||(s=s.substr(2),this.slashes=!0)}if(!S[h]&&(R||h&&!T[h])){for(var D=-1,C=0;C<E.length;C++){var w=s.indexOf(E[C]);-1!==w&&(-1===D||w<D)&&(D=w)}var b,O;O=-1===D?s.lastIndexOf("@"):s.lastIndexOf("@",D),-1!==O&&(b=s.slice(0,O),s=s.slice(O+1),this.auth=decodeURIComponent(b)),D=-1;for(var C=0;C<v.length;C++){var w=s.indexOf(v[C]);-1!==w&&(-1===D||w<D)&&(D=w)}-1===D&&(D=s.length),this.host=s.slice(0,D),s=s.slice(D),this.parseHost(),this.hostname=this.hostname||"";var P="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!P)for(var L=this.hostname.split(/\./),C=0,I=L.length;C<I;C++){var k=L[C];if(k&&!k.match(g)){for(var N="",M=0,U=k.length;M<U;M++)N+=k.charCodeAt(M)>127?"x":k[M];if(!N.match(g)){var x=L.slice(0,C),F=L.slice(C+1),B=k.match(m);B&&(x.push(B[1]),F.unshift(B[2])),F.length&&(s="/"+F.join(".")+s),this.hostname=x.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),P||(this.hostname=u.toASCII(this.hostname));var G=this.port?":"+this.port:"",H=this.hostname||"";this.host=H+G,this.href+=this.host,P&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==s[0]&&(s="/"+s))}if(!y[_])for(var C=0,I=p.length;C<I;C++){var j=p[C];if(-1!==s.indexOf(j)){var W=encodeURIComponent(j);W===j&&(W=escape(j)),s=s.split(j).join(W)}}var V=s.indexOf("#");-1!==V&&(this.hash=s.substr(V),s=s.slice(0,V));var K=s.indexOf("?");if(-1!==K?(this.search=s.substr(K),this.query=s.substr(K+1),t&&(this.query=A.parse(this.query)),s=s.slice(0,K)):t&&(this.search="",this.query={}),s&&(this.pathname=s),T[_]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var G=this.pathname||"",q=this.search||"";this.path=G+q}return this.href=this.format(),this},r.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=!1,a="";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&l.isObject(this.query)&&Object.keys(this.query).length&&(a=A.stringify(this.query));var o=this.search||a&&"?"+a||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||T[t])&&!1!==i?(i="//"+(i||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):i||(i=""),r&&"#"!==r.charAt(0)&&(r="#"+r),o&&"?"!==o.charAt(0)&&(o="?"+o),n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),o=o.replace("#","%23"),t+i+n+o+r},r.prototype.resolve=function(e){return this.resolveObject(i(e,!1,!0)).format()},r.prototype.resolveObject=function(e){if(l.isString(e)){var t=new r;t.parse(e,!1,!0),e=t}for(var n=new r,i=Object.keys(this),a=0;a<i.length;a++){var o=i[a];n[o]=this[o]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),u=0;u<s.length;u++){var c=s[u];"protocol"!==c&&(n[c]=e[c])}return T[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!T[e.protocol]){for(var d=Object.keys(e),f=0;f<d.length;f++){var h=d[f];n[h]=e[h]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||S[e.protocol])n.pathname=e.pathname;else{for(var _=(e.pathname||"").split("/");_.length&&!(e.host=_.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==_[0]&&_.unshift(""),_.length<2&&_.unshift(""),n.pathname=_.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var p=n.pathname||"",v=n.search||"";n.path=p+v}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var E=n.pathname&&"/"===n.pathname.charAt(0),g=e.host||e.pathname&&"/"===e.pathname.charAt(0),m=g||E||n.host&&e.pathname,y=m,A=n.pathname&&n.pathname.split("/")||[],_=e.pathname&&e.pathname.split("/")||[],R=n.protocol&&!T[n.protocol];if(R&&(n.hostname="",n.port=null,n.host&&(""===A[0]?A[0]=n.host:A.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===_[0]?_[0]=e.host:_.unshift(e.host)),e.host=null),m=m&&(""===_[0]||""===A[0])),g)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,A=_;else if(_.length)A||(A=[]),A.pop(),A=A.concat(_),n.search=e.search,n.query=e.query;else if(!l.isNullOrUndefined(e.search)){if(R){n.hostname=n.host=A.shift();var D=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");D&&(n.auth=D.shift(),n.host=n.hostname=D.shift())}return n.search=e.search,n.query=e.query,l.isNull(n.pathname)&&l.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!A.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var C=A.slice(-1)[0],w=(n.host||e.host||A.length>1)&&("."===C||".."===C)||""===C,b=0,O=A.length;O>=0;O--)C=A[O],"."===C?A.splice(O,1):".."===C?(A.splice(O,1),b++):b&&(A.splice(O,1),b--);if(!m&&!y)for(;b--;b)A.unshift("..");!m||""===A[0]||A[0]&&"/"===A[0].charAt(0)||A.unshift(""),w&&"/"!==A.join("/").substr(-1)&&A.push("");var P=""===A[0]||A[0]&&"/"===A[0].charAt(0);if(R){n.hostname=n.host=P?"":A.length?A.shift():"";var D=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");D&&(n.auth=D.shift(),n.host=n.hostname=D.shift())}return m=m||n.host&&A.length,m&&!P&&A.unshift(""),A.length?n.pathname=A.join("/"):(n.pathname=null,n.path=null),l.isNull(n.pathname)&&l.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var e=this.host,t=d.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,n){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,n){function r(e,t,n){var r=t&&n||0,i=t||[];e=e||{};var o=void 0!==e.clockseq?e.clockseq:u,d=void 0!==e.msecs?e.msecs:(new Date).getTime(),f=void 0!==e.nsecs?e.nsecs:c+1,h=d-l+(f-c)/1e4;if(h<0&&void 0===e.clockseq&&(o=o+1&16383),(h<0||d>l)&&void 0===e.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");l=d,c=f,u=o,d+=122192928e5;var _=(1e4*(268435455&d)+f)%4294967296;i[r++]=_>>>24&255,i[r++]=_>>>16&255,i[r++]=_>>>8&255,i[r++]=255&_;var p=d/4294967296*1e4&268435455;i[r++]=p>>>8&255,i[r++]=255&p,i[r++]=p>>>24&15|16,i[r++]=p>>>16&255,i[r++]=o>>>8|128,i[r++]=255&o;for(var v=e.node||s,E=0;E<6;++E)i[r+E]=v[E];return t||a(i)}var i=n(128),a=n(127),o=i(),s=[1|o[0],o[1],o[2],o[3],o[4],o[5]],u=16383&(o[6]<<8|o[7]),l=0,c=0;e.exports=r},function(e,t,n){function r(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null),e=e||{};var o=e.random||(e.rng||i)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var s=0;s<16;++s)t[r+s]=o[s];return t||a(o)}var i=n(128),a=n(127);e.exports=r},function(e,t){(function(t){e.exports=t}).call(t,{})},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}}])})},function(e,t,n){var r;!function(i,a){"use strict";var o="0.7.14",s="",u="?",l="function",c="undefined",d="object",f="string",h="major",_="model",p="name",v="type",E="vendor",g="version",m="architecture",y="console",S="mobile",T="tablet",A="smarttv",R="wearable",D="embedded",C={extend:function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2===0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n},has:function(e,t){return"string"==typeof e&&t.toLowerCase().indexOf(e.toLowerCase())!==-1},lowerize:function(e){return e.toLowerCase()},major:function(e){return typeof e===f?e.replace(/[^\d\.]/g,"").split(".")[0]:a},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},w={rgx:function(e,t){for(var n,r,i,o,s,u,c=0;c<t.length&&!s;){var f=t[c],h=t[c+1];for(n=r=0;n<f.length&&!s;)if(s=f[n++].exec(e))for(i=0;i<h.length;i++)u=s[++r],o=h[i],typeof o===d&&o.length>0?2==o.length?typeof o[1]==l?this[o[0]]=o[1].call(this,u):this[o[0]]=o[1]:3==o.length?typeof o[1]!==l||o[1].exec&&o[1].test?this[o[0]]=u?u.replace(o[1],o[2]):a:this[o[0]]=u?o[1].call(this,u,o[2]):a:4==o.length&&(this[o[0]]=u?o[3].call(this,u.replace(o[1],o[2])):a):this[o]=u?u:a;c+=2}},str:function(e,t){for(var n in t)if(typeof t[n]===d&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(C.has(t[n][r],e))return n===u?a:n}else if(C.has(t[n],e))return n===u?a:n;return e}},b={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},O={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[p,g],[/(opios)[\/\s]+([\w\.]+)/i],[[p,"Opera Mini"],g],[/\s(opr)\/([\w\.]+)/i],[[p,"Opera"],g],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser)\/([\w\.-]+)/i],[p,g],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[p,"IE"],g],[/(edge)\/((\d+)?[\w\.]+)/i],[p,g],[/(yabrowser)\/([\w\.]+)/i],[[p,"Yandex"],g],[/(puffin)\/([\w\.]+)/i],[[p,"Puffin"],g],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[p,"UCBrowser"],g],[/(comodo_dragon)\/([\w\.]+)/i],[[p,/_/g," "],g],[/(micromessenger)\/([\w\.]+)/i],[[p,"WeChat"],g],[/(QQ)\/([\d\.]+)/i],[p,g],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[p,g],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[g,[p,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[g,[p,"Facebook"]],[/(headlesschrome) ([\w\.]+)/i],[g,[p,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[p,/(.+)/,"$1 WebView"],g],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[p,/(.+(?:g|us))(.+)/,"$1 $2"],g],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[g,[p,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[p,g],[/(dolfin)\/([\w\.]+)/i],[[p,"Dolphin"],g],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[p,"Chrome"],g],[/(coast)\/([\w\.]+)/i],[[p,"Opera Coast"],g],[/fxios\/([\w\.-]+)/i],[g,[p,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[g,[p,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[g,p],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[p,[g,w.str,b.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[p,g],[/(navigator|netscape)\/([\w\.-]+)/i],[[p,"Netscape"],g],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[p,g]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[m,"amd64"]],[/(ia32(?=;))/i],[[m,C.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[m,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[m,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[m,/ower/,"",C.lowerize]],[/(sun4\w)[;\)]/i],[[m,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[m,C.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[_,E,[v,T]],[/applecoremedia\/[\w\.]+ \((ipad)/],[_,[E,"Apple"],[v,T]],[/(apple\s{0,1}tv)/i],[[_,"Apple TV"],[E,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[E,_,[v,T]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[_,[E,"Amazon"],[v,T]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[[_,w.str,b.device.amazon.model],[E,"Amazon"],[v,S]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[_,E,[v,S]],[/\((ip[honed|\s\w*]+);/i],[_,[E,"Apple"],[v,S]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[E,_,[v,S]],[/\(bb10;\s(\w+)/i],[_,[E,"BlackBerry"],[v,S]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[_,[E,"Asus"],[v,T]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[E,"Sony"],[_,"Xperia Tablet"],[v,T]],[/android.+\s([c-g]\d{4}|so[-l]\w+)\sbuild\//i],[_,[E,"Sony"],[v,S]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[E,_,[v,y]],[/android.+;\s(shield)\sbuild/i],[_,[E,"Nvidia"],[v,y]],[/(playstation\s[34portablevi]+)/i],[_,[E,"Sony"],[v,y]],[/(sprint\s(\w+))/i],[[E,w.str,b.device.sprint.vendor],[_,w.str,b.device.sprint.model],[v,S]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[E,_,[v,T]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[E,[_,/_/g," "],[v,S]],[/(nexus\s9)/i],[_,[E,"HTC"],[v,T]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[_,[E,"Huawei"],[v,S]],[/(microsoft);\s(lumia[\s\w]+)/i],[E,_,[v,S]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[_,[E,"Microsoft"],[v,y]],[/(kin\.[onetw]{3})/i],[[_,/\./g," "],[E,"Microsoft"],[v,S]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[_,[E,"Motorola"],[v,S]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[_,[E,"Motorola"],[v,T]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[E,C.trim],[_,C.trim],[v,A]],[/hbbtv.+maple;(\d+)/i],[[_,/^/,"SmartTV"],[E,"Samsung"],[v,A]],[/\(dtv[\);].+(aquos)/i],[_,[E,"Sharp"],[v,A]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[E,"Samsung"],_,[v,T]],[/smart-tv.+(samsung)/i],[E,[v,A],_],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[E,"Samsung"],_,[v,S]],[/sie-(\w+)*/i],[_,[E,"Siemens"],[v,S]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[E,"Nokia"],_,[v,S]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[_,[E,"Acer"],[v,T]],[/android.+([vl]k\-?\d{3})\s+build/i],[_,[E,"LG"],[v,T]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[E,"LG"],_,[v,T]],[/(lg) netcast\.tv/i],[E,_,[v,A]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i,/android.+lg(\-?[\d\w]+)\s+build/i],[_,[E,"LG"],[v,S]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[_,[E,"Lenovo"],[v,T]],[/linux;.+((jolla));/i],[E,_,[v,S]],[/((pebble))app\/[\d\.]+\s/i],[E,_,[v,R]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[E,_,[v,S]],[/crkey/i],[[_,"Chromecast"],[E,"Google"]],[/android.+;\s(glass)\s\d/i],[_,[E,"Google"],[v,R]],[/android.+;\s(pixel c)\s/i],[_,[E,"Google"],[v,T]],[/android.+;\s(pixel xl|pixel)\s/i],[_,[E,"Google"],[v,S]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d\w)?)\s+build/i],[[_,/_/g," "],[E,"Xiaomi"],[v,S]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[_,[E,"Meizu"],[v,T]],[/android.+a000(1)\s+build/i],[_,[E,"OnePlus"],[v,S]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[_,[E,"RCA"],[v,T]],[/android.+[;\/]\s*(Venue[\d\s]*)\s+build/i],[_,[E,"Dell"],[v,T]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[_,[E,"Verizon"],[v,T]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[E,"Barnes & Noble"],_,[v,T]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[_,[E,"NuVision"],[v,T]],[/android.+[;\/]\s*(zte)?.+(k\d{2})\s+build/i],[[E,"ZTE"],_,[v,T]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[_,[E,"Swiss"],[v,S]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[_,[E,"Swiss"],[v,T]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[_,[E,"Zeki"],[v,T]],[/(android).+[;\/]\s+([YR]\d{2}x?.*)\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(.+)\s+build/i],[[E,"Dragon Touch"],_,[v,T]],[/android.+[;\/]\s*(NS-?.+)\s+build/i],[_,[E,"Insignia"],[v,T]],[/android.+[;\/]\s*((NX|Next)-?.+)\s+build/i],[_,[E,"NextBook"],[v,T]],[/android.+[;\/]\s*(Xtreme\_?)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[E,"Voice"],_,[v,S]],[/android.+[;\/]\s*(LVTEL\-?)?(V1[12])\s+build/i],[[E,"LvTel"],_,[v,S]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[_,[E,"Envizen"],[v,T]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(.*\b)\s+build/i],[E,_,[v,T]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[_,[E,"MachSpeed"],[v,T]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[E,_,[v,T]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[_,[E,"Rotor"],[v,T]],[/android.+(KS(.+))\s+build/i],[_,[E,"Amazon"],[v,T]],[/android.+(Gigaset)[\s\-]+(Q.+)\s+build/i],[E,_,[v,T]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[v,C.lowerize],E,_],[/(android.+)[;\/].+build/i],[_,[E,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[g,[p,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[p,g],[/rv\:([\w\.]+).*(gecko)/i],[g,p]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[p,g],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s]+\w)*/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[p,[g,w.str,b.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[p,"Windows"],[g,w.str,b.os.windows.version]],[/\((bb)(10);/i],[[p,"BlackBerry"],g],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[p,g],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[p,"Symbian"],g],[/\((series40);/i],[p],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[p,"Firefox OS"],g],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[p,g],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[p,"Chromium OS"],g],[/(sunos)\s?([\w\.]+\d)*/i],[[p,"Solaris"],g],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[p,g],[/(haiku)\s(\w+)/i],[p,g],[/cfnetwork\/.+darwin/i,/ip[honead]+(?:.*os\s([\w]+)*\slike\smac|;\sopera)/i],[[g,/_/g,"."],[p,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[p,"Mac OS"],[g,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[p,g]]},P=function(e,t){this[p]=e,this[g]=t},L=function(e){this[m]=e},I=function(e,t,n){this[E]=e,this[_]=t,this[v]=n},k=P,N=P,M=function(e,t){if("object"==typeof e&&(t=e,e=a),!(this instanceof M))return new M(e,t).getResult();var n=e||(i&&i.navigator&&i.navigator.userAgent?i.navigator.userAgent:s),r=t?C.extend(O,t):O,o=new P,u=new L,l=new I,c=new k,d=new N;return this.getBrowser=function(){return w.rgx.call(o,n,r.browser),o.major=C.major(o.version),o},this.getCPU=function(){return w.rgx.call(u,n,r.cpu),u},this.getDevice=function(){return w.rgx.call(l,n,r.device),l},this.getEngine=function(){return w.rgx.call(c,n,r.engine),c},this.getOS=function(){return w.rgx.call(d,n,r.os),d},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=e,o=new P,u=new L,l=new I,c=new k,d=new N,this},this};M.VERSION=o,M.BROWSER={NAME:p,MAJOR:h,VERSION:g},M.CPU={ARCHITECTURE:m},M.DEVICE={MODEL:_,VENDOR:E,TYPE:v,CONSOLE:y,MOBILE:S,SMARTTV:A,TABLET:T,WEARABLE:R,EMBEDDED:D},M.ENGINE={NAME:p,VERSION:g},M.OS={NAME:p,VERSION:g},typeof t!==c?(typeof e!==c&&e.exports&&(t=e.exports=M),t.UAParser=M):"function"===l&&n(23)?(r=function(){return M}.call(t,n,t,e),!(r!==a&&(e.exports=r))):i&&(i.UAParser=M);var U=i&&(i.jQuery||i.Zepto);if(typeof U!==c){var x=new M;U.ua=x.getResult(),U.ua.get=function(){return x.getUA()},U.ua.set=function(e){x.setUA(e);var t=x.getResult();for(var n in t)U.ua[n]=t[n]}}}("object"==typeof window?window:this)},function(e,t){(function(t){e.exports=t}).call(t,{})},function(e,t,n){"use strict";function r(){var e=window||e;e.XMLHttpRequest=o}var i=n(6),a=n(4),o=n(26);e.exports={BaseXHR:i,XMLHttpRequest:o,useGlobal:r,objectMirrors:a}},function(e,t){var n=function(){var e=1/0,t=0,r=0,i=0;Object.defineProperty(this,"maxBandwidth",{get:function(){return Math.min(e,n.maxBandwidth)},set:function(t){e=t}}),Object.defineProperty(this,"minLatency",{get:function(){return Math.max(t,n.minLatency)},set:function(e){t=e}}),Object.defineProperty(this,"minProgressEvents",{get:function(){return Math.max(r,n.minProgressEvents)},set:function(e){r=e}}),Object.defineProperty(this,"randomness",{get:function(){return Math.max(i,n.randomness)},set:function(e){i=e}})};n.maxBandwidth=1/0,n.minLatency=0,n.minProgressEvents=0,n.randomness=0,e.exports=n},function(e,t,n){var r=n(6),i=n(25),a=n(4),o=window.XMLHttpRequest,s=function(){var e,t,n,s,u,l,c,d,f,h,_,p=new o,v=new i,E=0,g=[],m=!1;p.onloadend=function(e){_=e,n&&4===p.readyState&&n(e)},p.onreadystatechange=function(r){function i(t){e&&e(t)}switch(p.readyState){case 0:i(r);break;case 1:s=Date.now(),i(r);break;case 2:u=Date.now(),i(r);break;case 3:l=Date.now(),i(r);break;case 4:var a=0,o=0;c=Date.now();var y=c-s;if(y<v.minLatency&&(a=v.minLatency-y),f>v.maxBandwidth&&(o=f/v.maxBandwidth*y-y),a||o){setTimeout(function(){E!==d||m||(clearTimeout(h),t(g[g.length-1])),i(r),_&&n&&n(_)},Math.max(a,o));break}i(r)}},p.onprogress=function(e){function n(e){E===d&&(m=!0),t&&t(e)}var r,i=Date.now(),a=i-s;return E=e.loaded,d=e.total,f=8*E/a,f>v.maxBandwidth?(r=f/v.maxBandwidth*a-a,g.push(e),void(h=setTimeout(function(){n(e)},r))):void n(e)};var y=new r(p);return a.mirrorRwProp(y,p,"onreadystatechange",function(t){return e=t,{override:!0}}),a.mirrorRwProp(y,p,"onprogress",function(e){return t=e,{override:!0}}),a.mirrorRwProp(y,p,"onloadend",function(e){return n=e,{override:!0}}),y.shaper=v,y};s.Shaper=i,e.exports=s}])});

        /***/ }),
    /* 1 */
    /***/ (function(module, exports, __webpack_require__) {

        var require;var require;(function(f){if(true){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.VideoEventPolyfill=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return require(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default={WAITING:"polyfillWaiting",PLAYING:"polyfillPlaying",ENDED:"polyfillEnded"};module.exports=exports["default"]},{}],2:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _events=_dereq_("events");var _events2=_interopRequireDefault(_events);var _eventStruct=_dereq_("./eventStruct");var _eventStruct2=_interopRequireDefault(_eventStruct);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var VideoEventPolyfill=function(_EventEmitter){_inherits(VideoEventPolyfill,_EventEmitter);_createClass(VideoEventPolyfill,null,[{key:"Events",get:function get(){return _eventStruct2.default}}]);function VideoEventPolyfill(video){_classCallCheck(this,VideoEventPolyfill);var _this=_possibleConstructorReturn(this,(VideoEventPolyfill.__proto__||Object.getPrototypeOf(VideoEventPolyfill)).call(this));_this.video=video;_this.IDLE=0;_this.BUFFERING=1;_this.PLAYING=2;_this.TOLERANCE=.1;_this.state=_this.IDLE;_this.onPl=_this.onPlay.bind(_this);_this.onPling=_this.onPlaying.bind(_this);if(_this.video.paused){_this.start()}else{_this.onPlay()}return _this}_createClass(VideoEventPolyfill,[{key:"start",value:function start(){this.video.addEventListener("play",this.onPl)}},{key:"onPlay",value:function onPlay(){this.state=this.BUFFERING;this.emit(_eventStruct2.default.WAITING);this.tickInterval=setInterval(this.tick.bind(this),200);this.video.removeEventListener("play",this.onPl)}},{key:"onPlaying",value:function onPlaying(){this.emit(_eventStruct2.default.PLAYING);this.video.removeEventListener("playing",this.onPling)}},{key:"onEnded",value:function onEnded(){clearInterval(this.tickInterval);this.state=this.IDLE;this.emit(_eventStruct2.default.ENDED);if(this.video){this.video.addEventListener("play",this.onPl)}}},{key:"getBufferLength",value:function getBufferLength(){for(var i=0;i<this.video.buffered.length;i++){if(this.video.buffered.start(i)<=this.video.currentTime&&this.video.currentTime<=this.video.buffered.end(i)){return this.video.buffered.end(i)-this.video.currentTime}}return 0}},{key:"tick",value:function tick(){if(this.isLive!==undefined&&!this.isLive){if(this.video.duration&&(this.video.duration-this.video.currentTime<.5&&this.video.currentTime-this.lastCurrentTime<.01||this.video.duration-this.video.currentTime<1&&this.video.currentTime-this.lastCurrentTime<.01&&!this.video.paused&&this.video.playbackRate>0||this.video.currentTime>0&&isNaN(this.video.duration))){this.onEnded();return}else{this.lastCurrentTime=this.video.currentTime}}var bufferLength=this.getBufferLength();switch(this.state){case this.BUFFERING:if(bufferLength>this.TOLERANCE){this.state=this.PLAYING;if(!this.video.paused){this.emit(_eventStruct2.default.PLAYING)}else{this.video.addEventListener("playing",this.onPling)}}break;case this.PLAYING:if(bufferLength<this.TOLERANCE){this.state=this.BUFFERING;if(!this.video.paused){this.emit(_eventStruct2.default.WAITING)}}else if(this.video.paused){this.video.addEventListener("playing",this.onPling)}break;case this.IDLE:default:return}}},{key:"setLive",value:function setLive(isLive){this.isLive=isLive}},{key:"dispose",value:function dispose(){clearInterval(this.tickInterval);if(this.video){this.video.removeEventListener("play",this.onPl);this.video.removeEventListener("playing",this.onPling);delete this.video}this.removeAllListeners()}}]);return VideoEventPolyfill}(_events2.default);exports.default=VideoEventPolyfill;module.exports=exports["default"]},{"./eventStruct":1,events:3}],3:[function(_dereq_,module,exports){function EventEmitter(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}module.exports=EventEmitter;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=undefined;EventEmitter.prototype._maxListeners=undefined;EventEmitter.defaultMaxListeners=10;EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");this._maxListeners=n;return this};EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(!this._events)this._events={};if(type==="error"){if(!this._events.error||isObject(this._events.error)&&!this._events.error.length){er=arguments[1];if(er instanceof Error){throw er}else{var err=new Error('Uncaught, unspecified "error" event. ('+er+")");err.context=er;throw err}}}handler=this._events[type];if(isUndefined(handler))return false;if(isFunction(handler)){switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:args=Array.prototype.slice.call(arguments,1);handler.apply(this,args)}}else if(isObject(handler)){args=Array.prototype.slice.call(arguments,1);listeners=handler.slice();len=listeners.length;for(i=0;i<len;i++)listeners[i].apply(this,args)}return true};EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener);if(!this._events[type])this._events[type]=listener;else if(isObject(this._events[type]))this._events[type].push(listener);else this._events[type]=[this._events[type],listener];if(isObject(this._events[type])&&!this._events[type].warned){if(!isUndefined(this._maxListeners)){m=this._maxListeners}else{m=EventEmitter.defaultMaxListeners}if(m&&m>0&&this._events[type].length>m){this._events[type].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[type].length);if(typeof console.trace==="function"){console.trace()}}}return this};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.once=function(type,listener){if(!isFunction(listener))throw TypeError("listener must be a function");var fired=false;function g(){this.removeListener(type,g);if(!fired){fired=true;listener.apply(this,arguments)}}g.listener=listener;this.on(type,g);return this};EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;list=this._events[type];length=list.length;position=-1;if(list===listener||isFunction(list.listener)&&list.listener===listener){delete this._events[type];if(this._events.removeListener)this.emit("removeListener",type,listener)}else if(isObject(list)){for(i=length;i-- >0;){if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}}if(position<0)return this;if(list.length===1){list.length=0;delete this._events[type]}else{list.splice(position,1)}if(this._events.removeListener)this.emit("removeListener",type,listener)}return this};EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[type])delete this._events[type];return this}if(arguments.length===0){for(key in this._events){if(key==="removeListener")continue;this.removeAllListeners(key)}this.removeAllListeners("removeListener");this._events={};return this}listeners=this._events[type];if(isFunction(listeners)){this.removeListener(type,listeners)}else if(listeners){while(listeners.length)this.removeListener(type,listeners[listeners.length-1])}delete this._events[type];return this};EventEmitter.prototype.listeners=function(type){var ret;if(!this._events||!this._events[type])ret=[];else if(isFunction(this._events[type]))ret=[this._events[type]];else ret=this._events[type].slice();return ret};EventEmitter.prototype.listenerCount=function(type){if(this._events){var evlistener=this._events[type];if(isFunction(evlistener))return 1;else if(evlistener)return evlistener.length}return 0};EventEmitter.listenerCount=function(emitter,type){return emitter.listenerCount(type)};function isFunction(arg){return typeof arg==="function"}function isNumber(arg){return typeof arg==="number"}function isObject(arg){return typeof arg==="object"&&arg!==null}function isUndefined(arg){return arg===void 0}},{}]},{},[2])(2)});


        /***/ }),
    /* 2 */
    /***/ (function(module, exports, __webpack_require__) {

        "use strict";
        function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function levelLabel(e){return e.height?e.height+"p":e.width?Math.round(9*e.width/16)+"p":e.bitrate?e.bitrate/1e3+"kbps":0}var _streamrootHlsjsP2pBundle=__webpack_require__(0),_streamrootHlsjsP2pBundle2=_interopRequireDefault(_streamrootHlsjsP2pBundle),_streamrootVideoEventPolyfill=__webpack_require__(1),_streamrootVideoEventPolyfill2=_interopRequireDefault(_streamrootVideoEventPolyfill),MEDIA_TYPE={VOD:0,LIVE:1,DVR:2},attachJWStreamrootProvider=function(e){function t(t,o){function a(e){if(void 0===Z||Z.url!==e){var t=function(e,t){Q=MEDIA_TYPE.VOD,t.details.live&&(Q=t.details.totalduration>120?MEDIA_TYPE.DVR:MEDIA_TYPE.LIVE,z=t.details.totalduration),u.setLive(t.details.live)};z=0,Z&&Z.destroy();var r=o.p2pConfig||{},a=o.hlsjsConfig||{};if(o.contentIdForUrl){var s=o.contentIdForUrl(e);s&&(r.contentId=s)}var l=C._.extend({},a);Z=new _streamrootHlsjsP2pBundle2.default(l,r),Z.on(_streamrootHlsjsP2pBundle2.default.Events.MANIFEST_PARSED,N),Z.on(_streamrootHlsjsP2pBundle2.default.Events.ERROR,function(e,t){t.fatal&&k.trigger(n.JWPLAYER_MEDIA_ERROR,{message:t.details})});var u=new _streamrootVideoEventPolyfill2.default(W);u.on(_streamrootVideoEventPolyfill2.default.Events.WAITING,function(){k.setState(i.BUFFERING)}),u.on(_streamrootVideoEventPolyfill2.default.Events.PLAYING,function(){k.setState(i.PLAYING)}),u.on(_streamrootVideoEventPolyfill2.default.Events.ENDED,function(){k.trigger(n.JWPLAYER_MEDIA_BEFORECOMPLETE),K&&(c(0),k.pause(),k.setState(i.COMPLETE),k.trigger(n.JWPLAYER_MEDIA_COMPLETE),U&&(W.removeEventListener("seeked",v),U=!1))}),Z.on(_streamrootHlsjsP2pBundle2.default.Events.LEVEL_LOADED,t),Z.on(_streamrootHlsjsP2pBundle2.default.Events.DESTROYING,function(){u.dispose()}),Z.loadSource(e),Z.attachMedia(W),S()}}function s(e){this.setState(i.BUFFERING),a(e.file),this.trigger(n.JWPLAYER_MEDIA_BUFFER_FULL),j=setInterval(Y,100)}function l(e){W.muted=e}function u(){W.pause(),this.setState(i.PAUSED)}function d(){return w}function f(){return x}function E(){W.play(),this.setState(i.BUFFERING),this.setVisibility(!0)}function c(e){if(K){var t=W.currentTime;Q===MEDIA_TYPE.DVR&&e<0&&(e+=W.duration),W.currentTime=e,k.trigger("seek",{position:t,offset:e}),U||(W.addEventListener("seeked",v),U=!0)}}function v(){k.trigger("seeked")}function _(){H===W.parentNode&&H.removeChild(W)}function m(e){H=e,H.appendChild(W)}function P(){return H}function p(e){var t=0===e?-1:w.length-1-e;Z.nextLevel=t,g(e)}function g(e){k._currentQuality=e,k.trigger(n.JWPLAYER_MEDIA_LEVEL_CHANGED,{currentQuality:e,levels:w})}function h(e){e=!!e,e?r.css.style(H,{visibility:"visible",opacity:1}):r.css.style(H,{visibility:"",opacity:0})}function L(){W.pause(),this.setState(i.IDLE)}function I(e){W.volume=e/100}function A(){return!0}function D(){return{name:this.name}}function y(){if(K)return K=!1,Z&&Z.detachMedia(),clearInterval(j),q=!1,W}function R(){K=!0,Z&&Z.attachMedia(W),S()}function T(){var e=navigator.userAgent;return/(iPhone|iPad|iPod|iPod touch);.*?OS/.test(e)||/ (Chrome|Version)\/\d+(\.\d+)+.* Safari\/\d+(\.\d+)+/.test(e)||/Firefox\/(\d+(?:\.\d+)+)/.test(e)}function M(){q=!0,k.trigger("subtitlesTracks",{tracks:W.textTracks})}function S(){T()&&(W.textTracks.onaddtrack=M,W.textTracks.length&&M())}function V(e){if(q)for(var t=W.textTracks,r=e.tracks[e.track].id,n=0;n<t.length;n++)t[n].mode=t[n]._id==r?"showing":"hidden"}function B(){if(K){var e=W.currentTime,t=W.duration;J=e,Q===MEDIA_TYPE.LIVE&&(t=1/0),Q===MEDIA_TYPE.DVR&&(e=-(W.duration-W.currentTime),t=-z),k.trigger(n.JWPLAYER_MEDIA_TIME,{position:e,duration:t})}}function Y(){var e=F();e!=G&&(G=e,k.trigger(n.JWPLAYER_MEDIA_BUFFER,{bufferPercent:100*G})),e>=1&&clearInterval(j)}function b(e){for(var t=0;t<e.length;t++)if(e.start(t)<=W.currentTime&&W.currentTime<=e.end(t))return e.end(t);return J}function F(){var e=W.buffered,t=b(e);return W.duration<=0?0:t/W.duration}function N(e,t){var r=[];if(t.levels.forEach(function(e){var t={};t.bitrate=e.bitrate,r.unshift(t),t.label=X(e)}),t.levels.length>1){var i={label:"Auto"};r.unshift(i)}w=r,k.trigger(n.JWPLAYER_MEDIA_LEVELS,{levels:w,currentQuality:x}),g(Z.manualLevel+1)}var H,j,C=e(t),k=this,O=document.getElementById(t),W=O&&O.querySelector("video")?O.querySelector("video"):document.createElement("video"),J=0,w=[],x=-1,G=-1,U=!1,q=!1,Q=MEDIA_TYPE.VOD,z=0,K=!0,X=o.videoQualityLabelForLevel||levelLabel;this.name="streamrootHLS";var Z;r.css.style(W,{height:"100%",width:"100%"});var $=C.Events;C._.extend(this,$,{load:s,mute:l,pause:u,getQualityLevels:d,getCurrentQuality:f,play:E,seek:c,remove:_,setContainer:m,getContainer:P,setCurrentQuality:p.bind(this),setVisibility:h,stop:L,volume:I,supportsFullscreen:A,getName:D,detachMedia:y,attachMedia:R}),W.addEventListener("timeupdate",B),C.on(e.events.JWPLAYER_CAPTIONS_CHANGED,V),C.on(e.events.JWPLAYER_CAPTIONS_LIST,V)}var r=e.utils,n=e.events,i=n.state;t.getName=function(){return{name:"StreamrootProviderHLS"}},t.supports=function(e){var t,r=_streamrootHlsjsP2pBundle2.default&&("IE"===_streamrootHlsjsP2pBundle2.default.getBrowserName()||"Edge"===_streamrootHlsjsP2pBundle2.default.getBrowserName());return e.file&&(t=-1!==e.file.indexOf(".m3u8")),t&&!r&&_streamrootHlsjsP2pBundle2.default&&_streamrootHlsjsP2pBundle2.default.isSupported()},e.api.registerProvider(t)};attachJWStreamrootProvider(window.jwplayer);

        /***/ })
    /******/ ]);